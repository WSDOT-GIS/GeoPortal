define(["esri/geometry/Point","esri/map","esri/toolbars/draw","dijit/registry","esri/geometry/jsonUtils","esri/graphic","esri/SpatialReference","dijit/layout/ContentPane","esri/geometry/Polyline","esri/Color","esri/dijit/PopupTemplate","esri/layers/FeatureLayer","esri/renderers/SimpleRenderer","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleMarkerSymbol"],function(e,t,r,n,o,a,i,u,s,c,l,f,d,p,m){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return o}),r.d(t,"__assign",function(){return a}),r.d(t,"__rest",function(){return i}),r.d(t,"__decorate",function(){return u}),r.d(t,"__param",function(){return s}),r.d(t,"__metadata",function(){return c}),r.d(t,"__awaiter",function(){return l}),r.d(t,"__generator",function(){return f}),r.d(t,"__exportStar",function(){return d}),r.d(t,"__values",function(){return p}),r.d(t,"__read",function(){return m}),r.d(t,"__spread",function(){return y}),r.d(t,"__await",function(){return h}),r.d(t,"__asyncGenerator",function(){return b}),r.d(t,"__asyncDelegator",function(){return v}),r.d(t,"__asyncValues",function(){return R}),r.d(t,"__makeTemplateObject",function(){return g}),r.d(t,"__importStar",function(){return S}),r.d(t,"__importDefault",function(){return w});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function s(e,t){return function(r,n){t(r,n,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{s(n.next(e))}catch(e){a(e)}}function u(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,u)}s((n=n.apply(e,t||[])).next())})}function f(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function d(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function b(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){a.push([e,t,r,n])>1||u(e,t)})})}function u(e,t){try{!function(e){e.value instanceof h?Promise.resolve(e.value.v).then(s,c):l(a[0][2],e)}(o[e](t))}catch(e){l(a[0][3],e)}}function s(e){u("next",e)}function c(e){u("throw",e)}function l(e,t){e(t),a.shift(),a.length&&u(a[0][0],a[0][1])}}function v(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function R(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}function g(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function w(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){var n,o;n=[r,t,r(0),r(12),r(5),r(13),r(14)],void 0===(o=function(e,t,r,n,o,a,i){"use strict";function u(e){if(!e)return null;for(var t=/[A-Z]?[a-z]+/g,r=t.exec(e),n=new Array;r;){var o=r[0].toLowerCase();n.push(o),r=t.exec(e)}return n.join(" ")}function s(e,t,r){var n=document.createElement("label");return n.htmlFor=t.id,n.textContent=r||u(t.name),t.required&&n.classList.add("required"),e.appendChild(n),e.appendChild(t),n}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultLrsMapServiceUrl="https://data.wsdot.wa.gov/arcgis/rest/services/CountyRoutes/CRAB_Routes/MapServer",t.defaultLrsSvcUrl=t.defaultLrsMapServiceUrl+"/exts/LRSServer",t.defaultLayerId=0,t.getLrsServerEndpointUrl=function(e,t,r){if(!e.match(/^(?:https?:)?\/\/.+\/(Map|Feature)Server\b/i))throw Error('URL is not in expected format: "'+e+'".');return e+"/exts/LRSServer/"+t+"/"+r},t.generateId=function(e){for(var t=e,r=0;document.getElementById(t);)t=""+e+r,r++;return t},t.splitName=u,t.addNamedControlsToElement=function(e,t){var r={};for(var n in t)if(t.hasOwnProperty(n)){var o=s(e,t[n],n);r[n]=o}return r},t.addToFormWithLabel=s,t.IterateG2MOutputToFeatures=function(e){var t,n,u,s,c,l,f,d,p,m,y,h,b,v,R,g,S,w,L,U,J,I;return r.__generator(this,function(_){switch(_.label){case 0:new Intl.NumberFormat("en-US",{maximumFractionDigits:3}),c=e.locations,l=e.spatialReference,f=new i(l),_.label=1;case 1:_.trys.push([1,12,13,14]),d=r.__values(c),p=d.next(),_.label=2;case 2:if(p.done)return[3,11];m=p.value,y=m.results,h=m.status,_.label=3;case 3:_.trys.push([3,8,9,10]),b=r.__values(y),v=b.next(),_.label=4;case 4:return v.done?[3,7]:(R=v.value,g=R.routeId,S=R.measure,w=R.geometry,R.geometryType,L={status:h,routeId:g,measure:S},U=new o(w.x,w.y,f),[4,new a({geometry:U,attributes:L})]);case 5:_.sent(),_.label=6;case 6:return v=b.next(),[3,4];case 7:return[3,10];case 8:return J=_.sent(),u={error:J},[3,10];case 9:try{v&&!v.done&&(s=b.return)&&s.call(b)}finally{if(u)throw u.error}return[7];case 10:return p=d.next(),[3,2];case 11:return[3,14];case 12:return I=_.sent(),t={error:I},[3,14];case 13:try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}return[7];case 14:return[2]}})},t.m2gOutputToFeatures=function(e){var t,u,s,c,l,f,d,p,m,y,h,b,v,R,g,S,w,L,U,J;return r.__generator(this,function(I){switch(I.label){case 0:s=e.locations,c=e.spatialReference,l=new i(c),I.label=1;case 1:I.trys.push([1,10,11,12]),f=r.__values(s),d=f.next(),I.label=2;case 2:return d.done?[3,9]:(p=d.value,m=p.routeId,y=p.status,p.geometry?[3,4]:[4,new a({attributes:{routeId:m,status:y}})]);case 3:return I.sent(),[3,8];case 4:return"esriGeometryPoint"!==p.geometryType?[3,6]:(h=p.geometry,b=h.x,v=h.y,R=h.m,S=new o(b,v,l),[4,new a({geometry:S,attributes:{routeId:m,status:y,measure:R}})]);case 5:return I.sent(),[3,8];case 6:return"esriGeometryPolyline"!==p.geometryType?[3,8]:((g=p.geometry).paths,g.hasM,(S=n.fromJson(p.geometry)).setSpatialReference(l),w=r.__read(function(e){if(!e.hasM)return[null,null];var t=e.paths[0][0][3],r=e.paths[e.paths.length-1];return[t,r[r.length-1][3]]}(p.geometry),2),L=w[0],U=w[1],[4,new a({geometry:S,attributes:{routeId:m,status:y,fromMeasure:L,toMeasure:U}})]);case 7:I.sent(),I.label=8;case 8:return d=f.next(),[3,2];case 9:return[3,12];case 10:return J=I.sent(),t={error:J},[3,12];case 11:try{d&&!d.done&&(u=f.return)&&u.call(f)}finally{if(t)throw t.error}return[7];case 12:return[2]}})}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(3),r(9),r(10),r(4),r(1)],void 0===(o=function(e,t,r,n,o,a,i,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t,s){void 0===t&&(t=u.defaultLrsSvcUrl),void 0===s&&(s=u.defaultLayerId);var c=this;if(this.map=e,this.url=t,this.layerId=s,!(e&&e instanceof o))throw TypeError("Invalid map: "+e);this.form=function(e,t){void 0===e&&(e=u.defaultLrsSvcUrl),void 0===t&&(t=u.defaultLayerId);var r=document.createElement("form");r.id=u.generateId("geometryToMeasureForm"),r.action=e+"/networkLayers/"+t+"/geometryToMeasure";var n=i.createSearchLink(/County/i),o=document.createElement("p");o.appendChild(n),r.appendChild(o);var a=document.createElement("input");a.type="number",a.min="0",a.name="tolerance",a.id=u.generateId("toleranceInput"),a.title="The maximum distance in map units (feet) to snap a point to the closest location on a nearby route. If a point is farther than the tolerance from a route, then an indication is returned that the point is not locatable.",u.addToFormWithLabel(r,a).textContent="Tolerance (in feet)";var s=document.createElement("input");s.type="date",s.name="temporalViewDate",s.id=u.generateId("temporalViewDateInput"),u.addToFormWithLabel(r,s);var c=document.createElement("button");return c.type="submit",c.textContent="Locate",r.appendChild(c),r}(t,s),this.draw=new a(this.map),this.lrsClient=new n.LrsClient(t);var l=this;this.form.addEventListener("submit",function(e){try{l.draw.activate(a.POINT),l.map.setInfoWindowOnClick(!1),l.map.disablePopups()}catch(e){alert("Error: Could not activate the draw toolbar."),console.error("Error activating the draw toolbar",e)}e.preventDefault()}),this.draw.on("draw-complete",function(e){return r.__awaiter(c,void 0,void 0,function(){var t,n,o,a,i,u;return r.__generator(this,function(r){switch(r.label){case 0:if(l.draw.deactivate(),l.map.setInfoWindowOnClick(!0),l.map.enablePopups(),!e.geometry||!e.geometry.type.match(/point/gi))return[2];t=e.geometry,n=e.geometry.spatialReference.wkid,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.lrsClient.geometryToMeasure(l.layerId,[[t.x,t.y]],l.tolerance,l.temporalViewDate,n,n)];case 2:return o=r.sent(),a=new CustomEvent("geometryToMeasure",{detail:o}),l.form.dispatchEvent(a),[3,4];case 3:return i=r.sent(),u=new CustomEvent("geometryToMeasureError",{detail:i}),l.form.dispatchEvent(u),[3,4];case 4:return[2]}})})})}return Object.defineProperty(e.prototype,"toleranceInput",{get:function(){var e=this.form.elements.namedItem("tolerance");if(!(e&&e instanceof HTMLInputElement))throw new Error("No input element named tolerance was found in this form.");return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tolerance",{get:function(){return this.toleranceInput.valueAsNumber},set:function(e){this.toleranceInput.value=null!=e?e.toString(10):""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"temporalViewDate",{get:function(){var e=this.form.elements.namedItem("temporalViewDate");if(e&&e.value)return e.valueAsDate},enumerable:!0,configurable:!0}),e}();t.GeometryToMeasureControl=s}.apply(t,n))||(e.exports=o)},function(e,t,r){window,e.exports=function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(t,r){t.exports=e},function(e,t,r){"use strict";function n(e){return e.getTime()}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */r.r(t);var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};function a(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{s(n.next(e))}catch(e){a(e)}}function u(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,u)}s((n=n.apply(e,t||[])).next())})}function i(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}Object.assign;var u=/^https?:\/\/.+\/MapServer\/exts\/LRSServer\b/,s=new RegExp(u.source+"/layers\\b"),c=new RegExp(u.source+"/applyEdits\\b"),l=new RegExp(u.source+"/createVersion\\b"),f=new RegExp(u.source+"/deleteVersion\\b"),d=new RegExp(u.source+"/reconcileVersion\\b"),p=new RegExp(u.source+"/networkLayers\\b"),m=new RegExp(p.source+"/\\d+\\b"),y=new RegExp(m.source+"/geometryToMeasure\\b"),h=new RegExp(m.source+"/measureToGeometry\\b"),b=new RegExp(m.source+"/translate\\b"),v=new RegExp(m.source+"/concurrencies\\b"),R=new RegExp(m.source+"/queryAttributeSet\\b"),g=new RegExp(m.source+"/checkEvents\\b"),S=new RegExp(u.source+"/eventLayers\\b"),w=new RegExp(S.source+"/\\d+\\b"),L=new RegExp(w.source+"/geometryToStation\\b"),U=new RegExp(w.source+"/stationToGeometry\\b"),J=new RegExp(u.source+"/redlineLayers\\b"),I=new RegExp(J.source+"/\\d+\\b"),_=new RegExp(u.source+"/centerlineLayers\\b"),C=new RegExp(_.source+"/\\d+\\b"),E=new RegExp(u.source+"/calibrationPointLayers\\b"),x=new RegExp(E.source+"/\\d+\\b"),P=new RegExp(u.source+"/intersectionLayers\\b"),D=new RegExp(P.source+"/\\d+\\b"),M=new RegExp(u.source+"/nonLRSLayers\\b"),O=new RegExp(M.source+"/\\d+\\b"),G=new RegExp(u.source+"/locks\\b"),T=new RegExp(G.source+"/query\\b"),N=new RegExp(G.source+"/acquire\\b"),F=new RegExp(G.source+"/release\\b"),j=r(0),k=function(e){function t(t,r){var n=this,o=t+" does not match "+r+".";return(n=e.call(this,o)||this).url=t,n.re=r,n}return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t}(Error);function A(e,t){var r=e.match(t);if(r)return r[0];throw new k(e,t)}function B(e,t){return a(this,void 0,void 0,function(){var r;return i(this,function(n){return r=A(r=e.endpoint,t),delete e.endpoint,[2,Object(j.request)(r,e)]})})}function W(e){return a(this,void 0,void 0,function(){return i(this,function(t){return[2,B(e,u)]})})}function V(e){return a(this,void 0,void 0,function(){return i(this,function(t){return[2,B(e,s)]})})}function q(e){return a(this,void 0,void 0,function(){return i(this,function(t){return[2,B(e,p)]})})}function K(e){if(Array.isArray(e)){if(e.length<2)throw TypeError("Item must be an array with two or more elements.");return{geometry:{x:e[0],y:e[1]}}}return e}var H=function(){function e(e){this._url=A(e,u)}return Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),e.prototype.geometryToMeasure=function(e,t,r,n,o,u,s){return a(this,void 0,void 0,function(){var a,c;return i(this,function(i){switch(i.label){case 0:return a=this.url+"/networkLayers/"+e+"/geometryToMeasure",c={locations:t.map(K)},void 0!==r&&(c.tolerance=r),n&&(c.temporalViewDate=n.getTime()),o&&(c.inSR=o),u&&(c.outSR=u),s&&(c.gdbVersion=s),[4,Object(j.request)(a,{params:c})];case 1:return[2,i.sent()]}})})},e.prototype.measureToGeometry=function(e,t,r,n,o){return a(this,void 0,void 0,function(){var a,u;return i(this,function(i){switch(i.label){case 0:return a=this.url+"/networkLayers/"+e+"/measureToGeometry",u={layerId:e,locations:t},r&&(u.temporalViewDate=r.getTime()),n&&(u.outSR=n),o&&(u.gdbVersion=o),[4,Object(j.request)(a,{params:u})];case 1:return[2,i.sent()]}})})},e}();r.d(t,"dateToTimeInstant",function(){return n}),r.d(t,"validateUrl",function(){return A}),r.d(t,"getLrsServiceInfo",function(){return W}),r.d(t,"getAllLayers",function(){return V}),r.d(t,"getNetworkLayers",function(){return q}),r.d(t,"LrsClient",function(){return H}),r.d(t,"lrsServer",function(){return u}),r.d(t,"allLayers",function(){return s}),r.d(t,"applyEdits",function(){return c}),r.d(t,"createVersion",function(){return l}),r.d(t,"deleteVersion",function(){return f}),r.d(t,"reconcileVersion",function(){return d}),r.d(t,"networkLayers",function(){return p}),r.d(t,"networkLayer",function(){return m}),r.d(t,"geometryToMeasure",function(){return y}),r.d(t,"measureToGeometry",function(){return h}),r.d(t,"translate",function(){return b}),r.d(t,"concurrencies",function(){return v}),r.d(t,"queryAttributeSet",function(){return R}),r.d(t,"checkEvents",function(){return g}),r.d(t,"eventLayers",function(){return S}),r.d(t,"eventLayer",function(){return w}),r.d(t,"geometryToStation",function(){return L}),r.d(t,"stationToGeometry",function(){return U}),r.d(t,"redlineLayers",function(){return J}),r.d(t,"redlineLayer",function(){return I}),r.d(t,"centerlineLayers",function(){return _}),r.d(t,"centerlineLayer",function(){return C}),r.d(t,"calibrationPointLayers",function(){return E}),r.d(t,"calibrationPointLayer",function(){return x}),r.d(t,"intersectionLayers",function(){return P}),r.d(t,"intersectionLayer",function(){return D}),r.d(t,"nonLRSLayers",function(){return M}),r.d(t,"nonLRSLayer",function(){return O}),r.d(t,"locks",function(){return G}),r.d(t,"locksQuery",function(){return T}),r.d(t,"locksAcquire",function(){return N}),r.d(t,"locksRelease",function(){return F})}])}(r(8))},function(e,t,r){var n,o;n=[r,t,r(0),r(11)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var o=function(e){function t(t,r){var n=e.call(this,"No source found in Search widget with name matching "+r+".")||this;return n.search=t,n.searchName=r,n}return r.__extends(t,e),t}(Error);function a(e,t){void 0===t&&(t=/County/i);var r=function(e,t){void 0===t&&(t=/County/i);for(var r=e.sources,n=0;n<r.length;n++){var o=r[n];if(t instanceof RegExp&&t.test(o.name)||t===o.name)return n}return null}(e,t);if(null==r)throw new o(e,t);e.set("activeSourceIndex",r)}t.NoMatchingSourceError=o,t.createSearchLink=function(e){var t=document.createElement("a");return t.textContent="Zoom to a county via the Search box to make CRAB routes visible",t.href="#",t.onclick=function(){var t=n.default.byId("search");try{if(e){a(t,e),t.clear();var r=document.getElementById("search_menu_button");r&&r.click()}t.focus()}catch(e){e instanceof o?alert(e.message):console.error(e.message,e)}return!1},t}}.apply(t,n))||(e.exports=o)},function(t,r){t.exports=e},function(e,t,r){var n,o;n=[r,t,r(0),r(3),r(15),r(16),r(1)],void 0===(o=function(e,t,r,n,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){var u,s,c=this;this.mapServiceUrl=e,this.layerId=t,this.form=document.createElement("form"),this.form.classList.add("measure-to-geometry-form"),this.form.action=i.getLrsServerEndpointUrl(e,t,"measureToGeometry");var l=/^\d{1,5}$/;function f(){var e=parseInt(p.value,10),t=m.value.match(l);if(t){var r=""+(1e5*(53e3+e)+parseInt(t[0],10));y.value=r}else y.value=""}var d=document.createDocumentFragment(),p=document.createElement("select");p.appendChild(o.createCountyOptions()),p.required=!0,p.title="Select a county",p.id=i.generateId("countySelect");var m=document.createElement("input");m.id=i.generateId("roadNumber"),m.required=!0,m.pattern=l.source,m.title="Enter a one- to five-digit road number",[p,m].forEach(function(e){e.addEventListener("change",f)});var y=document.createElement("input");y.id=i.generateId("m2gRouteIdInput"),y.name="routeId",y.type="hidden",y.required=!0,y.pattern=a.crabRouteIdRe.source,d.appendChild(y);var h=document.createElement("input");h.id=i.generateId("m2gFromMeasureInput"),h.name="measure",h.title="begin measure in miles",h.required=!0;var b=document.createElement("input");b.id=i.generateId("m2gToMeasureField"),b.name="toMeasure",b.title="end measure in miles",b.placeholder="Please omit if not locating a line segment.",b.required=!1;try{for(var v=r.__values([h,b]),R=v.next();!R.done;R=v.next()){var g=R.value;g.type="number",g.step="0.001"}}catch(e){u={error:e}}finally{try{R&&!R.done&&(s=v.return)&&s.call(v)}finally{if(u)throw u.error}}var S=document.createElement("input");S.type="date",S.id=i.generateId("m2gTemporalViewDate"),S.name="temporalViewDate",i.addNamedControlsToElement(d,{County:p,"Road No.":m,"From Milepost":h,"To Milepost":b,"Temporal View Date":S}),this.routeIdInput=y,this.fromMeasureInput=h,this.toMeasureInput=b,this.temporalViewDateInput=S;var w=document.createElement("button");w.type="submit",w.textContent="Submit",d.appendChild(w);var L=document.createElement("button");L.type="reset",L.textContent="Reset",d.appendChild(L),this.form.appendChild(d),this.form.addEventListener("submit",function(e){var t=e.target,r=new n.LrsClient(c.form.action),o=c.temporalViewDateInput.value?c.temporalViewDateInput.valueAsDate:void 0,a=r.measureToGeometry(c.layerId,c.locations,o,3857),i=new CustomEvent("m2gsubmit",{detail:a});t.dispatchEvent(i),e.preventDefault()})}return Object.defineProperty(e.prototype,"temporalViewDate",{get:function(){return this.temporalViewDateInput.value?this.temporalViewDateInput.valueAsDate:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"locations",{get:function(){var e=this.routeIdInput.value,t=this.fromMeasureInput.valueAsNumber,r=this.toMeasureInput.value?this.toMeasureInput.valueAsNumber:null;return["i","d"].map(function(n){return null===r?{routeId:e+n,measure:t}:{routeId:e+n,fromMeasure:t,toMeasure:r}})},enumerable:!0,configurable:!0}),e}();t.MeasureToGeometryControl=u}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(2),r(6),r(1),r(17),r(4)],void 0===(o=function(e,t,r,n,o,a,i,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(n,t),r.__exportStar(o,t),r.__exportStar(a,t),r.__exportStar(i,t),r.__exportStar(u,t)}.apply(t,n))||(e.exports=o)},function(e,t,r){
/* @preserve
* @esri/arcgis-rest-request - v1.13.2 - Apache-2.0
* Copyright (c) 2017-2018 Esri, Inc.
* Fri Nov 02 2018 15:54:43 GMT-0700 (Pacific Daylight Time)
*/
!function(e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n=function(e,t,r,n,o){e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:t+": "+e,this.originalMessage=e,this.code=t,this.response=r,this.url=n,this.options=o};n.prototype=Object.create(Error.prototype),n.prototype.constructor=n;var o=function(e){function n(t,r,n,o,a){void 0===t&&(t="AUTHENTICATION_ERROR"),void 0===r&&(r="AUTHENTICATION_ERROR_CODE");var i=e.call(this,t,r,n,o,a)||this;return i.name="ArcGISAuthError",i.message="AUTHENTICATION_ERROR_CODE"===r?t:r+": "+t,i}return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}(n,e),n.prototype.retry=function(e,t){var n=this;void 0===t&&(t=3);var o=0,a=function(i,u){e(n.url,n.options).then(function(e){var t=r({},n.options,{authentication:e});return o+=1,f(n.url,t)}).then(function(e){i(e)}).catch(function(e){"ArcGISAuthError"===e.name&&o<t?a(i,u):"ArcGISAuthError"===e.name&&o>=t?u(n):u(e)})};return new Promise(function(e,t){a(e,t)})},n}(n);function a(e,t,r,a){if(e.code>=400){var i=e.message,u=e.code;throw new n(i,u,e,t,a)}if(e.error){var s=e.error,i=s.message,u=s.code,c=s.messageCode,l=c||u||"UNKNOWN_ERROR_CODE";if(498===u||499===u||"GWM_0003"===c)throw new o(i,l,e,t,a);throw new n(i,l,e,t,a)}if("failed"===e.status||"failure"===e.status){var i=void 0,u="UNKNOWN_ERROR_CODE";try{i=JSON.parse(e.statusMessage).message,u=JSON.parse(e.statusMessage).code}catch(t){i=e.statusMessage||e.message}throw new n(i,u,e,t,a)}return e}function i(e){return Object.keys(e).some(function(t){var r=e[t];if(!r)return!1;var n=r.constructor.name;switch(n){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}})}function u(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r];if(n||0===n||"boolean"==typeof n||"string"==typeof n){var o,a=n.constructor.name;switch(a){case"Array":o=n[0]&&n[0].constructor&&"Object"===n[0].constructor.name?JSON.stringify(n):n.join(",");break;case"Object":o=JSON.stringify(n);break;case"Date":o=n.valueOf();break;case"Function":o=null;break;case"Boolean":o=n+"";break;default:o=n}(o||0===o||"string"==typeof o)&&(t[r]=o)}}),t}function s(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(t)}function c(e){var t=u(e);return Object.keys(t).map(function(e){return s(e,t[e])}).join("&")}function l(e){var t=i(e),r=u(e);if(t){var n=new FormData;return Object.keys(r).forEach(function(e){if("undefined"!=typeof Blob&&r[e]instanceof Blob){var t=r.fileName||r[e].name||e;n.append(e,r[e],t)}else n.append(e,r[e])}),n}return c(e)}function f(e,t){void 0===t&&(t={params:{f:"json"}});var o=r({httpMethod:"POST"},t),u=[],s=[];if(o.fetch||"undefined"==typeof fetch?(u.push("`fetch`"),s.push("`isomorphic-fetch`")):o.fetch=fetch.bind(Function("return this")()),"undefined"==typeof Promise&&(u.push("`Promise`"),s.push("`es6-promise`")),"undefined"==typeof FormData&&(u.push("`FormData`"),s.push("`isomorphic-form-data`")),!o.fetch||"undefined"==typeof Promise||"undefined"==typeof FormData)throw new Error("`arcgis-rest-request` requires global variables for `fetch`, `Promise` and `FormData` to be present in the global scope. You are missing "+u.join(", ")+". We recommend installing the "+s.join(", ")+" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.");var f=o.httpMethod,d=o.authentication,p=r({f:"json"},t.params),m={method:f,credentials:"same-origin"};return(d?d.getToken(e,{fetch:o.fetch}):Promise.resolve("")).then(function(t){if(t.length&&(p.token=t),"GET"===m.method){var r=c(p),n=""===r?e:e+"?"+c(p);o.maxUrlLength&&n.length>o.maxUrlLength?m.method="POST":e=n}return"POST"===m.method&&(m.body=l(p)),i(p)||(m.headers={},m.headers["Content-Type"]="application/x-www-form-urlencoded"),o.fetch(e,m)}).then(function(t){if(!t.ok){var r=t.status,a=t.statusText;throw new n(a,"HTTP "+r,t,e,o)}switch(p.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();case"image":case"zip":default:return t.blob()}}).then(function(t){return"json"===p.f||"geojson"===p.f?a(t,e,0,o):t})}function d(e){return void 0===e&&(e={}),e.portal?e.portal:e.authentication?e.authentication.portal:"https://www.arcgis.com/sharing/rest"}function p(e,t){var n=e||"self",o=d(t)+"/portals/"+n,a=r({httpMethod:"GET"},t);return f(o,a)}(function(e){e.ArcGISRequestError="ArcGISRequestError",e.ArcGISAuthError="ArcGISAuthError"})(e.ErrorTypes||(e.ErrorTypes={})),e.request=f,e.encodeFormData=l,e.encodeParam=s,e.encodeQueryString=c,e.checkForErrors=a,e.warn=function(e){console&&console.warn&&console.warn.apply(console,[e])},e.ArcGISRequestError=n,e.ArcGISAuthError=o,e.requiresFormData=i,e.processParams=u,e.getSelf=function(e){return p(null,e)},e.getPortal=p,e.getPortalUrl=d,e.appendCustomParams=function(e,t){Object.keys(e).forEach(function(r){"url"!==r&&"params"!==r&&"authentication"!==r&&"httpMethod"!==r&&"fetch"!==r&&"portal"!==r&&"maxUrlLength"!==r&&"endpoint"!==r&&(t.params[r]=e[r])})},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t){e.exports=a},function(e,t){e.exports=i},function(e,t,r){var n,o;n=[r,t,r(0)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){var t,n,o=new Map;if(!e||!e.features)throw new TypeError("FeatureSet features not defined.");try{for(var a=r.__values(e.features),i=a.next();!i.done;i=a.next()){var u=i.value.attributes,s=u.JURLBL,c=u.JURFIPSDSG;if(!c||!s)throw new TypeError("FIPS: "+c+", Label: "+s);o.set(c-53e3,s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o}({displayFieldName:"JURLBL",fieldAliases:{JURLBL:"JURISDICTION LABEL",JURNM:"JURISDICTION NAME",JURDSG:"COUNTY NUMBER",JURFIPSDSG:"COUNTY FIPS CODE"},fields:[{name:"JURLBL",type:"esriFieldTypeString",alias:"JURISDICTION LABEL",length:20},{name:"JURNM",type:"esriFieldTypeString",alias:"JURISDICTION NAME",length:50},{name:"JURDSG",type:"esriFieldTypeDouble",alias:"COUNTY NUMBER"},{name:"JURFIPSDSG",type:"esriFieldTypeDouble",alias:"COUNTY FIPS CODE"}],features:[{attributes:{JURLBL:"Adams",JURNM:"Adams County",JURDSG:1,JURFIPSDSG:53001}},{attributes:{JURLBL:"Asotin",JURNM:"Asotin County",JURDSG:2,JURFIPSDSG:53003}},{attributes:{JURLBL:"Benton",JURNM:"Benton County",JURDSG:3,JURFIPSDSG:53005}},{attributes:{JURLBL:"Chelan",JURNM:"Chelan County",JURDSG:4,JURFIPSDSG:53007}},{attributes:{JURLBL:"Clallam",JURNM:"Clallam County",JURDSG:5,JURFIPSDSG:53009}},{attributes:{JURLBL:"Clark",JURNM:"Clark County",JURDSG:6,JURFIPSDSG:53011}},{attributes:{JURLBL:"Columbia",JURNM:"Columbia County",JURDSG:7,JURFIPSDSG:53013}},{attributes:{JURLBL:"Cowlitz",JURNM:"Cowlitz County",JURDSG:8,JURFIPSDSG:53015}},{attributes:{JURLBL:"Douglas",JURNM:"Douglas County",JURDSG:9,JURFIPSDSG:53017}},{attributes:{JURLBL:"Ferry",JURNM:"Ferry County",JURDSG:10,JURFIPSDSG:53019}},{attributes:{JURLBL:"Franklin",JURNM:"Franklin County",JURDSG:11,JURFIPSDSG:53021}},{attributes:{JURLBL:"Garfield",JURNM:"Garfield County",JURDSG:12,JURFIPSDSG:53023}},{attributes:{JURLBL:"Grant",JURNM:"Grant County",JURDSG:13,JURFIPSDSG:53025}},{attributes:{JURLBL:"Grays Harbor",JURNM:"Grays Harbor County",JURDSG:14,JURFIPSDSG:53027}},{attributes:{JURLBL:"Island",JURNM:"Island County",JURDSG:15,JURFIPSDSG:53029}},{attributes:{JURLBL:"Jefferson",JURNM:"Jefferson County",JURDSG:16,JURFIPSDSG:53031}},{attributes:{JURLBL:"King",JURNM:"King County",JURDSG:17,JURFIPSDSG:53033}},{attributes:{JURLBL:"Kitsap",JURNM:"Kitsap County",JURDSG:18,JURFIPSDSG:53035}},{attributes:{JURLBL:"Kittitas",JURNM:"Kittitas County",JURDSG:19,JURFIPSDSG:53037}},{attributes:{JURLBL:"Klickitat",JURNM:"Klickitat County",JURDSG:20,JURFIPSDSG:53039}},{attributes:{JURLBL:"Lewis",JURNM:"Lewis County",JURDSG:21,JURFIPSDSG:53041}},{attributes:{JURLBL:"Lincoln",JURNM:"Lincoln County",JURDSG:22,JURFIPSDSG:53043}},{attributes:{JURLBL:"Mason",JURNM:"Mason County",JURDSG:23,JURFIPSDSG:53045}},{attributes:{JURLBL:"Okanogan",JURNM:"Okanogan County",JURDSG:24,JURFIPSDSG:53047}},{attributes:{JURLBL:"Pacific",JURNM:"Pacific County",JURDSG:25,JURFIPSDSG:53049}},{attributes:{JURLBL:"Pend Oreille",JURNM:"Pend Oreille County",JURDSG:26,JURFIPSDSG:53051}},{attributes:{JURLBL:"Pierce",JURNM:"Pierce County",JURDSG:27,JURFIPSDSG:53053}},{attributes:{JURLBL:"San Juan",JURNM:"San Juan County",JURDSG:28,JURFIPSDSG:53055}},{attributes:{JURLBL:"Skagit",JURNM:"Skagit County",JURDSG:29,JURFIPSDSG:53057}},{attributes:{JURLBL:"Skamania",JURNM:"Skamania County",JURDSG:30,JURFIPSDSG:53059}},{attributes:{JURLBL:"Snohomish",JURNM:"Snohomish County",JURDSG:31,JURFIPSDSG:53061}},{attributes:{JURLBL:"Spokane",JURNM:"Spokane County",JURDSG:32,JURFIPSDSG:53063}},{attributes:{JURLBL:"Stevens",JURNM:"Stevens County",JURDSG:33,JURFIPSDSG:53065}},{attributes:{JURLBL:"Thurston",JURNM:"Thurston County",JURDSG:34,JURFIPSDSG:53067}},{attributes:{JURLBL:"Wahkiakum",JURNM:"Wahkiakum County",JURDSG:35,JURFIPSDSG:53069}},{attributes:{JURLBL:"Walla Walla",JURNM:"Walla Walla County",JURDSG:36,JURFIPSDSG:53071}},{attributes:{JURLBL:"Whatcom",JURNM:"Whatcom County",JURDSG:37,JURFIPSDSG:53073}},{attributes:{JURLBL:"Whitman",JURNM:"Whitman County",JURDSG:38,JURFIPSDSG:53075}},{attributes:{JURLBL:"Yakima",JURNM:"Yakima County",JURDSG:39,JURFIPSDSG:53077}}]});t.createCountyOptions=function(){var e,t,o=document.createDocumentFragment();o.appendChild(document.createElement("option"));try{for(var a=r.__values(n),i=a.next();!i.done;i=a.next()){var u=r.__read(i.value,2),s=u[0],c=u[1],l=document.createElement("option");l.value=s.toString(10),l.label=c,l.textContent=c,o.appendChild(l)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return o},t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crabRouteIdRe=/^(53\d{3})(\d{5})([a-z])$/,t.parseCrabRouteId=function(e){if(!e)throw new TypeError("The routeId cannot be falsy. Must match the following RegExp:\n"+t.crabRouteIdRe);var n=e.match(t.crabRouteIdRe);if(!n)throw new Error("Invalid CRAB route ID: "+e+". Must match "+t.crabRouteIdRe);var o=r.__read(n.slice(1,3).map(function(e){if(e){var t=parseInt(e,10);if(!isNaN(t))return t}return e}),2);return{countyFipsCode:o[0],roadNumber:o[1],direction:n[3]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(18),r(5),r(19),r(2),r(20),r(6),r(1)],void 0===(o=function(e,t,r,n,o,a,i,u,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupCrab=function(e,t,l){var f=this;void 0===t&&(t=c.defaultLrsMapServiceUrl),void 0===l&&(l=c.defaultLayerId);var d=document.getElementById("toolsAccordion");if(!d)throw Error("#toolsAccordion element not found.");var p=document.createElement("div");p.id="crabPane",d.appendChild(p);var m=new n({title:"CRMP",id:"crabPane"},p);e.addChild(m);var y=document.createElement("div");y.id="crabUI",window.addEventListener("mapload",function(e){var n=e.detail;n.addLayers([u.crabPointsLayer,u.crabLinesLayer]);var d=document.createElement("div");d.textContent="Locate a point on a County Road",d.classList.add("crab-tool-label"),y.appendChild(d);var p=document.createElement("p"),m=new i.GeometryToMeasureControl(n);m.tolerance=50,p.innerHTML="Select <b>"+m.form.querySelector("button[type=submit]").textContent+" </b> then click on a country road",y.appendChild(p),y.appendChild(m.form),m.form.addEventListener("geometryToMeasure",function(e){var t,o,a=e.detail,i=Array.from(c.IterateG2MOutputToFeatures(a));u.crabPointsLayer.suspend();try{try{for(var s=r.__values(i),l=s.next();!l.done;l=s.next()){var f=l.value;u.crabPointsLayer.add(f)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(t)throw t.error}}}finally{u.crabPointsLayer.resume()}if(i.length){var d=n.infoWindow;d.setFeatures(i);var p=i[0].geometry;d.show(p)}else{var m="No locations found: "+a.locations.map(function(e){return e.status}).join(", ");alert(m)}}),m.form.addEventListener("geometryToMeasureError",function(e){var t=e.detail;console.error("geometry to measure error",t),alert("Geometry to measure error. See console for details.")});var h=document.createElement("div");h.classList.add("crab-tool-label"),h.textContent="Locate a County Road and Milepost",y.appendChild(h);var b=new s.MeasureToGeometryControl(t,l);y.appendChild(b.form);var v=document.createElement("div");v.id="crabClearControls",v.classList.add("danger");var R=document.createElement("button");R.classList.add("clear-crab-button"),v.appendChild(R),R.textContent="🗑️❌ Remove graphics created by CRMP tools from the map ❌🗑️",R.onclick=function(){u.crabLinesLayer.graphics.length||u.crabPointsLayer.graphics.length?confirm("Are you sure you want to delete all graphics you created with the CRMP tool?")&&(u.crabLinesLayer.clear(),u.crabPointsLayer.clear()):alert("There are currently no graphics to remove.")},y.appendChild(v),b.form.addEventListener("m2gsubmit",function(e){return r.__awaiter(f,void 0,void 0,function(){var t,i,s,l,f,d,p,m,y,h,b,v,R,g,S;return r.__generator(this,function(w){switch(w.label){case 0:s=e.detail,l=n.infoWindow,w.label=1;case 1:return w.trys.push([1,3,,4]),[4,s];case 2:return f=w.sent(),[3,4];case 3:return d=w.sent(),console.error("measureToGeometry",d),[2];case 4:p=new Array,m=new Array,y=new Array,h=null;try{for(b=r.__values(c.m2gOutputToFeatures(f)),v=b.next();!v.done;v=b.next())(h=v.value).geometry?/Point$/i.test(h.geometry.type)?m.push(h):y.push(h):p.push(h)}catch(e){t={error:e}}finally{try{v&&!v.done&&(i=b.return)&&i.call(b)}finally{if(t)throw t.error}}return[u.crabPointsLayer,u.crabLinesLayer].forEach(function(e){return e.suspend()}),m.length&&m.forEach(function(e){return u.crabPointsLayer.add(e)}),y.length&&y.forEach(function(e){return u.crabLinesLayer.add(e)}),[u.crabPointsLayer,u.crabLinesLayer].forEach(function(e){return e.resume()}),(R=m.length?m[0]:y.length?y[0]:null)?(R.geometry instanceof o?n.centerAt(R.geometry):R.geometry instanceof a&&n.setExtent(R.geometry.getExtent()),(g=R.geometry instanceof o?R.geometry:R.geometry instanceof a?R.geometry.getPoint(0,0):null)&&l.show(g),l.setFeatures(m.concat(y)),[2]):(p&&p.length&&(S=p.map(function(e){var t=e.attributes;return t.routeId+": "+t.status}).join("\n"),alert(S)),[2])}})})})}),p.appendChild(y)}}.apply(t,n))||(e.exports=o)},function(e,t){e.exports=u},function(e,t){e.exports=s},function(e,t,r){var n,o;n=[r,t,r(21),r(22),r(23),r(24),r(25),r(26)],void 0===(o=function(e,t,r,n,o,a,i,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=new u;s.setColor(new r("red"));var c=new a(s),l=new Array({name:"routeId",type:"esriFieldTypeString",alias:"Route ID"},{name:"status",type:"esriFieldTypeString",alias:"Locating Status"},{name:"measure",type:"esriFieldTypeDouble",alias:"Measure"});function f(e){var t={fieldName:e.name,label:e.alias||e.name,visible:"routeId"!==e.name};return/Double$/i.test(e.type)&&(t.format={places:3}),t}var d=l.map(function(e){var t=e.name,r=(e.alias,e.type);return"measure"===t?{name:t="fromMeasure",type:r,alias:"From Measure"}:e}).concat([{name:"toMeasure",type:"esriFieldTypeDouble",alias:"To Measure"}]),p={geometryType:"esriGeometryPoint",fields:l},m={geometry:"esriGeometryLine",fields:d},y=[{expression:'// Extract county identifier and convert to number.\n  var cid = Number(Mid($feature.RouteId, 2, 3))\n\n  // Return the county name corresponding to the county id.\n  Decode (\n      cid,\n      1, "Adams",\n      3, "Asotin",\n      5, "Benton",\n      7, "Chelan",\n      9, "Clallam",\n      11, "Clark",\n      13, "Columbia",\n      15, "Cowlitz",\n      17, "Douglas",\n      19, "Ferry",\n      21, "Franklin",\n      23, "Garfield",\n      25, "Grant",\n      27, "Grays Harbor",\n      29, "Island",\n      31, "Jefferson",\n      33, "King",\n      35, "Kitsap",\n      37, "Kittitas",\n      39, "Klickitat",\n      41, "Lewis",\n      43, "Lincoln",\n      45, "Mason",\n      47, "Okanogan",\n      49, "Pacific",\n      51, "Pend Oreille",\n      53, "Pierce",\n      55, "San Juan",\n      57, "Skagit",\n      59, "Skamania",\n      61, "Snohomish",\n      63, "Spokane",\n      65, "Stevens",\n      67, "Thurston",\n      69, "Wahkiakum",\n      71, "Walla Walla",\n      73, "Whatcom",\n      75, "Whitman",\n      77, "Yakima",\n      "Invalid"\n  )',name:"county",returnType:"string",title:"County"},{name:"roadNumber",expression:"Mid($feature.RouteId, 5, 5)",title:"County Road Number",returnType:"string"}],h=y.map(function(e){return{fieldName:"expression/"+e.name,label:e.title||e.name,visible:!0}}),b=new n({title:"Located CRAB Point",fieldInfos:h.concat(l.map(f)),expressionInfos:y}),v=new n({title:"Located CRAB Line Segment",fieldInfos:h.concat(d.map(f)),expressionInfos:y}),R=new o({layerDefinition:p,featureSet:null},{id:"CRAB Points"});t.crabPointsLayer=R,R.setInfoTemplate(b),R.setRenderer(c);var g=new o({layerDefinition:m,featureSet:null},{id:"CRAB Lines"});t.crabLinesLayer=g,g.setInfoTemplate(v);var S=new a(new i(i.STYLE_SOLID,new r("red"),3));g.setRenderer(S)}.apply(t,n))||(e.exports=o)},function(e,t){e.exports=c},function(e,t){e.exports=l},function(e,t){e.exports=f},function(e,t){e.exports=d},function(e,t){e.exports=p},function(e,t){e.exports=m}])});
//# sourceMappingURL=main.js.map