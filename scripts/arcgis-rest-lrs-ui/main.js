define(["esri/map","esri/toolbars/draw","dijit/registry","esri/geometry/jsonUtils","esri/geometry/Point","esri/graphic","esri/SpatialReference","dijit/layout/ContentPane","esri/geometry/Polyline","esri/Color","esri/dijit/PopupTemplate","esri/layers/FeatureLayer","esri/renderers/SimpleRenderer","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleMarkerSymbol"],((e,t,r,n,o,s,a,i,c,u,l,d,p,h,f)=>(()=>{var m={1628:(e,t,r)=>{var n;self,n=e=>(()=>{"use strict";var t={313:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e,t){super(`${e} does not match ${t}.`),this.url=e,this.re=t}}t.default=r},94:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dateToTimeInstant=void 0,t.dateToTimeInstant=function(e){return e.getTime()}},920:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(94),t),o(r(773),t),o(r(968),t),o(r(313),t),o(r(409),t)},773:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},968:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LrsClient=t.getNetworkLayers=t.getAllLayers=t.getLrsServiceInfo=t.validateUrl=void 0;const c=s(r(409)),u=r(108),l=i(r(313));function d(e,t){const r=e.match(t);if(r)return r[0];throw new l.default(e,t)}function p(e,t){return a(this,void 0,void 0,(function*(){let{endpoint:r}=e;return r=d(r,t),delete e.endpoint,(0,u.request)(r,e)}))}function h(e){if(Array.isArray(e)){if(e.length<2)throw TypeError("Item must be an array with two or more elements.");return{geometry:{x:e[0],y:e[1]}}}return e}t.validateUrl=d,t.getLrsServiceInfo=function(e){return a(this,void 0,void 0,(function*(){return p(e,c.lrsServer)}))},t.getAllLayers=function(e){return a(this,void 0,void 0,(function*(){return p(e,c.allLayers)}))},t.getNetworkLayers=function(e){return a(this,void 0,void 0,(function*(){return p(e,c.networkLayers)}))},t.LrsClient=class{constructor(e){this._url=d(e,c.lrsServer)}get url(){return this._url}geometryToMeasure(e,t,r,n,o,s,i){return a(this,void 0,void 0,(function*(){const a=`${this.url}/networkLayers/${e}/geometryToMeasure`,c={locations:t.map(h)};return void 0!==r&&(c.tolerance=r),n&&(c.temporalViewDate=n.getTime()),o&&(c.inSR=o),s&&(c.outSR=s),i&&(c.gdbVersion=i),yield(0,u.request)(a,{params:c})}))}measureToGeometry(e,t,r,n,o){return a(this,void 0,void 0,(function*(){const s=`${this.url}/networkLayers/${e}/measureToGeometry`,a={layerId:e,locations:t};return r&&(a.temporalViewDate=r.getTime()),n&&(a.outSR=n),o&&(a.gdbVersion=o),yield(0,u.request)(s,{params:a})}))}}},409:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.locksRelease=t.locksAcquire=t.locksQuery=t.locks=t.nonLRSLayer=t.nonLRSLayers=t.intersectionLayer=t.intersectionLayers=t.calibrationPointLayer=t.calibrationPointLayers=t.centerlineLayer=t.centerlineLayers=t.redlineLayer=t.redlineLayers=t.stationToGeometry=t.geometryToStation=t.eventLayer=t.eventLayers=t.checkEvents=t.queryAttributeSet=t.concurrencies=t.translate=t.measureToGeometry=t.geometryToMeasure=t.networkLayer=t.networkLayers=t.reconcileVersion=t.deleteVersion=t.createVersion=t.applyEdits=t.allLayers=t.lrsServer=void 0,t.lrsServer=/^https?:\/\/.+\/MapServer\/exts\/LRSS?erver\b/,t.allLayers=new RegExp(`${t.lrsServer.source}/layers\\b`),t.applyEdits=new RegExp(`${t.lrsServer.source}/applyEdits\\b`),t.createVersion=new RegExp(`${t.lrsServer.source}/createVersion\\b`),t.deleteVersion=new RegExp(`${t.lrsServer.source}/deleteVersion\\b`),t.reconcileVersion=new RegExp(`${t.lrsServer.source}/reconcileVersion\\b`),t.networkLayers=new RegExp(`${t.lrsServer.source}/networkLayers\\b`),t.networkLayer=new RegExp(`${t.networkLayers.source}/\\d+\\b`),t.geometryToMeasure=new RegExp(`${t.networkLayer.source}/geometryToMeasure\\b`),t.measureToGeometry=new RegExp(`${t.networkLayer.source}/measureToGeometry\\b`),t.translate=new RegExp(`${t.networkLayer.source}/translate\\b`),t.concurrencies=new RegExp(`${t.networkLayer.source}/concurrencies\\b`),t.queryAttributeSet=new RegExp(`${t.networkLayer.source}/queryAttributeSet\\b`),t.checkEvents=new RegExp(`${t.networkLayer.source}/checkEvents\\b`),t.eventLayers=new RegExp(`${t.lrsServer.source}/eventLayers\\b`),t.eventLayer=new RegExp(`${t.eventLayers.source}/\\d+\\b`),t.geometryToStation=new RegExp(`${t.eventLayer.source}/geometryToStation\\b`),t.stationToGeometry=new RegExp(`${t.eventLayer.source}/stationToGeometry\\b`),t.redlineLayers=new RegExp(`${t.lrsServer.source}/redlineLayers\\b`),t.redlineLayer=new RegExp(`${t.redlineLayers.source}/\\d+\\b`),t.centerlineLayers=new RegExp(`${t.lrsServer.source}/centerlineLayers\\b`),t.centerlineLayer=new RegExp(`${t.centerlineLayers.source}/\\d+\\b`),t.calibrationPointLayers=new RegExp(`${t.lrsServer.source}/calibrationPointLayers\\b`),t.calibrationPointLayer=new RegExp(`${t.calibrationPointLayers.source}/\\d+\\b`),t.intersectionLayers=new RegExp(`${t.lrsServer.source}/intersectionLayers\\b`),t.intersectionLayer=new RegExp(`${t.intersectionLayers.source}/\\d+\\b`),t.nonLRSLayers=new RegExp(`${t.lrsServer.source}/nonLRSLayers\\b`),t.nonLRSLayer=new RegExp(`${t.nonLRSLayers.source}/\\d+\\b`),t.locks=new RegExp(`${t.lrsServer.source}/locks\\b`),t.locksQuery=new RegExp(`${t.locks.source}/query\\b`),t.locksAcquire=new RegExp(`${t.locks.source}/acquire\\b`),t.locksRelease=new RegExp(`${t.locks.source}/release\\b`)},108:t=>{t.exports=e}},r={};return function e(n){var o=r[n];if(void 0!==o)return o.exports;var s=r[n]={exports:{}};return t[n].call(s.exports,s,s.exports,e),s.exports}(920)})(),e.exports=n(r(9789))},855:e=>{e.exports=function(e){return{all:e=e||new Map,on:function(t,r){var n=e.get(t);n?n.push(r):e.set(t,[r])},off:function(t,r){var n=e.get(t);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var n=e.get(t);n&&n.slice().map((function(e){e(r)})),(n=e.get("*"))&&n.slice().map((function(e){e(t,r)}))}}}},4776:(e,t,r)=>{var n,o;n=[r,t,r(7582)],o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCountyOptions=void 0;var n=function(e){var t,n,o=new Map;if(!e||!e.features)throw new TypeError("FeatureSet features not defined.");try{for(var s=r.__values(e.features),a=s.next();!a.done;a=s.next()){var i=a.value.attributes,c=i.JURLBL,u=i.JURFIPSDSG;if(!u||!c)throw new TypeError("FIPS: ".concat(u,", Label: ").concat(c));o.set(u-53e3,c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o}({displayFieldName:"JURLBL",fieldAliases:{JURLBL:"JURISDICTION LABEL",JURNM:"JURISDICTION NAME",JURDSG:"COUNTY NUMBER",JURFIPSDSG:"COUNTY FIPS CODE"},fields:[{name:"JURLBL",type:"esriFieldTypeString",alias:"JURISDICTION LABEL",length:20},{name:"JURNM",type:"esriFieldTypeString",alias:"JURISDICTION NAME",length:50},{name:"JURDSG",type:"esriFieldTypeDouble",alias:"COUNTY NUMBER"},{name:"JURFIPSDSG",type:"esriFieldTypeDouble",alias:"COUNTY FIPS CODE"}],features:[{attributes:{JURLBL:"Adams",JURNM:"Adams County",JURDSG:1,JURFIPSDSG:53001}},{attributes:{JURLBL:"Asotin",JURNM:"Asotin County",JURDSG:2,JURFIPSDSG:53003}},{attributes:{JURLBL:"Benton",JURNM:"Benton County",JURDSG:3,JURFIPSDSG:53005}},{attributes:{JURLBL:"Chelan",JURNM:"Chelan County",JURDSG:4,JURFIPSDSG:53007}},{attributes:{JURLBL:"Clallam",JURNM:"Clallam County",JURDSG:5,JURFIPSDSG:53009}},{attributes:{JURLBL:"Clark",JURNM:"Clark County",JURDSG:6,JURFIPSDSG:53011}},{attributes:{JURLBL:"Columbia",JURNM:"Columbia County",JURDSG:7,JURFIPSDSG:53013}},{attributes:{JURLBL:"Cowlitz",JURNM:"Cowlitz County",JURDSG:8,JURFIPSDSG:53015}},{attributes:{JURLBL:"Douglas",JURNM:"Douglas County",JURDSG:9,JURFIPSDSG:53017}},{attributes:{JURLBL:"Ferry",JURNM:"Ferry County",JURDSG:10,JURFIPSDSG:53019}},{attributes:{JURLBL:"Franklin",JURNM:"Franklin County",JURDSG:11,JURFIPSDSG:53021}},{attributes:{JURLBL:"Garfield",JURNM:"Garfield County",JURDSG:12,JURFIPSDSG:53023}},{attributes:{JURLBL:"Grant",JURNM:"Grant County",JURDSG:13,JURFIPSDSG:53025}},{attributes:{JURLBL:"Grays Harbor",JURNM:"Grays Harbor County",JURDSG:14,JURFIPSDSG:53027}},{attributes:{JURLBL:"Island",JURNM:"Island County",JURDSG:15,JURFIPSDSG:53029}},{attributes:{JURLBL:"Jefferson",JURNM:"Jefferson County",JURDSG:16,JURFIPSDSG:53031}},{attributes:{JURLBL:"King",JURNM:"King County",JURDSG:17,JURFIPSDSG:53033}},{attributes:{JURLBL:"Kitsap",JURNM:"Kitsap County",JURDSG:18,JURFIPSDSG:53035}},{attributes:{JURLBL:"Kittitas",JURNM:"Kittitas County",JURDSG:19,JURFIPSDSG:53037}},{attributes:{JURLBL:"Klickitat",JURNM:"Klickitat County",JURDSG:20,JURFIPSDSG:53039}},{attributes:{JURLBL:"Lewis",JURNM:"Lewis County",JURDSG:21,JURFIPSDSG:53041}},{attributes:{JURLBL:"Lincoln",JURNM:"Lincoln County",JURDSG:22,JURFIPSDSG:53043}},{attributes:{JURLBL:"Mason",JURNM:"Mason County",JURDSG:23,JURFIPSDSG:53045}},{attributes:{JURLBL:"Okanogan",JURNM:"Okanogan County",JURDSG:24,JURFIPSDSG:53047}},{attributes:{JURLBL:"Pacific",JURNM:"Pacific County",JURDSG:25,JURFIPSDSG:53049}},{attributes:{JURLBL:"Pend Oreille",JURNM:"Pend Oreille County",JURDSG:26,JURFIPSDSG:53051}},{attributes:{JURLBL:"Pierce",JURNM:"Pierce County",JURDSG:27,JURFIPSDSG:53053}},{attributes:{JURLBL:"San Juan",JURNM:"San Juan County",JURDSG:28,JURFIPSDSG:53055}},{attributes:{JURLBL:"Skagit",JURNM:"Skagit County",JURDSG:29,JURFIPSDSG:53057}},{attributes:{JURLBL:"Skamania",JURNM:"Skamania County",JURDSG:30,JURFIPSDSG:53059}},{attributes:{JURLBL:"Snohomish",JURNM:"Snohomish County",JURDSG:31,JURFIPSDSG:53061}},{attributes:{JURLBL:"Spokane",JURNM:"Spokane County",JURDSG:32,JURFIPSDSG:53063}},{attributes:{JURLBL:"Stevens",JURNM:"Stevens County",JURDSG:33,JURFIPSDSG:53065}},{attributes:{JURLBL:"Thurston",JURNM:"Thurston County",JURDSG:34,JURFIPSDSG:53067}},{attributes:{JURLBL:"Wahkiakum",JURNM:"Wahkiakum County",JURDSG:35,JURFIPSDSG:53069}},{attributes:{JURLBL:"Walla Walla",JURNM:"Walla Walla County",JURDSG:36,JURFIPSDSG:53071}},{attributes:{JURLBL:"Whatcom",JURNM:"Whatcom County",JURDSG:37,JURFIPSDSG:53073}},{attributes:{JURLBL:"Whitman",JURNM:"Whitman County",JURDSG:38,JURFIPSDSG:53075}},{attributes:{JURLBL:"Yakima",JURNM:"Yakima County",JURDSG:39,JURFIPSDSG:53077}}]});t.createCountyOptions=function(){var e,t,o=document.createDocumentFragment();o.appendChild(document.createElement("option"));try{for(var s=r.__values(n),a=s.next();!a.done;a=s.next()){var i=r.__read(a.value,2),c=i[0],u=i[1],l=document.createElement("option");l.value=c.toString(10),l.label=u,l.textContent=u,o.appendChild(l)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return o},t.default=n}.apply(t,n),void 0===o||(e.exports=o)},7301:(e,t,r)=>{var n,o;n=[r,t,r(7582),r(1628),r(1231),r(8362),r(7857),r(7205)],o=function(e,t,r,n,o,s,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeometryToMeasureControl=void 0;var c=function(){function e(e,t,c){void 0===t&&(t=i.defaultLrsSvcUrl),void 0===c&&(c=i.defaultLayerId);var u=this;if(this.map=e,this.url=t,this.layerId=c,!(e&&e instanceof o))throw TypeError("Invalid map: ".concat(e));this.form=function(e,t){void 0===e&&(e=i.defaultLrsSvcUrl),void 0===t&&(t=i.defaultLayerId);var r=document.createElement("form");r.id=(0,i.generateId)("geometryToMeasureForm"),r.action="".concat(e,"/networkLayers/").concat(t,"/geometryToMeasure");var n=(0,a.createSearchLink)(/County/i),o=document.createElement("p");o.appendChild(n),r.appendChild(o);var s=document.createElement("input");s.type="number",s.min="0",s.name="tolerance",s.id=(0,i.generateId)("toleranceInput"),s.title="The maximum distance in map units (feet) to snap a point to the closest location on a nearby route. If a point is farther than the tolerance from a route, then an indication is returned that the point is not locatable.",(0,i.addToFormWithLabel)(r,s).textContent="Tolerance (in feet)";var c=document.createElement("input");c.type="date",c.name="temporalViewDate",c.id=(0,i.generateId)("temporalViewDateInput"),(0,i.addToFormWithLabel)(r,c);var u=document.createElement("button");return u.type="submit",u.textContent="Locate",r.appendChild(u),r}(t,c),this.draw=new s(this.map),this.lrsClient=new n.LrsClient(t);var l=this;this.form.addEventListener("submit",(function(e){try{l.draw.activate(s.POINT),l.map.setInfoWindowOnClick(!1),l.map.disablePopups()}catch(e){alert("Error: Could not activate the draw toolbar."),console.error("Error activating the draw toolbar",e)}e.preventDefault()})),this.draw.on("draw-complete",(function(e){return r.__awaiter(u,void 0,void 0,(function(){var t,n,o,s,a,i;return r.__generator(this,(function(r){switch(r.label){case 0:if(l.draw.deactivate(),l.map.setInfoWindowOnClick(!0),l.map.enablePopups(),!e.geometry||!e.geometry.type.match(/point/gi))return[2];t=e.geometry,n=e.geometry.spatialReference.wkid,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.lrsClient.geometryToMeasure(l.layerId,[[t.x,t.y]],l.tolerance,l.temporalViewDate,n,n)];case 2:return o=r.sent(),s=new CustomEvent("geometryToMeasure",{detail:o}),l.form.dispatchEvent(s),[3,4];case 3:return a=r.sent(),i=new CustomEvent("geometryToMeasureError",{detail:a}),l.form.dispatchEvent(i),[3,4];case 4:return[2]}}))}))}))}return Object.defineProperty(e.prototype,"toleranceInput",{get:function(){var e="tolerance",t=this.form.elements.namedItem(e);if(!(t&&t instanceof HTMLInputElement))throw new Error("No input element named ".concat(e," was found in this form."));return t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tolerance",{get:function(){var e=this.toleranceInput;return Number(e.value)},set:function(e){this.toleranceInput.value=null!=e?e.toString(10):""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"temporalViewDate",{get:function(){var e=this.form.elements.namedItem("temporalViewDate");if(e&&e.value)return e.valueAsDate||void 0},enumerable:!1,configurable:!0}),e}();t.GeometryToMeasureControl=c}.apply(t,n),void 0===o||(e.exports=o)},5389:(e,t,r)=>{var n,o;n=[r,t,r(7582),r(6048),r(7962),r(7130),r(7301),r(8868),r(2626),r(7205)],o=function(e,t,r,n,o,s,a,i,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupCrab=void 0,t.setupCrab=function(e,t,l){var d=this;void 0===t&&(t=u.defaultLrsMapServiceUrl),void 0===l&&(l=u.defaultLayerId);var p=document.getElementById("toolsAccordion");if(!p)throw Error("#toolsAccordion element not found.");var h=document.createElement("div");h.id="crabPane",p.appendChild(h);var f=new n({title:"CRMP",id:"crabPane"},h);e.addChild(f);var m=document.createElement("div");m.id="crabUI",window.addEventListener("mapload",(function(e){var n=e.detail;n.addLayers([i.crabPointsLayer,i.crabLinesLayer]);var p="crab-tool-label",h=document.createElement("div");h.textContent="Locate a point on a County Road",h.classList.add(p),m.appendChild(h);var f=document.createElement("p"),y=new a.GeometryToMeasureControl(n);y.tolerance=50,f.innerHTML="Select <b>".concat(y.form.querySelector("button[type=submit]").textContent," </b> then click on a country road"),m.appendChild(f),m.appendChild(y.form),y.form.addEventListener("geometryToMeasure",(function(e){var t,o,s=e.detail,a=Array.from((0,u.IterateG2MOutputToFeatures)(s));i.crabPointsLayer.suspend();try{try{for(var c=r.__values(a),l=c.next();!l.done;l=c.next()){var d=l.value;i.crabPointsLayer.add(d)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(t)throw t.error}}}finally{i.crabPointsLayer.resume()}if(a.length){var p=n.infoWindow;p.setFeatures(a);var h=a[0].geometry;p.show(h)}else{var f=s.locations.map((function(e){return e.status})),m="No locations found: ".concat(f.join(", "));alert(m)}})),y.form.addEventListener("geometryToMeasureError",(function(e){var t=e.detail;console.error("geometry to measure error",t),alert("Geometry to measure error. See console for details.")}));var g=document.createElement("div");g.classList.add(p),g.textContent="Locate a County Road and Milepost",m.appendChild(g);var _=new c.MeasureToGeometryControl(t,l);m.appendChild(_.form);var S=document.createElement("div");S.id="crabClearControls",S.classList.add("danger");var v=document.createElement("button");v.classList.add("clear-crab-button"),S.appendChild(v),v.textContent="🗑️❌ Remove graphics created by CRMP tools from the map ❌🗑️",v.onclick=function(){i.crabLinesLayer.graphics.length||i.crabPointsLayer.graphics.length?confirm("Are you sure you want to delete all graphics you created with the CRMP tool?")&&(i.crabLinesLayer.clear(),i.crabPointsLayer.clear()):alert("There are currently no graphics to remove.")},m.appendChild(S),_.form.addEventListener("m2gsubmit",(function(e){return r.__awaiter(d,void 0,void 0,(function(){var t,a,c,l,d,p,h,f,m,y,g,_,S,v,b;return r.__generator(this,(function(E){switch(E.label){case 0:t=e.detail,a=n.infoWindow,E.label=1;case 1:return E.trys.push([1,3,,4]),[4,t];case 2:return c=E.sent(),[3,4];case 3:return l=E.sent(),console.error("measureToGeometry",l),[2];case 4:d=new Array,p=new Array,h=new Array,f=null;try{for(m=r.__values((0,u.m2gOutputToFeatures)(c)),y=m.next();!y.done;y=m.next())(f=y.value).geometry?/Point$/i.test(f.geometry.type)?p.push(f):h.push(f):d.push(f)}catch(e){v={error:e}}finally{try{y&&!y.done&&(b=m.return)&&b.call(m)}finally{if(v)throw v.error}}return[i.crabPointsLayer,i.crabLinesLayer].forEach((function(e){return e.suspend()})),p.length&&p.forEach((function(e){return i.crabPointsLayer.add(e)})),h.length&&h.forEach((function(e){return i.crabLinesLayer.add(e)})),[i.crabPointsLayer,i.crabLinesLayer].forEach((function(e){return e.resume()})),(g=p.length?p[0]:h.length?h[0]:null)?(g.geometry instanceof o?n.centerAt(g.geometry):g.geometry instanceof s&&n.setExtent(g.geometry.getExtent()),(_=g.geometry instanceof o?g.geometry:g.geometry instanceof s?g.geometry.getPoint(0,0):null)&&a.show(_),a.setFeatures(p.concat(h)),[2]):(d&&d.length&&(S=d.map((function(e){var t=e.attributes,r=t.routeId,n=t.status;return"".concat(r,": ").concat(n)})).join("\n"),alert(S)),[2])}}))}))}))})),h.appendChild(m)}}.apply(t,n),void 0===o||(e.exports=o)},2626:(e,t,r)=>{var n,o;n=[r,t,r(7582),r(1628),r(4776),r(7808),r(7205)],o=function(e,t,r,n,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MeasureToGeometryControl=void 0;var i=function(){function e(e,t){var i,c,u=this;this.mapServiceUrl=e,this.layerId=t,this.form=document.createElement("form"),this.form.classList.add("measure-to-geometry-form"),this.form.action=(0,a.getLrsServerEndpointUrl)(e,t,"measureToGeometry");var l=/^\d{1,5}$/;function d(){var e=parseInt(h.value,10),t=f.value.match(l);if(t){var r=parseInt(t[0],10),n="".concat(1e5*(53e3+e)+r);m.value=n}else m.value=""}var p=document.createDocumentFragment(),h=document.createElement("select");h.appendChild((0,o.createCountyOptions)()),h.required=!0,h.title="Select a county",h.id=(0,a.generateId)("countySelect");var f=document.createElement("input");f.id=(0,a.generateId)("roadNumber"),f.required=!0,f.pattern=l.source,f.title="Enter a one- to five-digit road number",[h,f].forEach((function(e){e.addEventListener("change",d)}));var m=document.createElement("input");m.id=(0,a.generateId)("m2gRouteIdInput"),m.name="routeId",m.type="hidden",m.required=!0,m.pattern=s.crabRouteIdRe.source,p.appendChild(m);var y=document.createElement("input");y.id=(0,a.generateId)("m2gFromMeasureInput"),y.name="measure",y.title="begin measure in miles",y.required=!0;var g=document.createElement("input");g.id=(0,a.generateId)("m2gToMeasureField"),g.name="toMeasure",g.title="end measure in miles",g.placeholder="Please omit if not locating a line segment.",g.required=!1;try{for(var _=r.__values([y,g]),S=_.next();!S.done;S=_.next()){var v=S.value;v.type="number",v.step="0.001"}}catch(e){i={error:e}}finally{try{S&&!S.done&&(c=_.return)&&c.call(_)}finally{if(i)throw i.error}}var b=document.createElement("input");b.type="date",b.id=(0,a.generateId)("m2gTemporalViewDate"),b.name="temporalViewDate",(0,a.addNamedControlsToElement)(p,{County:h,"Road No.":f,"From Milepost":y,"To Milepost":g,"Temporal View Date":b}),this.routeIdInput=m,this.fromMeasureInput=y,this.toMeasureInput=g,this.temporalViewDateInput=b;var E=document.createElement("button");E.type="submit",E.textContent="Submit",p.appendChild(E);var w=document.createElement("button");w.type="reset",w.textContent="Reset",p.appendChild(w),this.form.appendChild(p),this.form.addEventListener("submit",(function(e){var t=e.target,r=new n.LrsClient(u.form.action),o=u.temporalViewDateInput.value&&u.temporalViewDateInput.valueAsDate||void 0,s=r.measureToGeometry(u.layerId,u.locations,o,3857),a=new CustomEvent("m2gsubmit",{detail:s});t.dispatchEvent(a),e.preventDefault()}))}return Object.defineProperty(e.prototype,"temporalViewDate",{get:function(){return this.temporalViewDateInput.value?new Date(this.temporalViewDateInput.value):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"locations",{get:function(){var e=this.routeIdInput.value,t=parseFloat(this.fromMeasureInput.value),r=this.toMeasureInput.value?parseFloat(this.toMeasureInput.value):null;return["i","d"].map((function(n){return null===r?{routeId:e+n,measure:t}:{routeId:e+n,fromMeasure:t,toMeasure:r}}))},enumerable:!1,configurable:!0}),e}();t.MeasureToGeometryControl=i}.apply(t,n),void 0===o||(e.exports=o)},7857:(e,t,r)=>{var n,o;n=[r,t,r(7582),r(189)],o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSearchLink=t.NoMatchingSourceError=void 0,n=r.__importDefault(n);var o=function(e){function t(t,r){var n=e.call(this,"No source found in Search widget with name matching ".concat(r,"."))||this;return n.search=t,n.searchName=r,n}return r.__extends(t,e),t}(Error);t.NoMatchingSourceError=o,t.createSearchLink=function(e){var t=document.createElement("a");return t.textContent="Zoom to a county via the Search box to make CRAB routes visible",t.href="#",t.onclick=function(){var t=n.default.byId("search");try{if(e){(function(e,t){void 0===t&&(t=/County/i);var r=function(e,t){void 0===t&&(t=/County/i);for(var r=e.sources,n=0;n<r.length;n++){var o=r[n];if(t instanceof RegExp&&t.test(o.name)||t===o.name)return n}return null}(e,t);if(null==r)throw new o(e,t);e.set("activeSourceIndex",r)})(t,e),t.clear();var r=document.getElementById("search_menu_button");r&&r.click()}t.focus()}catch(e){e instanceof o?alert(e.message):console.error(e.message,e)}return!1},t}}.apply(t,n),void 0===o||(e.exports=o)},7808:(e,t,r)=>{var n,o;n=[r,t,r(7582)],o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseCrabRouteId=t.crabRouteIdRe=void 0,t.crabRouteIdRe=/^(53\d{3})(\d{5})([a-z])$/,t.parseCrabRouteId=function(e){if(!e)throw new TypeError("The routeId cannot be falsy. Must match the following RegExp:\n".concat(t.crabRouteIdRe));var n=e.match(t.crabRouteIdRe);if(!n)throw new Error("Invalid CRAB route ID: ".concat(e,". Must match ").concat(t.crabRouteIdRe));var o=r.__read(n.slice(1,3).map((function(e){if(e){var t=parseInt(e,10);if(!isNaN(t))return t}return e})),2);return{countyFipsCode:o[0],roadNumber:o[1],direction:n[3]}}}.apply(t,n),void 0===o||(e.exports=o)},8868:(e,t,r)=>{var n,o;n=[r,t,r(3795),r(486),r(4296),r(9035),r(1861),r(693)],o=function(e,t,r,n,o,s,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crabLinesLayer=t.crabPointsLayer=void 0;var c=new i;c.setColor(new r("red"));var u=new s(c),l=new Array({name:"routeId",type:"esriFieldTypeString",alias:"Route ID"},{name:"status",type:"esriFieldTypeString",alias:"Locating Status"},{name:"measure",type:"esriFieldTypeDouble",alias:"Measure"});function d(e){var t={fieldName:e.name,label:e.alias||e.name,visible:"routeId"!==e.name};return/Double$/i.test(e.type)&&(t.format={places:3}),t}var p=l.map((function(e){var t=e.name,r=(e.alias,e.type);return"measure"===t?{name:t="fromMeasure",type:r,alias:"From Measure"}:e})).concat([{name:"toMeasure",type:"esriFieldTypeDouble",alias:"To Measure"}]),h={geometryType:"esriGeometryPoint",fields:l},f={geometry:"esriGeometryLine",fields:p},m=[{expression:'// Extract county identifier and convert to number.\n  var cid = Number(Mid($feature.RouteId, 2, 3))\n\n  // Return the county name corresponding to the county id.\n  Decode (\n      cid,\n      1, "Adams",\n      3, "Asotin",\n      5, "Benton",\n      7, "Chelan",\n      9, "Clallam",\n      11, "Clark",\n      13, "Columbia",\n      15, "Cowlitz",\n      17, "Douglas",\n      19, "Ferry",\n      21, "Franklin",\n      23, "Garfield",\n      25, "Grant",\n      27, "Grays Harbor",\n      29, "Island",\n      31, "Jefferson",\n      33, "King",\n      35, "Kitsap",\n      37, "Kittitas",\n      39, "Klickitat",\n      41, "Lewis",\n      43, "Lincoln",\n      45, "Mason",\n      47, "Okanogan",\n      49, "Pacific",\n      51, "Pend Oreille",\n      53, "Pierce",\n      55, "San Juan",\n      57, "Skagit",\n      59, "Skamania",\n      61, "Snohomish",\n      63, "Spokane",\n      65, "Stevens",\n      67, "Thurston",\n      69, "Wahkiakum",\n      71, "Walla Walla",\n      73, "Whatcom",\n      75, "Whitman",\n      77, "Yakima",\n      "Invalid"\n  )',name:"county",returnType:"string",title:"County"},{name:"roadNumber",expression:"Mid($feature.RouteId, 5, 5)",title:"County Road Number",returnType:"string"}],y=m.map((function(e){return{fieldName:"expression/".concat(e.name),label:e.title||e.name,visible:!0}})),g=new n({title:"Located CRAB Point",fieldInfos:y.concat(l.map(d)),expressionInfos:m}),_=new n({title:"Located CRAB Line Segment",fieldInfos:y.concat(p.map(d)),expressionInfos:m}),S=new o({layerDefinition:h,featureSet:null},{id:"CRAB Points"});t.crabPointsLayer=S,S.setInfoTemplate(g),S.setRenderer(u);var v=new o({layerDefinition:f,featureSet:null},{id:"CRAB Lines"});t.crabLinesLayer=v,v.setInfoTemplate(_);var b=new s(new a(a.STYLE_SOLID,new r("red"),3));v.setRenderer(b)}.apply(t,n),void 0===o||(e.exports=o)},128:(e,t,r)=>{var n,o;n=[r,t,r(7582),r(7301),r(2626),r(7205),r(5389),r(7857)],o=function(e,t,r,n,o,s,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(n,t),r.__exportStar(o,t),r.__exportStar(s,t),r.__exportStar(a,t),r.__exportStar(i,t)}.apply(t,n),void 0===o||(e.exports=o)},7205:(e,t,r)=>{var n,o;n=[r,t,r(7582),r(7457),r(7962),r(36),r(1089)],o=function(e,t,r,n,o,s,a){"use strict";function i(e){if(!e)return null;for(var t=/[A-Z]?[a-z]+/g,r=t.exec(e),n=new Array;r;){var o=r[0].toLowerCase();n.push(o),r=t.exec(e)}return n.join(" ")}function c(e,t,r){var n=document.createElement("label");return n.htmlFor=t.id,n.textContent=r||i(t.name),t.required&&n.classList.add("required"),e.appendChild(n),e.appendChild(t),n}Object.defineProperty(t,"__esModule",{value:!0}),t.m2gOutputToFeatures=t.IterateG2MOutputToFeatures=t.addToFormWithLabel=t.addNamedControlsToElement=t.splitName=t.generateId=t.getLrsServerEndpointUrl=t.defaultLayerId=t.defaultLrsSvcUrl=t.defaultLrsMapServiceUrl=void 0,t.defaultLrsMapServiceUrl="https://data.wsdot.wa.gov/arcgis/rest/services/CountyRoutes/CRAB_Routes/MapServer",t.defaultLrsSvcUrl="".concat(t.defaultLrsMapServiceUrl,"/exts/LRServer"),t.defaultLayerId=0,t.getLrsServerEndpointUrl=function(e,t,r,n){if(void 0===n&&(n=!0),!e.match(/^(?:https?:)?\/\/.+\/(Map|Feature)Server\b/i))throw Error('URL is not in expected format: "'.concat(e,'".'));var o=n?"LRServer":"LRSServer";return"".concat(e,"/exts/").concat(o,"/").concat(t,"/").concat(r)},t.generateId=function(e){for(var t=e,r=0;document.getElementById(t);)t="".concat(e).concat(r),r++;return t},t.splitName=i,t.addNamedControlsToElement=function(e,t){var r={};for(var n in t)if(t.hasOwnProperty(n)){var o=c(e,t[n],n);r[n]=o}return r},t.addToFormWithLabel=c,t.IterateG2MOutputToFeatures=function(e){var t,n,i,c,u,l,d,p,h,f,m,y,g,_,S,v,b,E,w,R,T,k;return r.__generator(this,(function(O){switch(O.label){case 0:t=e.locations,n=e.spatialReference,i=new a(n),O.label=1;case 1:O.trys.push([1,12,13,14]),c=r.__values(t),u=c.next(),O.label=2;case 2:if(u.done)return[3,11];l=u.value,d=l.results,p=l.status,O.label=3;case 3:O.trys.push([3,8,9,10]),T=void 0,h=r.__values(d),f=h.next(),O.label=4;case 4:return f.done?[3,7]:(m=f.value,y=m.routeId,g=m.measure,_=m.geometry,S={status:p,routeId:y,measure:g},v=new o(_.x,_.y,i),[4,new s({geometry:v,attributes:S})]);case 5:O.sent(),O.label=6;case 6:return f=h.next(),[3,4];case 7:return[3,10];case 8:return b=O.sent(),T={error:b},[3,10];case 9:try{f&&!f.done&&(k=h.return)&&k.call(h)}finally{if(T)throw T.error}return[7];case 10:return u=c.next(),[3,2];case 11:return[3,14];case 12:return E=O.sent(),w={error:E},[3,14];case 13:try{u&&!u.done&&(R=c.return)&&R.call(c)}finally{if(w)throw w.error}return[7];case 14:return[2]}}))},t.m2gOutputToFeatures=function(e){var t,i,c,u,l,d,p,h,f,m,y,g,_,S,v,b,E,w,R,T;return r.__generator(this,(function(k){switch(k.label){case 0:t=e.locations,i=e.spatialReference,c=new a(i),k.label=1;case 1:k.trys.push([1,10,11,12]),u=r.__values(t),l=u.next(),k.label=2;case 2:return l.done?[3,9]:(d=l.value,p=d.routeId,h=d.status,d.geometry?[3,4]:[4,new s({attributes:{routeId:p,status:h}})]);case 3:return k.sent(),[3,8];case 4:return"esriGeometryPoint"!==d.geometryType?[3,6]:(f=d.geometry,m=f.x,y=f.y,g=f.m,S=new o(m,y,c),[4,new s({geometry:S,attributes:{routeId:p,status:h,measure:g}})]);case 5:return k.sent(),[3,8];case 6:return"esriGeometryPolyline"!==d.geometryType?[3,8]:((_=d.geometry).paths,_.hasM,(S=n.fromJson(d.geometry)).setSpatialReference(c),v=r.__read(function(e){if(!e.hasM)return[null,null];var t=e.paths[0][0][3]||null,r=e.paths[e.paths.length-1];return[t,r[r.length-1][3]||null]}(d.geometry),2),b=v[0],E=v[1],[4,new s({geometry:S,attributes:{routeId:p,status:h,fromMeasure:b,toMeasure:E}})]);case 7:k.sent(),k.label=8;case 8:return l=u.next(),[3,2];case 9:return[3,12];case 10:return w=k.sent(),R={error:w},[3,12];case 11:try{l&&!l.done&&(T=u.return)&&T.call(u)}finally{if(R)throw R.error}return[7];case 12:return[2]}}))}}.apply(t,n),void 0===o||(e.exports=o)},6048:e=>{"use strict";e.exports=i},189:e=>{"use strict";e.exports=r},3795:e=>{"use strict";e.exports=u},1089:e=>{"use strict";e.exports=a},486:e=>{"use strict";e.exports=l},7962:e=>{"use strict";e.exports=o},7130:e=>{"use strict";e.exports=c},7457:e=>{"use strict";e.exports=n},36:e=>{"use strict";e.exports=s},4296:e=>{"use strict";e.exports=d},1231:t=>{"use strict";t.exports=e},9035:e=>{"use strict";e.exports=p},1861:e=>{"use strict";e.exports=h},693:e=>{"use strict";e.exports=f},8362:e=>{"use strict";e.exports=t},4829:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApiKey=t.ApiKeyManager=void 0;class r{constructor(e){this.portal="https://www.arcgis.com/sharing/rest",this.key=e.key}static fromKey(e){return new r({key:e})}getToken(e){return Promise.resolve(this.key)}}t.ApiKeyManager=r,t.ApiKey=function(e){return console.log("DEPRECATED:, 'ApiKey' is deprecated. Use 'ApiKeyManager' instead."),new r(e)}},1973:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationSession=t.ApplicationCredentialsManager=void 0;const n=r(6656),o=r(7852);class s{constructor(e){this.clientId=e.clientId,this.clientSecret=e.clientSecret,this.token=e.token,this.expires=e.expires,this.portal=e.portal||"https://www.arcgis.com/sharing/rest",this.duration=e.duration||7200}static fromCredentials(e){return new s(e)}getToken(e,t){return this.token&&this.expires&&this.expires.getTime()>Date.now()?Promise.resolve(this.token):(this._pendingTokenRequest||(this._pendingTokenRequest=this.refreshToken(t)),this._pendingTokenRequest)}refreshToken(e){const t=Object.assign({params:{client_id:this.clientId,client_secret:this.clientSecret,grant_type:"client_credentials",expiration:this.duration}},e);return(0,n.fetchToken)(`${this.portal}/oauth2/token/`,t).then((e=>(this._pendingTokenRequest=null,this.token=e.token,this.expires=e.expires,e.token))).catch((e=>{throw new o.ArcGISTokenRequestError(e.message,o.ArcGISTokenRequestErrorCodes.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)}))}refreshCredentials(){return this.refreshToken().then((()=>this))}}t.ApplicationCredentialsManager=s,t.ApplicationSession=function(e){return console.log("DEPRECATED:, 'ApplicationSession' is deprecated. Use 'ApplicationCredentialsManager' instead."),new s(e)}},8097:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserSession=t.ArcGISIdentityManager=void 0;const n=r(309),o=r(635),s=r(440),a=r(6656),i=r(3872),c=r(31),u=r(560),l=r(9799),d=r(5695),p=r(7918),h=r(2278),f=r(7852),m=r(9789);class y{constructor(e){if(this.clientId=e.clientId,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this._username=e.username,this.password=e.password,this._token=e.token,this._tokenExpires=e.tokenExpires,this.portal=e.portal?(0,u.cleanUrl)(e.portal):"https://www.arcgis.com/sharing/rest",this.ssl=e.ssl,this.provider=e.provider||"arcgis",this.tokenDuration=e.tokenDuration||20160,this.redirectUri=e.redirectUri,this.server=e.server,this.referer=e.referer,this.federatedServers={},this.trustedDomains=[],e.server){const t=this.getServerRootUrl(e.server);this.federatedServers[t]={token:e.token,expires:e.tokenExpires}}this._pendingTokenRequests={}}get token(){return this._token}get tokenExpires(){return this._tokenExpires}get refreshToken(){return this._refreshToken}get refreshTokenExpires(){return this._refreshTokenExpires}get username(){return this._username?this._username:this._user&&this._user.username?this._user.username:void 0}get canRefresh(){return!(!this.username||!this.password)||!!(this.clientId&&this.refreshToken&&this.redirectUri)}static beginOAuth2(e,t){!t&&window&&(t=window);const{portal:r,provider:o,clientId:a,expiration:i,redirectUri:c,popup:l,popupWindowFeatures:f,locale:m,params:g,style:_,pkce:S,state:v}=Object.assign({portal:"https://www.arcgis.com/sharing/rest",provider:"arcgis",expiration:20160,popup:!0,popupWindowFeatures:"height=400,width=600,menubar=no,location=yes,resizable=yes,scrollbars=yes,status=yes",locale:"",style:"",pkce:!0},e),b=v||(0,p.generateRandomString)(t),E=`ARCGIS_REST_JS_AUTH_STATE_${a}`;t.localStorage.setItem(E,b);let w=`${(0,u.cleanUrl)(r)}/oauth2/authorize`;const R={client_id:a,response_type:S?"code":"token",expiration:i,redirect_uri:c,state:JSON.stringify({id:b,originalUrl:t.location.href}),locale:m,style:_};let T;if("arcgis"!==o&&(w=`${(0,u.cleanUrl)(r)}/oauth2/social/authorize`,R.socialLoginProviderName=o,R.autoAccountCreateForSocial=!0),S){const e=(0,p.generateRandomString)(t),r=`ARCGIS_REST_JS_CODE_VERIFIER_${a}`;t.localStorage.setItem(r,e),T=(0,d.generateCodeChallenge)(e,t).then((function(t){R.code_challenge_method=t?"S256":"plain",R.code_challenge=t||e}))}else T=Promise.resolve();return T.then((()=>(w=`${w}?${(0,s.encodeQueryString)(R)}`,g&&(w=`${w}&${(0,s.encodeQueryString)(g)}`),l?new Promise(((e,o)=>{t.addEventListener(`arcgis-rest-js-popup-auth-${a}`,(t=>{if("access_denied"===t.detail.error){const e=new h.ArcGISAccessDeniedError;return o(e),e}if(t.detail.errorMessage){const e=new n.ArcGISAuthError(t.detail.errorMessage,t.detail.error);return o(e),e}e(new y({clientId:a,portal:r,ssl:t.detail.ssl,token:t.detail.token,tokenExpires:t.detail.expires,username:t.detail.username,refreshToken:t.detail.refreshToken,refreshTokenExpires:t.detail.refreshTokenExpires,redirectUri:c}))}),{once:!0}),t.open(w,"oauth-window",f),t.dispatchEvent(new CustomEvent("arcgis-rest-js-popup-auth-start"))})):void(t.location.href=w))))}static completeOAuth2(e,t){!t&&window&&(t=window);const{portal:r,clientId:s,popup:i,pkce:c,redirectUri:l}=Object.assign({portal:"https://www.arcgis.com/sharing/rest",popup:!0,pkce:!0},e),d=`ARCGIS_REST_JS_AUTH_STATE_${s}`,p=t.localStorage.getItem(d),f=(0,o.decodeQueryString)(c?t.location.search.replace(/^\?/,""):t.location.hash.replace(/^#/,"")),m=f&&f.state?JSON.parse(f.state):void 0;function g(e,r,o){return t.localStorage.removeItem(d),i&&t.opener?(t.opener.dispatchEvent(new CustomEvent(`arcgis-rest-js-popup-auth-${s}`,{detail:{error:r,errorMessage:e}})),void t.close()):(o&&t.history.replaceState(t.history.state,"",o),"access_denied"===r?Promise.reject(new h.ArcGISAccessDeniedError):Promise.reject(new n.ArcGISAuthError(e,r)))}function _(e,n){return t.localStorage.removeItem(d),i&&t.opener?(t.opener.dispatchEvent(new CustomEvent(`arcgis-rest-js-popup-auth-${s}`,{detail:Object.assign({},e)})),void t.close()):(t.history.replaceState(t.history.state,"",n),new y({clientId:s,portal:r,ssl:e.ssl,token:e.token,tokenExpires:e.expires,username:e.username,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,redirectUri:l||location.href.replace(location.search,"")}))}if(!p||!m)return g("No authentication state was found, call `ArcGISIdentityManager.beginOAuth2(...)` to start the authentication process.","no-auth-state");if(m.id!==p)return g("Saved client state did not match server sent state.","mismatched-auth-state");if(f.error){const e=f.error;return g(f.error_description||"Unknown error",e,m.originalUrl)}if(c&&f.code){const e=(0,u.cleanUrl)(`${r}/oauth2/token/`),n=`ARCGIS_REST_JS_CODE_VERIFIER_${s}`,o=t.localStorage.getItem(n);return t.localStorage.removeItem(n),(0,a.fetchToken)(e,{httpMethod:"POST",params:{client_id:s,code_verifier:o,grant_type:"authorization_code",redirect_uri:l||location.href.replace(location.search,""),code:f.code}}).then((e=>_(Object.assign(Object.assign({},e),m),m.originalUrl))).catch((e=>g(e.originalMessage,e.code,m.originalUrl)))}return!c&&f.access_token?Promise.resolve(_(Object.assign({token:f.access_token,expires:new Date(Date.now()+1e3*parseInt(f.expires_in,10)),ssl:"true"===f.ssl,username:f.username},m),m.originalUrl)):g("Unknown error","oauth-error",m.originalUrl)}static fromParent(e,t){let r;return!t&&window&&(t=window),new Promise(((n,o)=>{r=e=>{if(e.source===t.parent&&e.data)try{return n(y.parentMessageHandler(e))}catch(e){return o(e)}},t.addEventListener("message",r,!1),t.parent.postMessage({type:"arcgis:auth:requestCredential"},e)})).then((e=>(t.removeEventListener("message",r,!1),e)))}static authorize(e,t){const{portal:r,clientId:n,expiration:o,redirectUri:a,state:i}=Object.assign({portal:"https://arcgis.com/sharing/rest",expiration:20160},e),c={client_id:n,expiration:o,response_type:"code",redirect_uri:a};i&&(c.state=i);const u=`${r}/oauth2/authorize?${(0,s.encodeQueryString)(c)}`;t.writeHead(301,{Location:u}),t.end()}static exchangeAuthorizationCode(e,t){const{portal:r,clientId:n,redirectUri:o}=Object.assign({portal:"https://www.arcgis.com/sharing/rest"},e);return(0,a.fetchToken)(`${r}/oauth2/token`,{params:{grant_type:"authorization_code",client_id:n,redirect_uri:o,code:t}}).then((e=>new y({clientId:n,portal:r,ssl:e.ssl,redirectUri:o,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,token:e.token,tokenExpires:e.expires,username:e.username}))).catch((e=>{throw new f.ArcGISTokenRequestError(e.message,f.ArcGISTokenRequestErrorCodes.REFRESH_TOKEN_EXCHANGE_FAILED,e.response,e.url,e.options)}))}static deserialize(e){const t=JSON.parse(e);return new y({clientId:t.clientId,refreshToken:t.refreshToken,refreshTokenExpires:t.refreshTokenExpires?new Date(t.refreshTokenExpires):void 0,username:t.username,password:t.password,token:t.token,tokenExpires:t.tokenExpires?new Date(t.tokenExpires):void 0,portal:t.portal,ssl:t.ssl,tokenDuration:t.tokenDuration,redirectUri:t.redirectUri,server:t.server})}static fromCredential(e,t){const r=void 0===e.ssl||e.ssl,n=e.expires||Date.now()+72e5;return t.hasServer?new y({server:e.server,ssl:r,token:e.token,username:e.userId,tokenExpires:new Date(n)}):new y({portal:(0,u.cleanUrl)(e.server.includes("sharing/rest")?e.server:e.server+"/sharing/rest"),ssl:r,token:e.token,username:e.userId,tokenExpires:new Date(n)})}static parentMessageHandler(e){if("arcgis:auth:credential"===e.data.type)return new y(e.data.credential);if("arcgis:auth:error"===e.data.type){const t=new Error(e.data.error.message);throw t.name=e.data.error.name,t}throw new Error("Unknown message type.")}static destroy(e){return(0,l.revokeToken)({clientId:e.clientId,portal:e.portal,token:e.refreshToken||e.token})}static fromToken(e){const t=new y(e);return t.getUser().then((()=>t))}static signIn(e){const t=new y(e);return t.getUser().then((()=>t))}toCredential(){return{expires:this.tokenExpires.getTime(),server:this.server||this.portal,ssl:this.ssl,token:this.token,userId:this.username}}getUser(e){if(this._pendingUserRequest)return this._pendingUserRequest;if(this._user)return Promise.resolve(this._user);{const t=`${this.portal}/community/self`,r=Object.assign(Object.assign({httpMethod:"GET",authentication:this},e),{rawResponse:!1});return this._pendingUserRequest=(0,n.request)(t,r).then((e=>(this._user=e,this._pendingUserRequest=null,e))),this._pendingUserRequest}}getPortal(e){if(this._pendingPortalRequest)return this._pendingPortalRequest;if(this._portalInfo)return Promise.resolve(this._portalInfo);{const t=`${this.portal}/portals/self`,r=Object.assign(Object.assign({httpMethod:"GET",authentication:this},e),{rawResponse:!1});return this._pendingPortalRequest=(0,n.request)(t,r).then((e=>(this._portalInfo=e,this._pendingPortalRequest=null,e))),this._pendingPortalRequest}}getUsername(){return this.username?Promise.resolve(this.username):this.getUser().then((e=>e.username))}getToken(e,t){return(0,i.canUseOnlineToken)(this.portal,e)||new RegExp(this.portal,"i").test(e)?this.getFreshToken(t):this.getTokenForServer(e,t)}validateAppAccess(e){return this.getToken(this.portal).then((t=>(0,c.validateAppAccess)(t,e)))}toJSON(){return{clientId:this.clientId,refreshToken:this.refreshToken,refreshTokenExpires:this.refreshTokenExpires||void 0,username:this.username,password:this.password,token:this.token,tokenExpires:this.tokenExpires||void 0,portal:this.portal,ssl:this.ssl,tokenDuration:this.tokenDuration,redirectUri:this.redirectUri,server:this.server}}serialize(){return JSON.stringify(this)}enablePostMessageAuth(e,t){!t&&window&&(t=window),this._hostHandler=this.createPostMessageHandler(e),t.addEventListener("message",this._hostHandler,!1)}disablePostMessageAuth(e){!e&&window&&(e=window),e.removeEventListener("message",this._hostHandler,!1)}refreshCredentials(e){return this._user=null,this.username&&this.password?this.refreshWithUsernameAndPassword(e):this.clientId&&this.refreshToken?this.refreshWithRefreshToken():Promise.reject(new f.ArcGISTokenRequestError("Unable to refresh token. No refresh token or password present.",f.ArcGISTokenRequestErrorCodes.TOKEN_REFRESH_FAILED))}getServerRootUrl(e){const[t]=(0,u.cleanUrl)(e).split(/\/rest(\/admin)?\/services(?:\/|#|\?|$)/),[r,n,o]=t.match(/(https?:\/\/)(.+)/),[s,...a]=o.split("/");return`${n}${s.toLowerCase()}/${a.join("/")}`}getDomainCredentials(e){return this.trustedDomains&&this.trustedDomains.length&&this.trustedDomains.some((t=>e.startsWith(t)))?"include":"same-origin"}signOut(){return y.destroy(this)}createPostMessageHandler(e){return t=>{const r=e.indexOf(t.origin)>-1,n="arcgis:auth:requestCredential"===t.data.type,o=this.tokenExpires.getTime()>Date.now();if(r&&n){let e={};e=o?{type:"arcgis:auth:credential",credential:this.toJSON()}:{type:"arcgis:auth:error",error:{name:"tokenExpiredError",message:"Token was expired, and not returned to the child application"}},t.source.postMessage(e,t.origin)}}}getTokenForServer(e,t){const r=this.getServerRootUrl(e),o=this.federatedServers[r];return o&&o.expires&&o.expires.getTime()>Date.now()?Promise.resolve(o.token):(this._pendingTokenRequests[r]||(this._pendingTokenRequests[r]=this.fetchAuthorizedDomains().then((()=>(0,n.request)(`${r}/rest/info`,{credentials:this.getDomainCredentials(e)}).then((o=>{if(o.owningSystemUrl){if((0,i.isFederated)(o.owningSystemUrl,this.portal))return(0,n.request)(`${o.owningSystemUrl}/sharing/rest/info`,t);throw new f.ArcGISTokenRequestError(`${e} is not federated with ${this.portal}.`,f.ArcGISTokenRequestErrorCodes.NOT_FEDERATED)}if(o.authInfo&&void 0!==this.federatedServers[r])return Promise.resolve({authInfo:o.authInfo});throw new f.ArcGISTokenRequestError(`${e} is not federated with any portal and is not explicitly trusted.`,f.ArcGISTokenRequestErrorCodes.NOT_FEDERATED)})).then((e=>this.token&&this.tokenExpires.getTime()<Date.now()?this.server?this.refreshCredentials().then((()=>({token:this.token,expires:this.tokenExpires}))):this.refreshCredentials().then((()=>this.generateTokenForServer(e.authInfo.tokenServicesUrl,r))):this.generateTokenForServer(e.authInfo.tokenServicesUrl,r))).then((e=>(this.federatedServers[r]=e,delete this._pendingTokenRequests[r],e.token)))))),this._pendingTokenRequests[r])}generateTokenForServer(e,t){return(0,n.request)(e,{params:{token:this.token,serverUrl:t,expiration:this.tokenDuration}}).then((e=>({token:e.token,expires:new Date(e.expires-3e5)}))).catch((e=>{throw new f.ArcGISTokenRequestError(e.message,f.ArcGISTokenRequestErrorCodes.GENERATE_TOKEN_FOR_SERVER_FAILED,e.response,e.url,e.options)}))}getFreshToken(e){return this.token&&!this.tokenExpires||this.token&&this.tokenExpires&&this.tokenExpires.getTime()>Date.now()?Promise.resolve(this.token):(this._pendingTokenRequests[this.portal]||(this._pendingTokenRequests[this.portal]=this.refreshCredentials(e).then((()=>(this._pendingTokenRequests[this.portal]=null,this.token)))),this._pendingTokenRequests[this.portal])}refreshWithUsernameAndPassword(e){const t={username:this.username,password:this.password,expiration:this.tokenDuration,client:"referer",referer:this.referer?this.referer:"undefined"!=typeof window&&void 0!==window.document&&window.location&&window.location.origin?window.location.origin:m.NODEJS_DEFAULT_REFERER_HEADER};return(this.server?(0,n.request)(`${this.getServerRootUrl(this.server)}/rest/info`).then((r=>(0,n.request)(r.authInfo.tokenServicesUrl,Object.assign({params:t},e)))):(0,n.request)(`${this.portal}/generateToken`,Object.assign({params:t},e))).then((e=>(this.updateToken(e.token,new Date(e.expires)),this))).catch((e=>{throw new f.ArcGISTokenRequestError(e.message,f.ArcGISTokenRequestErrorCodes.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)}))}refreshWithRefreshToken(e){if(this.refreshToken&&this.refreshTokenExpires&&this.refreshTokenExpires.getTime()-864e5<Date.now())return this.exchangeRefreshToken(e);const t=Object.assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,grant_type:"refresh_token"}},e);return(0,a.fetchToken)(`${this.portal}/oauth2/token`,t).then((e=>this.updateToken(e.token,e.expires))).catch((e=>{throw new f.ArcGISTokenRequestError(e.message,f.ArcGISTokenRequestErrorCodes.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)}))}updateToken(e,t){return this._token=e,this._tokenExpires=t,this}exchangeRefreshToken(e){const t=Object.assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,grant_type:"exchange_refresh_token"}},e);return(0,a.fetchToken)(`${this.portal}/oauth2/token`,t).then((e=>(this._token=e.token,this._tokenExpires=e.expires,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this))).catch((e=>{throw new f.ArcGISTokenRequestError(e.message,f.ArcGISTokenRequestErrorCodes.REFRESH_TOKEN_EXCHANGE_FAILED,e.response,e.url,e.options)}))}fetchAuthorizedDomains(){return this.server||!this.portal?Promise.resolve(this):this.getPortal().then((e=>(e.authorizedCrossOriginDomains&&e.authorizedCrossOriginDomains.length&&(this.trustedDomains=e.authorizedCrossOriginDomains.filter((e=>!e.startsWith("http://"))).map((e=>e.startsWith("https://")?e:`https://${e}`))),this)))}}function g(e){return console.log("DEPRECATED:, 'UserSession' is deprecated. Use 'ArcGISIdentityManager' instead."),new y(e)}t.ArcGISIdentityManager=y,t.UserSession=g,g.beginOAuth2=function(...e){return console.warn("DEPRECATED:, 'UserSession.beginOAuth2' is deprecated. Use 'ArcGISIdentityManager.beginOAuth2' instead."),y.beginOAuth2(...e)},g.completeOAuth2=function(...e){return console.warn("DEPRECATED:, 'UserSession.completeOAuth2()' is deprecated. Use 'ArcGISIdentityManager.completeOAuth2()' instead."),e.length<=1&&console.warn("WARNING:, 'UserSession.completeOAuth2()' is now async and returns a promise the resolves to an instance of `ArcGISIdentityManager`."),y.completeOAuth2(...e)},g.fromParent=function(...e){return console.warn("DEPRECATED:, 'UserSession.fromParent' is deprecated. Use 'ArcGISIdentityManager.fromParent' instead."),y.fromParent(...e)},g.authorize=function(...e){return console.warn("DEPRECATED:, 'UserSession.authorize' is deprecated. Use 'ArcGISIdentityManager.authorize' instead."),y.authorize(...e)},g.exchangeAuthorizationCode=function(...e){return console.warn("DEPRECATED:, 'UserSession.exchangeAuthorizationCode' is deprecated. Use 'ArcGISIdentityManager.exchangeAuthorizationCode' instead."),y.exchangeAuthorizationCode(...e)},g.fromCredential=function(...e){return console.log("DEPRECATED:, 'UserSession.fromCredential' is deprecated. Use 'ArcGISIdentityManager.fromCredential' instead."),console.warn("WARNING:, 'UserSession.fromCredential' now requires a `ServerInfo` object from the JS API as a second parameter."),y.fromCredential(...e)},g.deserialize=function(...e){return console.log("DEPRECATED:, 'UserSession.deserialize' is deprecated. Use 'ArcGISIdentityManager.deserialize' instead."),y.deserialize(...e)}},4030:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.platformSelf=t.exchangeToken=void 0;const n=r(309);t.exchangeToken=function(e,t,r="https://www.arcgis.com/sharing/rest"){const o=`${r}/oauth2/exchangeToken`,s={method:"POST",params:{f:"json",client_id:t,token:e}};return(0,n.request)(o,s).then((e=>e.token))},t.platformSelf=function(e,t,r="https://www.arcgis.com/sharing/rest"){const o=`${r}/oauth2/platformSelf?f=json`,s={method:"POST",headers:{"X-Esri-Auth-Client-Id":e,"X-Esri-Auth-Redirect-Uri":t},params:{f:"json"}};return(0,n.request)(o,s)}},6222:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3872:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canUseOnlineToken=t.isFederated=t.getOnlineEnvironment=t.normalizeOnlinePortalUrl=t.isOnline=void 0;const n=r(560),o=/^https?:\/\/(\S+)\.arcgis\.com.+/;function s(e){return o.test(e)}function a(e){if(!o.test(e))return e;switch(i(e)){case"dev":return"https://devext.arcgis.com/sharing/rest";case"qa":return"https://qaext.arcgis.com/sharing/rest";default:return"https://www.arcgis.com/sharing/rest"}}function i(e){if(!o.test(e))return null;const t=e.match(o)[1].split(".").pop();return t.includes("dev")?"dev":t.includes("qa")?"qa":"production"}t.isOnline=s,t.normalizeOnlinePortalUrl=a,t.getOnlineEnvironment=i,t.isFederated=function(e,t){const r=(0,n.cleanUrl)(a(t)).replace(/https?:\/\//,""),o=(0,n.cleanUrl)(e).replace(/https?:\/\//,"");return new RegExp(o,"i").test(r)},t.canUseOnlineToken=function(e,t){const r=s(e),n=s(t),o=i(e),a=i(t);return!(!r||!n||o!==a)}},6656:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchToken=void 0;const n=r(309),o=3e5;t.fetchToken=function(e,t){const r=t;return r.rawResponse=!1,(0,n.request)(e,r).then((e=>{if("token"in e&&"expires"in e)return{token:e.token,username:t.params.username,expires:new Date(e.expires)};const r={token:e.access_token,username:e.username,expires:new Date(Date.now()+1e3*e.expires_in-o),ssl:!0===e.ssl};return e.refresh_token&&(r.refreshToken=e.refresh_token),e.refresh_token_expires_in&&(r.refreshTokenExpires=new Date(Date.now()+1e3*e.refresh_token_expires_in-o)),r}))}},9789:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7582);(0,n.__exportStar)(r(309),t),(0,n.__exportStar)(r(1055),t),(0,n.__exportStar)(r(3849),t),(0,n.__exportStar)(r(7852),t),(0,n.__exportStar)(r(2278),t),(0,n.__exportStar)(r(5850),t),(0,n.__exportStar)(r(560),t),(0,n.__exportStar)(r(2255),t),(0,n.__exportStar)(r(440),t),(0,n.__exportStar)(r(635),t),(0,n.__exportStar)(r(8398),t),(0,n.__exportStar)(r(7540),t),(0,n.__exportStar)(r(3969),t),(0,n.__exportStar)(r(8721),t),(0,n.__exportStar)(r(6480),t),(0,n.__exportStar)(r(3799),t),(0,n.__exportStar)(r(5745),t),(0,n.__exportStar)(r(4589),t),(0,n.__exportStar)(r(2577),t),(0,n.__exportStar)(r(7425),t),(0,n.__exportStar)(r(9510),t),(0,n.__exportStar)(r(7216),t),(0,n.__exportStar)(r(5932),t),(0,n.__exportStar)(r(9902),t),(0,n.__exportStar)(r(2598),t),(0,n.__exportStar)(r(1973),t),(0,n.__exportStar)(r(4829),t),(0,n.__exportStar)(r(8097),t),(0,n.__exportStar)(r(6656),t),(0,n.__exportStar)(r(6222),t),(0,n.__exportStar)(r(4030),t),(0,n.__exportStar)(r(31),t),(0,n.__exportStar)(r(3872),t),(0,n.__exportStar)(r(9799),t),(0,n.__exportStar)(r(5109),t),(0,n.__exportStar)(r(6571),t),(0,n.__exportStar)(r(3660),t),(0,n.__exportStar)(r(4559),t),(0,n.__exportStar)(r(7737),t),(0,n.__exportStar)(r(3358),t),(0,n.__exportStar)(r(1689),t),(0,n.__exportStar)(r(2472),t),(0,n.__exportStar)(r(7633),t),(0,n.__exportStar)(r(2338),t),(0,n.__exportStar)(r(9091),t)},5109:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Job=void 0;const n=r(309),o=r(560),s=r(5850),a=r(7633),i=r(855),c=r(4953),u={pollingRate:2e3,startMonitoring:!1};class l{constructor(e){this.executePoll=async()=>{let e;try{e=await this.getJobInfo()}catch(e){return void this.emitter.emit(a.JOB_STATUSES.Error,e)}this.emitter.emit(a.JOB_STATUSES.Status,e),this.emitter.emit(e.status,e)};const{url:t,id:r,pollingRate:n,authentication:o}=Object.assign(Object.assign({},u),e);this.url=t,this.id=r,this.authentication=o,this._pollingRate=n,this.emitter=(0,i.default)(),e.startMonitoring&&this.startEventMonitoring(n)}static deserialize(e,t){const r=Object.assign(Object.assign(Object.assign({},u),JSON.parse(e)),t);return(0,n.request)(`${r.url}/jobs/${r.id}`,{authentication:r.authentication}).then((()=>new l(r)))}static fromExistingJob(e){const t=Object.assign(Object.assign({},u),e),r=(0,o.cleanUrl)(t.url.replace(/\/submitJob\/?/,""));return(0,n.request)(`${r}/jobs/${t.id}`,{authentication:t.authentication}).then((()=>new l(t)))}static submitJob(e){const{url:t,params:r,authentication:s,pollingRate:a,startMonitoring:i}=Object.assign(Object.assign({},u),e),d=(0,c.processJobParams)(r),p=(0,o.cleanUrl)(t.replace(/\/submitJob\/?/,"")),h=p+"/submitJob";return(0,n.request)(h,{params:d,authentication:s}).then((e=>new l({url:p,authentication:s,id:e.jobId,startMonitoring:i,pollingRate:a})))}get jobUrl(){return`${this.url}/jobs/${this.id}`}get isMonitoring(){return!!this.setIntervalHandler}get pollingRate(){return this._pollingRate}set pollingRate(e){this.stopEventMonitoring(),this.startEventMonitoring(e)}getJobInfo(){return(0,n.request)(this.jobUrl,{authentication:this.authentication}).then((e=>{const t=Object.assign({id:e.jobId,status:void 0},e);switch(delete t.jobId,delete t.jobStatus,e.jobStatus){case"esriJobCancelled":t.status=a.JOB_STATUSES.Cancelled;break;case"esriJobCancelling":t.status=a.JOB_STATUSES.Cancelling;break;case"esriJobNew":t.status=a.JOB_STATUSES.New;break;case"esriJobWaiting":t.status=a.JOB_STATUSES.Waiting;break;case"esriJobExecuting":t.status=a.JOB_STATUSES.Executing;break;case"esriJobSubmitted":t.status=a.JOB_STATUSES.Submitted;break;case"esriJobTimedOut":t.status=a.JOB_STATUSES.TimedOut;break;case"esriJobFailed":t.status=a.JOB_STATUSES.Failed;break;case"expectedFailure":t.status=a.JOB_STATUSES.Failure;break;case"esriJobSucceeded":t.status=a.JOB_STATUSES.Success}return t}))}on(e,t){this.emitter.on(e,t)}once(e,t){const r=n=>{this.emitter.off(e,r),t(n)};this.emitter.on(e,r),t.__arcgis_job_once_original_function__=r}off(e,t){t.__arcgis_job_once_original_function__?this.emitter.off(e,t.__arcgis_job_once_original_function__):this.emitter.off(e,t)}async getResult(e){return this.waitForCompletion().then((t=>(0,n.request)(this.jobUrl+"/"+t.results[e].paramUrl,{authentication:this.authentication})))}toJSON(){return{id:this.id,url:this.url,startMonitoring:this.isMonitoring,pollingRate:this.pollingRate}}serialize(){return JSON.stringify(this)}async waitForCompletion(){const e=await this.getJobInfo();return e.status===a.JOB_STATUSES.Success?Promise.resolve(e):e.status===a.JOB_STATUSES.Cancelling||e.status===a.JOB_STATUSES.Cancelled||e.status===a.JOB_STATUSES.Failed||e.status===a.JOB_STATUSES.Failure||e.status===a.JOB_STATUSES.TimedOut?(this.stopInternalEventMonitoring(),Promise.reject(new s.ArcGISJobError("Job cancelled or failed.",e))):new Promise(((e,t)=>{this.startInternalEventMonitoring(),this.once(a.JOB_STATUSES.Cancelled,(e=>{this.stopInternalEventMonitoring(),t(new s.ArcGISJobError("Job cancelled.",e))})),this.once(a.JOB_STATUSES.TimedOut,(e=>{this.stopInternalEventMonitoring(),t(new s.ArcGISJobError("Job timed out.",e))})),this.once(a.JOB_STATUSES.Failed,(e=>{this.stopInternalEventMonitoring(),t(new s.ArcGISJobError("Job failed.",e))})),this.once(a.JOB_STATUSES.Success,(t=>{this.stopInternalEventMonitoring(),e(t)}))}))}async getAllResults(){return this.waitForCompletion().then((e=>{const t=Object.keys(e.results),r=t.map((t=>(0,n.request)(this.jobUrl+"/"+e.results[t].paramUrl,{authentication:this.authentication}).then((e=>e))));return Promise.all(r).then((e=>t.reduce(((r,n,o)=>(r[t[o]]=e[o],r)),{})))}))}cancelJob(){return(0,n.request)(this.jobUrl+"/cancel",{authentication:this.authentication,params:{id:this.id,returnMessages:!1}}).then((e=>(this.emitter.emit("cancelled",e),e)))}startInternalEventMonitoring(e=u.pollingRate){this._pollingRate=e,this.isMonitoring||(this.setIntervalHandler=setInterval(this.executePoll,this.pollingRate))}stopInternalEventMonitoring(){this.isMonitoring&&!this.didUserEnableMonitoring&&clearTimeout(this.setIntervalHandler)}startEventMonitoring(e=u.pollingRate){this._pollingRate=e,this.didUserEnableMonitoring=!0,this.isMonitoring||(this.setIntervalHandler=setInterval(this.executePoll,this.pollingRate))}stopEventMonitoring(){this.isMonitoring&&this.didUserEnableMonitoring&&clearTimeout(this.setIntervalHandler)}}t.Job=l},309:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.request=t.internalRequest=t.checkForErrors=t.ArcGISAuthError=t.getDefaultRequestOptions=t.setDefaultRequestOptions=t.NODEJS_DEFAULT_REFERER_HEADER=void 0;const n=r(2255),o=r(440),s=r(7216),a=r(3849),i=r(2598),c=r(2338);function u(){return globalThis.DEFAULT_ARCGIS_REQUEST_OPTIONS||{httpMethod:"POST",params:{f:"json"}}}t.NODEJS_DEFAULT_REFERER_HEADER="@esri/arcgis-rest-js",t.setDefaultRequestOptions=function(e,t){e.authentication&&!t&&(0,i.warn)("You should not set `authentication` as a default in a shared environment such as a web server which will process multiple users requests. You can call `setDefaultRequestOptions` with `true` as a second argument to disable this warning."),globalThis.DEFAULT_ARCGIS_REQUEST_OPTIONS=e},t.getDefaultRequestOptions=u;class l extends a.ArcGISRequestError{constructor(e="AUTHENTICATION_ERROR",t="AUTHENTICATION_ERROR_CODE",r,n,o){super(e,t,r,n,o),this.name="ArcGISAuthError",this.message="AUTHENTICATION_ERROR_CODE"===t?e:`${t}: ${e}`;const s=new.target.prototype;Object.setPrototypeOf(this,s)}retry(e,t=1){let r=0;const n=(o,s)=>{r+=1,e(this.url,this.options).then((e=>{const t=Object.assign(Object.assign({},this.options),{authentication:e});return p(this.url,t)})).then((e=>{o(e)})).catch((e=>{"ArcGISAuthError"===e.name&&r<t?n(o,s):e.name===this.name&&e.message===this.message&&r>=t?s(this):s(e)}))};return new Promise(((e,t)=>{n(e,t)}))}}function d(e,t,r,n,o){if(e.code>=400){const{message:r,code:o}=e;throw new a.ArcGISRequestError(r,o,e,t,n)}if(e.error){const{message:r,code:s,messageCode:i}=e.error,c=i||s||"UNKNOWN_ERROR_CODE";if(498===s||499===s)throw o||new l(r,c,e,t,n);throw new a.ArcGISRequestError(r,c,e,t,n)}if("failed"===e.status||"failure"===e.status){let r,o="UNKNOWN_ERROR_CODE";try{r=JSON.parse(e.statusMessage).message,o=JSON.parse(e.statusMessage).code}catch(t){r=e.statusMessage||e.message}throw new a.ArcGISRequestError(r,o,e,t,n)}return e}function p(e,r){const l=u(),p=Object.assign(Object.assign(Object.assign({httpMethod:"POST"},l),r),{params:Object.assign(Object.assign({},l.params),r.params),headers:Object.assign(Object.assign({},l.headers),r.headers)}),{httpMethod:h,rawResponse:f}=p,m=Object.assign({f:"json"},p.params);let y=null;const g={method:h,signal:p.signal,credentials:p.credentials||"same-origin"};let _;if(p.headers&&p.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(g.credentials="include"),"string"==typeof p.authentication){const e=p.authentication;_={portal:"https://www.arcgis.com/sharing/rest",getToken:()=>Promise.resolve(e)},p.authentication.startsWith("AAPK")||p.suppressWarnings||globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING||((0,i.warn)("Using an oAuth 2.0 access token directly in the token option is discouraged. Consider using ArcGISIdentityManager or Application session. See https://esriurl.com/arcgis-rest-js-direct-token-warning for more information."),globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING=!0)}else _=p.authentication;const S=e;return(_?_.getToken(e).catch((t=>(t.url=e,t.options=p,y=t,Promise.resolve("")))):Promise.resolve("")).then((r=>{r.length&&(m.token=r),_&&_.getDomainCredentials&&(g.credentials=_.getDomainCredentials(e));const a={};if("GET"===g.method){m.token&&p.hideToken&&"undefined"==typeof window&&(a["X-Esri-Authorization"]=`Bearer ${m.token}`,delete m.token);const t=""===(0,o.encodeQueryString)(m)?e:e+"?"+(0,o.encodeQueryString)(m);p.maxUrlLength&&t.length>p.maxUrlLength||m.token&&p.hideToken?(g.method="POST",r.length&&p.hideToken&&(m.token=r,delete a["X-Esri-Authorization"])):e=t}const i=new RegExp("/items/.+/updateResources").test(e);return"POST"===g.method&&(g.body=(0,n.encodeFormData)(m,i)),g.headers=Object.assign(Object.assign({},a),p.headers),("undefined"==typeof window||window&&void 0===window.document)&&!g.headers.referer&&(g.headers.referer=t.NODEJS_DEFAULT_REFERER_HEADER),(0,s.requiresFormData)(m)||i||(g.headers["Content-Type"]="application/x-www-form-urlencoded"),globalThis.fetch?globalThis.fetch(e,g):(0,c.getFetch)().then((({fetch:t})=>t(e,g)))})).then((t=>{if(!t.ok)return t.json().then((r=>{const{status:n,statusText:o}=t,{message:s,details:i}=r.error,c=`${s}. ${i?i.join(" "):""}`.trim();throw new a.ArcGISRequestError(c,`HTTP ${n} ${o}`,r,e,p)})).catch((r=>{if("ArcGISRequestError"===r.name)throw r;const{status:n,statusText:o}=t;throw new a.ArcGISRequestError(o,`HTTP ${n}`,t,e,p)}));if(f)return t;switch(m.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();default:return t.blob()}})).then((t=>{if("json"!==m.f&&"geojson"!==m.f||f)return t;{const r=d(t,S,0,p,y);if(y){const t=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];p.authentication.federatedServers[t]={token:[],expires:new Date(Date.now()+864e5)},y=null}return r}}))}t.ArcGISAuthError=l,t.checkForErrors=d,t.internalRequest=p,t.request=function(e,t={params:{f:"json"}}){return p(e,t).catch((e=>e instanceof l&&t.authentication&&"string"!=typeof t.authentication&&t.authentication.canRefresh&&t.authentication.refreshCredentials?e.retry((()=>t.authentication.refreshCredentials()),1):Promise.reject(e)))}},9799:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revokeToken=void 0;const n=r(9789);t.revokeToken=function(e){const t=`${(0,n.cleanUrl)(e.portal||"https://www.arcgis.com/sharing/rest")}/oauth2/revokeToken/`,r=e.token,o=e.clientId;delete e.portal,delete e.clientId,delete e.token;const s=Object.assign(Object.assign({},e),{httpMethod:"POST",params:{client_id:o,auth_token:r}});return(0,n.request)(t,s).then((e=>{if(!e.success)throw new n.ArcGISRequestError("Unable to revoke token",500,e,t,s);return e}))}},3660:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4559:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1689:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7633:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.JOB_STATUSES=void 0,(r=t.JOB_STATUSES||(t.JOB_STATUSES={})).Success="Succeeded",r.Failed="Failed",r.Waiting="Waiting",r.Cancelled="Cancelled",r.Cancelling="Cancelling",r.New="New",r.Executing="Executing",r.Submitted="Submitted",r.Failure="Failure",r.TimedOut="TimedOut",r.Error="Error",r.Status="Etatus",r.Unknown="Unknown"},3358:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7737:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2472:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2278:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArcGISAccessDeniedError=void 0;class r extends Error{constructor(){super("The user has denied your authorization request.");const e=new.target.prototype;Object.setPrototypeOf(this,e),this.name="ArcGISAccessDeniedError"}}t.ArcGISAccessDeniedError=r},5850:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArcGISJobError=void 0;class r extends Error{constructor(e="Unknown error",t){super(e);const r=new.target.prototype;Object.setPrototypeOf(this,r),this.name="ArcGISJobError",this.message=`${t.status}: ${e}`,this.status=t.status,this.id=t.id,this.jobInfo=t}}t.ArcGISJobError=r},3849:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArcGISRequestError=void 0;class r extends Error{constructor(e,t,r,n,o){super(e);const s=new.target.prototype;Object.setPrototypeOf(this,s),e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=r,this.url=n,this.options=o}}t.ArcGISRequestError=r},7852:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ArcGISTokenRequestError=t.ArcGISTokenRequestErrorCodes=void 0,function(e){e.TOKEN_REFRESH_FAILED="TOKEN_REFRESH_FAILED",e.GENERATE_TOKEN_FOR_SERVER_FAILED="GENERATE_TOKEN_FOR_SERVER_FAILED",e.REFRESH_TOKEN_EXCHANGE_FAILED="REFRESH_TOKEN_EXCHANGE_FAILED",e.NOT_FEDERATED="NOT_FEDERATED",e.UNKNOWN_ERROR_CODE="UNKNOWN_ERROR_CODE"}(r=t.ArcGISTokenRequestErrorCodes||(t.ArcGISTokenRequestErrorCodes={}));class n extends Error{constructor(e="UNKNOWN_ERROR",t=r.UNKNOWN_ERROR_CODE,n,o,s){super(e);const a=new.target.prototype;Object.setPrototypeOf(this,a),this.name="ArcGISTokenRequestError",this.message=`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=n,this.url=o,this.options=s}}t.ArcGISTokenRequestError=n},8398:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorTypes=void 0,(r=t.ErrorTypes||(t.ErrorTypes={})).ArcGISRequestError="ArcGISRequestError",r.ArcGISAuthError="ArcGISAuthError",r.ArcGISAccessDeniedError="ArcGISAccessDeniedError",r.ArcGISTokenRequestError="ArcGISTokenRequestError"},7540:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3969:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8721:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6480:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3799:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4589:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5745:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2577:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7425:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9510:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5932:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1055:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appendCustomParams=void 0,t.appendCustomParams=function(e,t,r){const n=Object.assign(Object.assign({params:{}},r),e);return n.params=t.reduce(((t,r)=>((e[r]||"boolean"==typeof e[r]||"number"==typeof e[r]&&0===e[r])&&(t[r]=e[r]),t)),n.params),["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"].reduce(((e,t)=>(n[t]&&(e[t]=n[t]),e)),{})}},9142:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.base64UrlEncode=void 0,t.base64UrlEncode=function(e,t=window){return!t&&window&&(t=window),t.btoa(String.fromCharCode.apply(null,e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}},560:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cleanUrl=void 0,t.cleanUrl=function(e){return"string"!=typeof e||"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}},635:(e,t)=>{"use strict";function r(e){const[t,r]=e.split("=");return{key:decodeURIComponent(t),value:decodeURIComponent(r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.decodeQueryString=t.decodeParam=void 0,t.decodeParam=r,t.decodeQueryString=function(e){return!e||e.length<=0?{}:e.replace(/^#/,"").replace(/^\?/,"").split("&").reduce(((e,t)=>{const{key:n,value:o}=r(t);return e[n]=o,e}),{})}},2255:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeFormData=void 0;const n=r(7216),o=r(440),s=r(9091);t.encodeFormData=function(e,t){const r=(0,n.requiresFormData)(e)||t,a=(0,n.processParams)(e);if(r){const e=new s.FormData;return Object.keys(a).forEach((t=>{if("undefined"!=typeof Blob&&a[t]instanceof Blob){const r=a.fileName||a[t].name||t;e.append(t,a[t],r)}else e.append(t,a[t])})),e}return(0,o.encodeQueryString)(e)}},440:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeQueryString=t.encodeParam=void 0;const n=r(7216);function o(e,t){return Array.isArray(t)&&t[0]&&Array.isArray(t[0])?t.map((t=>o(e,t))).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t)}t.encodeParam=o,t.encodeQueryString=function(e){const t=(0,n.processParams)(e);return Object.keys(t).map((e=>o(e,t[e]))).join("&")}},5695:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateCodeChallenge=void 0;const n=r(9142);t.generateCodeChallenge=function(e,t=window){if(!t&&window&&(t=window),e&&t.isSecureContext&&t.crypto&&t.crypto.subtle){const r=(new t.TextEncoder).encode(e);return t.crypto.subtle.digest("SHA-256",r).then((e=>(0,n.base64UrlEncode)(new Uint8Array(e),t)))}return Promise.resolve(null)}},7918:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateRandomString=void 0;const n=r(9142);t.generateRandomString=function(e){!e&&window&&(e=window);const t=e.crypto.getRandomValues(new Uint8Array(32));return(0,n.base64UrlEncode)(t)}},4953:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processJobParams=void 0,t.processJobParams=function(e){return Object.keys(e).reduce(((t,r)=>{const n=e[r],o=n.constructor.name;return t[r]="Array"===o?JSON.stringify(n):n,t}),{})}},7216:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processParams=t.requiresFormData=void 0,t.requiresFormData=function(e){return Object.keys(e).some((t=>{let r=e[t];if(!r)return!1;switch(r&&r.toParam&&(r=r.toParam()),r.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}}))},t.processParams=function(e){const t={};return Object.keys(e).forEach((r=>{var n,o;let s,a=e[r];if(a&&a.toParam&&(a=a.toParam()),a||0===a||"boolean"==typeof a||"string"==typeof a){switch(a.constructor.name){case"Array":const e=null===(o=null===(n=a[0])||void 0===n?void 0:n.constructor)||void 0===o?void 0:o.name;s="Array"===e?a:"Object"===e?JSON.stringify(a):a.join(",");break;case"Object":s=JSON.stringify(a);break;case"Date":s=a.valueOf();break;case"Function":s=null;break;case"Boolean":s=a+"";break;default:s=a}(s||0===s||"string"==typeof s||Array.isArray(s))&&(t[r]=s)}})),t}},9902:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2598:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.warn=void 0,t.warn=function(e){console&&console.warn&&console.warn.apply(console,[e])}},6571:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withOptions=void 0,t.withOptions=function(e,t){return(...r)=>{const n="object"==typeof r[r.length-1]?Object.assign(Object.assign({},e),r.pop()):e;return t(...r,n)}}},31:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateAppAccess=void 0;const n=r(309);t.validateAppAccess=function(e,t,r="https://www.arcgis.com/sharing/rest"){const o=`${r}/oauth2/validateAppAccess`,s={method:"POST",params:{f:"json",client_id:t,token:e}};return(0,n.request)(o,s)}},2338:(e,t,r)=>{"use strict";function n(){return Promise.resolve({fetch:globalThis.fetch,Headers:globalThis.Headers,Response:globalThis.Response,Request:globalThis.Request})}r.r(t),r.d(t,{getFetch:()=>n})},9091:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Blob:()=>s,File:()=>o,FormData:()=>n});const n=globalThis.FormData,o=globalThis.File,s=globalThis.Blob},7582:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>D,__assign:()=>s,__asyncDelegator:()=>T,__asyncGenerator:()=>R,__asyncValues:()=>k,__await:()=>w,__awaiter:()=>f,__classPrivateFieldGet:()=>P,__classPrivateFieldIn:()=>L,__classPrivateFieldSet:()=>A,__createBinding:()=>y,__decorate:()=>i,__disposeResources:()=>J,__esDecorate:()=>u,__exportStar:()=>g,__extends:()=>o,__generator:()=>m,__importDefault:()=>x,__importStar:()=>U,__makeTemplateObject:()=>O,__metadata:()=>h,__param:()=>c,__propKey:()=>d,__read:()=>S,__rest:()=>a,__runInitializers:()=>l,__setFunctionName:()=>p,__spread:()=>v,__spreadArray:()=>E,__spreadArrays:()=>b,__values:()=>_,default:()=>M});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function i(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,o,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var i,c=n.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),p=!1,h=r.length-1;h>=0;h--){var f={};for(var m in n)f[m]="access"===m?{}:n[m];for(var m in n.access)f.access[m]=n.access[m];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var y=(0,r[h])("accessor"===c?{get:d.get,set:d.set}:d[u],f);if("accessor"===c){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(i=a(y.get))&&(d.get=i),(i=a(y.set))&&(d.set=i),(i=a(y.init))&&o.unshift(i)}else(i=a(y))&&("field"===c?o.unshift(i):d[u]=i)}l&&Object.defineProperty(l,n.name,d),p=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))}function m(e,t){var r,n,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}var y=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||y(t,e,r)}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(o)throw o.error}}return a}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var s=arguments[t],a=0,i=s.length;a<i;a++,o++)n[o]=s[a];return n}function E(e,t,r){if(r||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function R(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){s.push([e,t,r,n])>1||i(e,t)}))})}function i(e,t){try{(r=o[e](t)).value instanceof w?Promise.resolve(r.value.v).then(c,u):l(s[0][2],r)}catch(e){l(s[0][3],e)}var r}function c(e){i("next",e)}function u(e){i("throw",e)}function l(e,t){e(t),s.shift(),s.length&&i(s[0][0],s[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:w(e[n](t)),done:!1}:o?o(t):t}:o}}function k(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=_(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}}function O(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var I=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function U(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&y(t,e,r);return I(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function P(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function A(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function L(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function D(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var C="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function J(e){function t(t){e.error=e.hasError?new C(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const M={__extends:o,__assign:s,__rest:a,__decorate:i,__param:c,__metadata:h,__awaiter:f,__generator:m,__createBinding:y,__exportStar:g,__values:_,__read:S,__spread:v,__spreadArrays:b,__spreadArray:E,__await:w,__asyncGenerator:R,__asyncDelegator:T,__asyncValues:k,__makeTemplateObject:O,__importStar:U,__importDefault:x,__classPrivateFieldGet:P,__classPrivateFieldSet:A,__classPrivateFieldIn:L,__addDisposableResource:D,__disposeResources:J}}},y={};function g(e){var t=y[e];if(void 0!==t)return t.exports;var r=y[e]={exports:{}};return m[e](r,r.exports,g),r.exports}return g.d=(e,t)=>{for(var r in t)g.o(t,r)&&!g.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),g.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},g(128)})()));
//# sourceMappingURL=main.js.map