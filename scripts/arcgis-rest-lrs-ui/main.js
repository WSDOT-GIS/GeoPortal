define(["esri/geometry/Point","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/renderers/SimpleRenderer","esri/layers/FeatureLayer","esri/dijit/PopupTemplate","esri/Color","dijit/layout/ContentPane","esri/geometry/Polyline","esri/SpatialReference","esri/graphic","esri/geometry/jsonUtils","esri/toolbars/draw","esri/map"],function(e,t,r,n,o,a,i,u,s,c,l,f,d,p){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=24)}([function(e,t,r){var n,o;n=[r,t,r(1),r(20),r(4),r(19),r(18),r(17),r(3)],void 0===(o=function(e,t,r,n,o,a,i,u,s){"use strict";function c(e){if(!e)return null;for(var t=/[A-Z]?[a-z]+/g,r=t.exec(e),n=new Array;r;){var o=r[0].toLowerCase();n.push(o),r=t.exec(e)}return n.join(" ")}function l(e,t,r){var n=document.createElement("label");return n.htmlFor=t.id,n.textContent=r||c(t.name),e.appendChild(n),e.appendChild(t),n}Object.defineProperty(t,"__esModule",{value:!0}),u=r.__importDefault(u),t.defaultLrsMapServiceUrl="https://data.wsdot.wa.gov/arcgis/rest/services/CountyRoutes/CRAB_Routes/MapServer",t.defaultLrsSvcUrl=t.defaultLrsMapServiceUrl+"/exts/LRSServer",t.defaultLayerId=0,t.getLrsServerEndpointUrl=function(e,t,r){if(!e.match(/^(?:https?:)?\/\/.+\/(Map|Feature)Server\b/i))throw Error('URL is not in expected format: "'+e+'".');return e+"/exts/LRSServer/"+t+"/"+r},t.generateId=function(e){for(var t=e,r=0;document.getElementById(t);)t=""+e+r,r++;return t},t.splitName=c,t.addNamedControlsToElement=function(e,t){for(var r in t)t.hasOwnProperty(r)&&l(e,t[r],r)},t.addToFormWithLabel=l,t.IterateG2MOutputToFeatures=function(e){var t,n,u,s,c,l,f,d,p,m,y,b,h,R,v,S;return r.__generator(this,function(r){switch(r.label){case 0:new Intl.NumberFormat("en-US",{maximumFractionDigits:3}),t=e.locations,n=e.spatialReference,u=new i(n),s=0,c=t,r.label=1;case 1:if(!(s<c.length))return[3,6];l=c[s],f=l.results,d=l.status,p=0,m=f,r.label=2;case 2:return p<m.length?(y=m[p],b=y.routeId,h=y.measure,R=y.geometry,y.geometryType,v={status:d,routeId:b,measure:h},S=new o(R.x,R.y,u),[4,new a({geometry:S,attributes:v})]):[3,5];case 3:r.sent(),r.label=4;case 4:return p++,[3,2];case 5:return s++,[3,1];case 6:return[2]}})},t.m2gOutputToFeatures=function(e){var t,c,l,f,d,p,m,y,b,h,R,v,S,w,g,U,L,J,I;return r.__generator(this,function(r){switch(r.label){case 0:t=e.locations,c=e.spatialReference,l=new i(c),f=0,d=t,r.label=1;case 1:return f<d.length?(p=d[f],m=p.routeId,y=p.status,b=s.parseCrabRouteId(m),h=b.countyFipsCode,R=b.direction,v=b.roadNumber,S=u.default.get(h),"esriGeometryPoint"!==p.geometryType?[3,3]:(w=p.geometry,g=w.x,U=w.y,L=w.m,I=new o(g,U,l),[4,new a({geometry:I,attributes:{routeId:m,status:y,county:S,direction:R,roadNumber:v,measure:L}})])):[3,6];case 2:return r.sent(),[3,5];case 3:return(J=p.geometry).paths,J.hasM,(I=n.fromJson(p.geometry)).setSpatialReference(l),[4,new a({geometry:I,attributes:{routeId:m,status:y,county:S,direction:R,roadNumber:v}})];case 4:r.sent(),r.label=5;case 5:return f++,[3,1];case 6:return[2]}})}}.apply(t,n))||(e.exports=o)},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return o}),r.d(t,"__assign",function(){return a}),r.d(t,"__rest",function(){return i}),r.d(t,"__decorate",function(){return u}),r.d(t,"__param",function(){return s}),r.d(t,"__metadata",function(){return c}),r.d(t,"__awaiter",function(){return l}),r.d(t,"__generator",function(){return f}),r.d(t,"__exportStar",function(){return d}),r.d(t,"__values",function(){return p}),r.d(t,"__read",function(){return m}),r.d(t,"__spread",function(){return y}),r.d(t,"__await",function(){return b}),r.d(t,"__asyncGenerator",function(){return h}),r.d(t,"__asyncDelegator",function(){return R}),r.d(t,"__asyncValues",function(){return v}),r.d(t,"__makeTemplateObject",function(){return S}),r.d(t,"__importStar",function(){return w}),r.d(t,"__importDefault",function(){return g});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function s(e,t){return function(r,n){t(r,n,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{s(n.next(e))}catch(e){a(e)}}function u(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,u)}s((n=n.apply(e,t||[])).next())})}function f(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function d(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function h(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){a.push([e,t,r,n])>1||u(e,t)})})}function u(e,t){try{(r=o[e](t)).value instanceof b?Promise.resolve(r.value.v).then(s,c):l(a[0][2],r)}catch(e){l(a[0][3],e)}var r}function s(e){u("next",e)}function c(e){u("throw",e)}function l(e,t){e(t),a.shift(),a.length&&u(a[0][0],a[0][1])}}function R(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){e[n]&&(t[n]=function(t){return(r=!r)?{value:b(e[n](t)),done:"return"===n}:o?o(t):t})}}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):p(e)}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function g(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){var n,o;n=[r,t,r(5),r(3),r(0)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var a=this;this.mapServiceUrl=e,this.layerId=t,this.form=document.createElement("form"),this.form.classList.add("measure-to-geometry-form"),this.form.action=o.getLrsServerEndpointUrl(e,t,"measureToGeometry");var i=document.createDocumentFragment(),u=document.createElement("input");u.id=o.generateId("m2gRouteIdInput"),u.name="routeId",u.required=!0,u.pattern=n.crabRouteIdRe.source;var s=document.createElement("input");s.id=o.generateId("m2gFromMeasureInput"),s.name="measure",s.required=!0;var c=document.createElement("input");c.id=o.generateId("m2gToMeasureField"),c.name="toMeasure",c.required=!1;for(var l=0,f=[s,c];l<f.length;l++){var d=f[l];d.type="number",d.step="0.001"}var p=document.createElement("input");p.type="date",p.id=o.generateId("m2gTemporalViewDate"),o.addNamedControlsToElement(i,{"Route ID":u,"From Measure":s,"To Measure":c,"Temporal View Date":p}),this.routeIdInput=u,this.fromMeasureInput=s,this.toMeasureInput=c,this.temporalViewDateInput=p;var m=document.createElement("button");m.type="submit",m.textContent="Submit",i.appendChild(m);var y=document.createElement("button");y.type="reset",y.textContent="Reset",i.appendChild(y),this.form.appendChild(i),this.form.addEventListener("submit",function(e){var t=e.target,n=new r.LrsClient(a.form.action),o=a.temporalViewDateInput.value?a.temporalViewDateInput.valueAsDate:void 0,i=n.measureToGeometry(a.layerId,a.locations,o,3857),u=new CustomEvent("m2gsubmit",{detail:i});t.dispatchEvent(u),e.preventDefault()})}return Object.defineProperty(e.prototype,"temporalViewDate",{get:function(){return this.temporalViewDateInput.value?this.temporalViewDateInput.valueAsDate:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"locations",{get:function(){var e=this.routeIdInput.value,t=this.fromMeasureInput.valueAsNumber,r=this.toMeasureInput.value?this.toMeasureInput.valueAsNumber:null;return null===r?[{routeId:e,measure:t}]:[{routeId:e,fromMeasure:t,toMeasure:r}]},enumerable:!0,configurable:!0}),e}();t.MeasureToGeometryControl=a}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crabRouteIdRe=/^(53\d{3})(\d{5})([a-z])$/,t.parseCrabRouteId=function(e){if(!e)throw new TypeError("The routeId cannot be falsy. Must match the following RegExp:\n"+t.crabRouteIdRe);var r=e.match(t.crabRouteIdRe);if(!r)throw new Error("Invalid CRAB route ID: "+e+". Must match "+t.crabRouteIdRe);var n=r.slice(1,3).map(function(e){if(e){var t=parseInt(e,10);if(!isNaN(t))return t}return e});return{countyFipsCode:n[0],roadNumber:n[1],direction:r[3]}}}.apply(t,[r,t]))||(e.exports=n)},function(t,r){t.exports=e},function(e,t,r){var n;window,e.exports=(n=r(23),function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t){e.exports=n},function(e,t,r){"use strict";function n(e){return e.getTime()}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */r.r(t);var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};function a(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{s(n.next(e))}catch(e){a(e)}}function u(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,u)}s((n=n.apply(e,t||[])).next())})}function i(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}Object.assign;var u=/^https?:\/\/.+\/MapServer\/exts\/LRSServer\b/,s=new RegExp(u.source+"/layers\\b"),c=new RegExp(u.source+"/applyEdits\\b"),l=new RegExp(u.source+"/createVersion\\b"),f=new RegExp(u.source+"/deleteVersion\\b"),d=new RegExp(u.source+"/reconcileVersion\\b"),p=new RegExp(u.source+"/networkLayers\\b"),m=new RegExp(p.source+"/\\d+\\b"),y=new RegExp(m.source+"/geometryToMeasure\\b"),b=new RegExp(m.source+"/measureToGeometry\\b"),h=new RegExp(m.source+"/translate\\b"),R=new RegExp(m.source+"/concurrencies\\b"),v=new RegExp(m.source+"/queryAttributeSet\\b"),S=new RegExp(m.source+"/checkEvents\\b"),w=new RegExp(u.source+"/eventLayers\\b"),g=new RegExp(w.source+"/\\d+\\b"),U=new RegExp(g.source+"/geometryToStation\\b"),L=new RegExp(g.source+"/stationToGeometry\\b"),J=new RegExp(u.source+"/redlineLayers\\b"),I=new RegExp(J.source+"/\\d+\\b"),D=new RegExp(u.source+"/centerlineLayers\\b"),E=new RegExp(D.source+"/\\d+\\b"),_=new RegExp(u.source+"/calibrationPointLayers\\b"),P=new RegExp(_.source+"/\\d+\\b"),C=new RegExp(u.source+"/intersectionLayers\\b"),G=new RegExp(C.source+"/\\d+\\b"),O=new RegExp(u.source+"/nonLRSLayers\\b"),x=new RegExp(O.source+"/\\d+\\b"),M=new RegExp(u.source+"/locks\\b"),T=new RegExp(M.source+"/query\\b"),N=new RegExp(M.source+"/acquire\\b"),F=new RegExp(M.source+"/release\\b"),j=r(0),A=function(e){function t(t,r){var n=this,o=t+" does not match "+r+".";return(n=e.call(this,o)||this).url=t,n.re=r,n}return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t}(Error);function B(e,t){var r=e.match(t);if(r)return r[0];throw new A(e,t)}function k(e,t){return a(this,void 0,void 0,function(){var r;return i(this,function(n){return r=B(r=e.endpoint,t),delete e.endpoint,[2,Object(j.request)(r,e)]})})}function V(e){return a(this,void 0,void 0,function(){return i(this,function(t){return[2,k(e,u)]})})}function W(e){return a(this,void 0,void 0,function(){return i(this,function(t){return[2,k(e,s)]})})}function q(e){return a(this,void 0,void 0,function(){return i(this,function(t){return[2,k(e,p)]})})}function K(e){if(Array.isArray(e)){if(e.length<2)throw TypeError("Item must be an array with two or more elements.");return{geometry:{x:e[0],y:e[1]}}}return e}var H=function(){function e(e){this._url=B(e,u)}return Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),e.prototype.geometryToMeasure=function(e,t,r,n,o,u,s){return a(this,void 0,void 0,function(){var a,c;return i(this,function(i){switch(i.label){case 0:return a=this.url+"/networkLayers/"+e+"/geometryToMeasure",c={locations:t.map(K)},void 0!==r&&(c.tolerance=r),n&&(c.temporalViewDate=n.getTime()),o&&(c.inSR=o),u&&(c.outSR=u),s&&(c.gdbVersion=s),[4,Object(j.request)(a,{params:c})];case 1:return[2,i.sent()]}})})},e.prototype.measureToGeometry=function(e,t,r,n,o){return a(this,void 0,void 0,function(){var a,u;return i(this,function(i){switch(i.label){case 0:return a=this.url+"/networkLayers/"+e+"/measureToGeometry",u={layerId:e,locations:t},r&&(u.temporalViewDate=r.getTime()),n&&(u.outSR=n),o&&(u.gdbVersion=o),[4,Object(j.request)(a,{params:u})];case 1:return[2,i.sent()]}})})},e}();r.d(t,"dateToTimeInstant",function(){return n}),r.d(t,"validateUrl",function(){return B}),r.d(t,"getLrsServiceInfo",function(){return V}),r.d(t,"getAllLayers",function(){return W}),r.d(t,"getNetworkLayers",function(){return q}),r.d(t,"LrsClient",function(){return H}),r.d(t,"lrsServer",function(){return u}),r.d(t,"allLayers",function(){return s}),r.d(t,"applyEdits",function(){return c}),r.d(t,"createVersion",function(){return l}),r.d(t,"deleteVersion",function(){return f}),r.d(t,"reconcileVersion",function(){return d}),r.d(t,"networkLayers",function(){return p}),r.d(t,"networkLayer",function(){return m}),r.d(t,"geometryToMeasure",function(){return y}),r.d(t,"measureToGeometry",function(){return b}),r.d(t,"translate",function(){return h}),r.d(t,"concurrencies",function(){return R}),r.d(t,"queryAttributeSet",function(){return v}),r.d(t,"checkEvents",function(){return S}),r.d(t,"eventLayers",function(){return w}),r.d(t,"eventLayer",function(){return g}),r.d(t,"geometryToStation",function(){return U}),r.d(t,"stationToGeometry",function(){return L}),r.d(t,"redlineLayers",function(){return J}),r.d(t,"redlineLayer",function(){return I}),r.d(t,"centerlineLayers",function(){return D}),r.d(t,"centerlineLayer",function(){return E}),r.d(t,"calibrationPointLayers",function(){return _}),r.d(t,"calibrationPointLayer",function(){return P}),r.d(t,"intersectionLayers",function(){return C}),r.d(t,"intersectionLayer",function(){return G}),r.d(t,"nonLRSLayers",function(){return O}),r.d(t,"nonLRSLayer",function(){return x}),r.d(t,"locks",function(){return M}),r.d(t,"locksQuery",function(){return T}),r.d(t,"locksAcquire",function(){return N}),r.d(t,"locksRelease",function(){return F})}]))},function(e,t,r){var n,o;n=[r,t,r(1),r(5),r(22),r(21),r(0)],void 0===(o=function(e,t,r,n,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t,u){void 0===t&&(t=i.defaultLrsSvcUrl),void 0===u&&(u=i.defaultLayerId);var s=this;if(this.map=e,this.url=t,this.layerId=u,!(e&&e instanceof o))throw TypeError("Invalid map: "+e);this.form=function(e,t){void 0===e&&(e=i.defaultLrsSvcUrl),void 0===t&&(t=i.defaultLayerId);var r=document.createElement("form");r.id=i.generateId("geometryToMeasureForm"),r.action=e+"/networkLayers/"+t+"/geometryToMeasure";var n=document.createElement("input");n.type="number",n.min="0",n.name="tolerance",n.id=i.generateId("toleranceInput"),i.addToFormWithLabel(r,n);var o=document.createElement("input");o.type="date",o.name="temporalViewDate",o.id=i.generateId("temporalViewDateInput"),i.addToFormWithLabel(r,o);var a=document.createElement("button");return a.type="submit",a.textContent="Locate",r.appendChild(a),r}(t,u),this.draw=new a(this.map),this.lrsClient=new n.LrsClient(t);var c=this;this.form.addEventListener("submit",function(e){try{c.draw.activate(a.POINT),c.map.setInfoWindowOnClick(!1),c.map.disablePopups()}catch(e){alert("Error: Could not activate the draw toolbar."),console.error("Error activating the draw toolbar",e)}e.preventDefault()}),this.draw.on("draw-complete",function(e){return r.__awaiter(s,void 0,void 0,function(){var t,n,o,a,i,u;return r.__generator(this,function(r){switch(r.label){case 0:if(c.draw.deactivate(),c.map.setInfoWindowOnClick(!0),c.map.enablePopups(),!e.geometry||!e.geometry.type.match(/point/gi))return[2];t=e.geometry,n=e.geometry.spatialReference.wkid,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.lrsClient.geometryToMeasure(c.layerId,[[t.x,t.y]],c.tolerance,c.temporalViewDate,n,n)];case 2:return o=r.sent(),a=new CustomEvent("geometryToMeasure",{detail:o}),c.form.dispatchEvent(a),[3,4];case 3:return i=r.sent(),u=new CustomEvent("geometryToMeasureError",{detail:i}),c.form.dispatchEvent(u),[3,4];case 4:return[2]}})})})}return Object.defineProperty(e.prototype,"toleranceInput",{get:function(){var e=this.form.elements.namedItem("tolerance");if(!(e&&e instanceof HTMLInputElement))throw new Error("No input element named tolerance was found in this form.");return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tolerance",{get:function(){return this.toleranceInput.valueAsNumber},set:function(e){this.toleranceInput.value=null!=e?e.toString(10):""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"temporalViewDate",{get:function(){var e=this.form.elements.namedItem("temporalViewDate");if(e&&e.value)return e.valueAsDate},enumerable:!0,configurable:!0}),e}();t.GeometryToMeasureControl=u}.apply(t,n))||(e.exports=o)},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t){e.exports=a},function(e,t){e.exports=i},function(e,t,r){var n,o;n=[r,t,r(12),r(11),r(10),r(9),r(8),r(7)],void 0===(o=function(e,t,r,n,o,a,i,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=new u;s.setColor(new r("red"));var c=new a(s),l=new(Array.bind.apply(Array,[void 0].concat([{name:"routeId",type:"esriFieldTypeString",alias:"Route ID"},{name:"status",type:"esriFieldTypeString",alias:"Locating Status"},{name:"county",type:"esriFieldTypeString",alias:"County"},{name:"direction",type:"esriFieldTypeString",alias:"Direction"},{name:"roadNumber",type:"esriFieldTypeInteger",alias:"Road Number"},{name:"measure",type:"esriFieldTypeDouble",alias:"Measure"}])));function f(e){return"<table>"+e.map(function(e){return'<tr><th scope="row">'+e.name+"</th><td>{"+e.name+"}</td></tr>"}).join("")+"</table>"}var d=l.map(function(e){var t=e.name,r=(e.alias,e.type);return"measure"===t?{name:t="fromMeasure",type:r,alias:"From Measure"}:e}).concat([{name:"endMeasure",type:"esriFieldTypeDouble",alias:"End Measure"}]),p={geometryType:"esriGeometryPoint",fields:l},m={geometry:"esriGeometryLine",fields:d},y=new n({title:"Located CRAB Point",description:f(l)}),b=new n({title:"Located CRAB Line Segment",description:f(d)}),h=new o({layerDefinition:p,featureSet:null},{id:"CRAB Points"});t.crabPointsLayer=h,h.setInfoTemplate(y),h.setRenderer(c);var R=new o({layerDefinition:m,featureSet:null},{id:"CRAB Lines"});t.crabLinesLayer=R,R.setInfoTemplate(b);var v=new a(new i(i.STYLE_SOLID,new r("red"),3));R.setRenderer(v)}.apply(t,n))||(e.exports=o)},function(e,t){e.exports=u},function(e,t){e.exports=s},function(e,t,r){var n,o;n=[r,t,r(1),r(14),r(4),r(15),r(6),r(13),r(2),r(0)],void 0===(o=function(e,t,r,n,o,a,i,u,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupCrab=function(e,t,l){var f=this;void 0===t&&(t=c.defaultLrsMapServiceUrl),void 0===l&&(l=c.defaultLayerId);var d=document.getElementById("toolsAccordion");if(!d)throw Error("#toolsAccordion element not found.");var p=document.createElement("div");p.id="crabPane",d.appendChild(p);var m=new n({title:"CRAB",id:"crabPane"},p);e.addChild(m);var y=document.createElement("div");y.id="crabUI",window.addEventListener("mapload",function(e){var n=e.detail;n.addLayers([u.crabPointsLayer,u.crabLinesLayer]);var d=document.createElement("div");d.textContent="Geometry to Measure",d.classList.add("crab-tool-label"),y.appendChild(d);var p=new i.GeometryToMeasureControl(n);p.tolerance=50,y.appendChild(p.form),p.form.addEventListener("geometryToMeasure",function(e){var t=e.detail,r=c.IterateG2MOutputToFeatures(t);u.crabPointsLayer.suspend();try{for(var n=r.next();n&&!n.done;)u.crabPointsLayer.add(n.value),n=r.next()}finally{u.crabPointsLayer.resume()}}),p.form.addEventListener("geometryToMeasureError",function(e){var t=e.detail;console.error("geometry to measure error",t),alert("Geometry to measure error. See console for details.")});var m=document.createElement("div");m.classList.add("crab-tool-label"),m.textContent="Measure to Geometry",y.appendChild(m);var b=new s.MeasureToGeometryControl(t,l);y.appendChild(b.form),b.form.addEventListener("m2gsubmit",function(e){return r.__awaiter(f,void 0,void 0,function(){var t,i,s,l,f,d,p;return r.__generator(this,function(r){switch(r.label){case 0:t=e.detail,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t];case 2:return i=r.sent(),[3,4];case 3:return s=r.sent(),console.error("measureToGeometry",s),[2];case 4:for(l=c.m2gOutputToFeatures(i),f=l.next(),d=null;!f.done;)d=f.value,/Point$/i.test(d.geometry.type)?u.crabPointsLayer.add(d):u.crabLinesLayer.add(d),f=l.next();return d&&d.geometry&&((p=d.geometry)instanceof o?n.centerAt(p):p instanceof a&&n.setExtent(p.getExtent())),[2]}})})})}),p.appendChild(y)}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t=new Map;if(!e||!e.features)throw new TypeError("FeatureSet features not defined.");for(var r=0,n=e.features;r<n.length;r++){var o=n[r].attributes,a=o.JURLBL,i=o.JURFIPSDSG;if(!i||!a)throw new TypeError("FIPS: "+i+", Label: "+a);t.set(i,a)}return t}({displayFieldName:"JURLBL",fieldAliases:{JURLBL:"JURISDICTION LABEL",JURNM:"JURISDICTION NAME",JURDSG:"COUNTY NUMBER",JURFIPSDSG:"COUNTY FIPS CODE"},fields:[{name:"JURLBL",type:"esriFieldTypeString",alias:"JURISDICTION LABEL",length:20},{name:"JURNM",type:"esriFieldTypeString",alias:"JURISDICTION NAME",length:50},{name:"JURDSG",type:"esriFieldTypeDouble",alias:"COUNTY NUMBER"},{name:"JURFIPSDSG",type:"esriFieldTypeDouble",alias:"COUNTY FIPS CODE"}],features:[{attributes:{JURLBL:"Adams",JURNM:"Adams County",JURDSG:1,JURFIPSDSG:53001}},{attributes:{JURLBL:"Asotin",JURNM:"Asotin County",JURDSG:2,JURFIPSDSG:53003}},{attributes:{JURLBL:"Benton",JURNM:"Benton County",JURDSG:3,JURFIPSDSG:53005}},{attributes:{JURLBL:"Chelan",JURNM:"Chelan County",JURDSG:4,JURFIPSDSG:53007}},{attributes:{JURLBL:"Clallam",JURNM:"Clallam County",JURDSG:5,JURFIPSDSG:53009}},{attributes:{JURLBL:"Clark",JURNM:"Clark County",JURDSG:6,JURFIPSDSG:53011}},{attributes:{JURLBL:"Columbia",JURNM:"Columbia County",JURDSG:7,JURFIPSDSG:53013}},{attributes:{JURLBL:"Cowlitz",JURNM:"Cowlitz County",JURDSG:8,JURFIPSDSG:53015}},{attributes:{JURLBL:"Douglas",JURNM:"Douglas County",JURDSG:9,JURFIPSDSG:53017}},{attributes:{JURLBL:"Ferry",JURNM:"Ferry County",JURDSG:10,JURFIPSDSG:53019}},{attributes:{JURLBL:"Franklin",JURNM:"Franklin County",JURDSG:11,JURFIPSDSG:53021}},{attributes:{JURLBL:"Garfield",JURNM:"Garfield County",JURDSG:12,JURFIPSDSG:53023}},{attributes:{JURLBL:"Grant",JURNM:"Grant County",JURDSG:13,JURFIPSDSG:53025}},{attributes:{JURLBL:"Grays Harbor",JURNM:"Grays Harbor County",JURDSG:14,JURFIPSDSG:53027}},{attributes:{JURLBL:"Island",JURNM:"Island County",JURDSG:15,JURFIPSDSG:53029}},{attributes:{JURLBL:"Jefferson",JURNM:"Jefferson County",JURDSG:16,JURFIPSDSG:53031}},{attributes:{JURLBL:"King",JURNM:"King County",JURDSG:17,JURFIPSDSG:53033}},{attributes:{JURLBL:"Kitsap",JURNM:"Kitsap County",JURDSG:18,JURFIPSDSG:53035}},{attributes:{JURLBL:"Kittitas",JURNM:"Kittitas County",JURDSG:19,JURFIPSDSG:53037}},{attributes:{JURLBL:"Klickitat",JURNM:"Klickitat County",JURDSG:20,JURFIPSDSG:53039}},{attributes:{JURLBL:"Lewis",JURNM:"Lewis County",JURDSG:21,JURFIPSDSG:53041}},{attributes:{JURLBL:"Lincoln",JURNM:"Lincoln County",JURDSG:22,JURFIPSDSG:53043}},{attributes:{JURLBL:"Mason",JURNM:"Mason County",JURDSG:23,JURFIPSDSG:53045}},{attributes:{JURLBL:"Okanogan",JURNM:"Okanogan County",JURDSG:24,JURFIPSDSG:53047}},{attributes:{JURLBL:"Pacific",JURNM:"Pacific County",JURDSG:25,JURFIPSDSG:53049}},{attributes:{JURLBL:"Pend Oreille",JURNM:"Pend Oreille County",JURDSG:26,JURFIPSDSG:53051}},{attributes:{JURLBL:"Pierce",JURNM:"Pierce County",JURDSG:27,JURFIPSDSG:53053}},{attributes:{JURLBL:"San Juan",JURNM:"San Juan County",JURDSG:28,JURFIPSDSG:53055}},{attributes:{JURLBL:"Skagit",JURNM:"Skagit County",JURDSG:29,JURFIPSDSG:53057}},{attributes:{JURLBL:"Skamania",JURNM:"Skamania County",JURDSG:30,JURFIPSDSG:53059}},{attributes:{JURLBL:"Snohomish",JURNM:"Snohomish County",JURDSG:31,JURFIPSDSG:53061}},{attributes:{JURLBL:"Spokane",JURNM:"Spokane County",JURDSG:32,JURFIPSDSG:53063}},{attributes:{JURLBL:"Stevens",JURNM:"Stevens County",JURDSG:33,JURFIPSDSG:53065}},{attributes:{JURLBL:"Thurston",JURNM:"Thurston County",JURDSG:34,JURFIPSDSG:53067}},{attributes:{JURLBL:"Wahkiakum",JURNM:"Wahkiakum County",JURDSG:35,JURFIPSDSG:53069}},{attributes:{JURLBL:"Walla Walla",JURNM:"Walla Walla County",JURDSG:36,JURFIPSDSG:53071}},{attributes:{JURLBL:"Whatcom",JURNM:"Whatcom County",JURDSG:37,JURFIPSDSG:53073}},{attributes:{JURLBL:"Whitman",JURNM:"Whitman County",JURDSG:38,JURFIPSDSG:53075}},{attributes:{JURLBL:"Yakima",JURNM:"Yakima County",JURDSG:39,JURFIPSDSG:53077}}]});t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t){e.exports=c},function(e,t){e.exports=l},function(e,t){e.exports=f},function(e,t){e.exports=d},function(e,t){e.exports=p},function(e,t,r){!function(e){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n=function(e,t,r,n,o){void 0===e&&(e="UNKNOWN_ERROR"),void 0===t&&(t="UNKNOWN_ERROR_CODE"),this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:t+": "+e,this.originalMessage=e,this.code=t,this.response=r,this.url=n,this.options=o};n.prototype=Object.create(Error.prototype),n.prototype.constructor=n;var o,a=function(e){function n(t,r,n,o,a){void 0===t&&(t="AUTHENTICATION_ERROR"),void 0===r&&(r="AUTHENTICATION_ERROR_CODE");var i=e.call(this,t,r,n,o,a)||this;return i.name="ArcGISAuthError",i.message="AUTHENTICATION_ERROR_CODE"===r?t:r+": "+t,i}return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}(n,e),n.prototype.retry=function(e,t){var n=this;void 0===t&&(t=3);var o=0,a=function(i,u){e(n.url,n.options).then(function(e){var t=r({},n.options,{authentication:e});return o+=1,d(n.url,t)}).then(function(e){i(e)}).catch(function(e){"ArcGISAuthError"===e.name&&o<t?a(i,u):"ArcGISAuthError"===e.name&&o>=t?u(n):u(e)})};return new Promise(function(e,t){a(e,t)})},n}(n);function i(e,t,r,o){if(e.code>=400){var i=e.message,u=e.code;throw new n(i,u,e,t,o)}if(e.error){var s=e.error,i=s.message,u=s.code,c=s.messageCode,l=c||u||"UNKNOWN_ERROR_CODE";if(498===u||499===u||"GWM_0003"===c)throw new a(i,l,e,t,o);throw new n(i,l,e,t,o)}if("failed"===e.status){var i=void 0,u="UNKNOWN_ERROR_CODE";try{i=JSON.parse(e.statusMessage).message,u=JSON.parse(e.statusMessage).code}catch(t){i=e.statusMessage}throw new n(i,u,e,t,o)}return e}function u(e){return Object.keys(e).some(function(t){var r=e[t];if(!r)return!1;var n=r.constructor.name;switch(n){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}})}function s(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r];if(n||0===n||"boolean"==typeof n){var o,a=n.constructor.name;switch(a){case"Array":o="Object"===n[0].constructor.name?JSON.stringify(n):n.join(",");break;case"Object":o=JSON.stringify(n);break;case"Date":o=n.valueOf();break;case"Function":o=null;break;case"Boolean":o=n+"";break;default:o=n}(o||0===o)&&(t[r]=o)}}),t}function c(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(t)}function l(e){var t=s(e);return Object.keys(t).map(function(e){return c(e,t[e])}).join("&")}function f(e){var t=u(e),r=s(e);if(t){var n=new FormData;return Object.keys(r).forEach(function(e){n.append(e,r[e])}),n}return l(e)}function d(e,t){void 0===t&&(t={params:{f:"json"}});var o=r({httpMethod:"POST",fetch:fetch},t),a=[],s=[];if(o.fetch||(a.push("`fetch`"),s.push("`isomorphic-fetch`")),Promise||(a.push("`Promise`"),s.push("`es6-promise`")),FormData||(a.push("`FormData`"),s.push("`isomorphic-form-data`")),!o.fetch||!Promise||!FormData)throw new Error("`arcgis-rest-request` requires global variables for `fetch`, `Promise` and `FormData` to be present in the global scope. You are missing "+a.join(", ")+". We recommend installing the "+s.join(", ")+" modules at the root of your application to add these to the global scope. See http://bit.ly/2BXbqzq for more info.");o.fetch===fetch&&(o.fetch=fetch.bind(Function("return this")()));var c=o.httpMethod,d=o.authentication,p=r({f:"json"},t.params),m={method:c};return(d?d.getToken(e):Promise.resolve("")).then(function(t){if(t.length&&(p.token=t),"GET"===m.method){var r=e+"?"+l(p);o.maxUrlLength&&r.length>o.maxUrlLength?m.method="POST":e=r}return"POST"===m.method&&(m.body=f(p)),u(p)||(m.headers=new Headers,m.headers.append("Content-Type","application/x-www-form-urlencoded")),o.fetch(e,m)}).then(function(t){if(!t.ok){var r=t.status,a=t.statusText;throw new n(a,"HTTP "+r,t,e,o)}switch(p.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();case"image":case"zip":return t.blob()}}).then(function(t){return"json"===p.f||"geojson"===p.f?i(t,e,0,o):t})}function p(e){var t="https://www.arcgis.com/sharing/rest";return e&&e.authentication&&(t=e.authentication.portal),t}function m(e,t){var n=e||"self",o=p(t)+"/portals/"+n,a=r({httpMethod:"GET"},t);return d(o,a)}(o=e.ErrorTypes||(e.ErrorTypes={})).ArcGISRequestError="ArcGISRequestError",o.ArcGISAuthError="ArcGISAuthError",e.request=d,e.encodeFormData=f,e.encodeParam=c,e.encodeQueryString=l,e.checkForErrors=i,e.warn=function(e){console&&console.warn&&console.warn.apply(console,[e])},e.ArcGISRequestError=n,e.ArcGISAuthError=a,e.requiresFormData=u,e.processParams=s,e.getSelf=function(e){return m(null,e)},e.getPortal=m,e.getPortalUrl=p,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,r){var n,o;n=[r,t,r(1),r(6),r(2),r(0),r(16)],void 0===(o=function(e,t,r,n,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(n,t),r.__exportStar(o,t),r.__exportStar(a,t),r.__exportStar(i,t)}.apply(t,n))||(e.exports=o)}])});
//# sourceMappingURL=main.js.map