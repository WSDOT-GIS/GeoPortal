{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/arcgis-rest-lrs-ui/utils.ts","webpack:///./node_modules/tslib/tslib.es6.js","webpack:///./src/arcgis-rest-lrs-ui/MeasureToGeometryForm.ts","webpack:///./src/arcgis-rest-lrs-ui/crabUtils.ts","webpack:///./node_modules/@wsdot/arcgis-rest-lrs/dist/umd/index.js","webpack:///./src/arcgis-rest-lrs-ui/GeometryToMeasureForm.ts","webpack:///external \"esri/symbols/SimpleMarkerSymbol\"","webpack:///external \"esri/symbols/SimpleLineSymbol\"","webpack:///external \"esri/renderers/SimpleRenderer\"","webpack:///external \"esri/layers/FeatureLayer\"","webpack:///external \"esri/dijit/PopupTemplate\"","webpack:///external \"esri/Color\"","webpack:///./src/arcgis-rest-lrs-ui/layers.ts","webpack:///external \"esri/layers/ArcGISDynamicMapServiceLayer\"","webpack:///external \"dijit/layout/ContentPane\"","webpack:///./src/arcgis-rest-lrs-ui/Manager.ts","webpack:///./src/arcgis-rest-lrs-ui/CountyLookup.ts","webpack:///external \"esri/SpatialReference\"","webpack:///external \"esri/graphic\"","webpack:///external \"esri/geometry/Point\"","webpack:///external \"esri/geometry/jsonUtils\"","webpack:///external \"esri/toolbars/draw\"","webpack:///external \"esri/map\"","webpack:///./node_modules/@esri/arcgis-rest-request/dist/umd/arcgis-rest-request.umd.js","webpack:///./src/arcgis-rest-lrs-ui/main.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","splitName","re","match","exec","parts","Array","part","toLowerCase","push","join","addToFormWithLabel","form","control","labelText","label","document","createElement","htmlFor","id","textContent","appendChild","defaultLrsMapServiceUrl","defaultLrsSvcUrl","defaultLayerId","getLrsServerEndpointUrl","mapServiceUrl","layerId","endpointName","Error","generateId","outId","getElementById","addNamedControlsToElement","root","elements","name_1","IterateG2MOutputToFeatures","g2mOutput","Intl","NumberFormat","maximumFractionDigits","locations","spatialReference","sr","SpatialReference","locations_1","_i","length","loc","results","status_1","status","results_1","_a","routeId","measure","geometry","geometryType","attributes","point","Point","x","y","Graphic","_b","sent","m2gOutputToFeatures","m2gOutput","sro","locations_2","status_2","crabUtils_1","parseCrabRouteId","countyFipsCode","direction","roadNumber","county","CountyLookup_1","default","_d","_c","paths","hasM","geometryJsonUtils","fromJson","setSpatialReference","__webpack_exports__","__importDefault","extendStatics","setPrototypeOf","__proto__","b","__extends","__","this","constructor","create","__assign","assign","t","arguments","__rest","e","indexOf","getOwnPropertySymbols","__decorate","decorators","target","key","desc","getOwnPropertyDescriptor","Reflect","decorate","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","apply","__generator","body","f","g","_","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","__exportStar","__values","__read","ar","error","__spread","concat","__await","__asyncGenerator","asyncIterator","q","a","resume","fulfill","settle","shift","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__importStar","mod","k","MeasureToGeometryForm","_this","classList","add","action","utils_1","frag","createDocumentFragment","routeIdInput","required","pattern","crabRouteIdRe","source","fromMeasureInput","toMeasureInput","element","type","temporalViewDateInput","Route ID","From Measure","To Measure","Temporal View Date","submitButton","resetButton","addEventListener","ev","client","arcgis_rest_lrs_1","LrsClient","viewDate","valueAsDate","undefined","promise","measureToGeometry","customEvt","CustomEvent","detail","dispatchEvent","preventDefault","fromMeasure","valueAsNumber","toMeasure","__WEBPACK_AMD_DEFINE_RESULT__","slice","map","window","getTime","u","RegExp","w","h","R","E","L","T","S","j","O","V","A","G","M","I","D","C","N","url","Q","U","endpoint","request","z","B","F","H","isArray","J","_url","geometryToMeasure","tolerance","temporalViewDate","inSR","outSR","gdbVersion","params","GeometryToMeasureForm","EsriMap","toleranceControl","min","dateControl","createForm","draw","Draw","lrsClient","self","activate","POINT","setInfoWindowOnClick","alert","console","on","tslib_1","deactivate","wkid","g2mEvent","errorEvent","ex_1","input","namedItem","__WEBPACK_EXTERNAL_MODULE__6__","__WEBPACK_EXTERNAL_MODULE__7__","__WEBPACK_EXTERNAL_MODULE__8__","__WEBPACK_EXTERNAL_MODULE__9__","__WEBPACK_EXTERNAL_MODULE__10__","__WEBPACK_EXTERNAL_MODULE__11__","pointSymbol","SimpleMarkerSymbol","setColor","Color","pointRenderer","SimpleRenderer","pointLayerFields","bind","alias","makeDescriptionTemplate","fields","lineLayerFields","pointLayerDefinition","lineLayerDefinition","pointsPopupTemplate","PopupTemplate","title","description","linePopupTempate","crabPointsLayer","FeatureLayer","layerDefinition","featureSet","setInfoTemplate","setRenderer","crabLinesLayer","lineRenderer","SimpleLineSymbol","STYLE_SOLID","__WEBPACK_EXTERNAL_MODULE__13__","__WEBPACK_EXTERNAL_MODULE__14__","setupCrab","toolsAccordion","serviceUrl","toolsAccordianDiv","paneDiv","contentPane","ContentPane","addChild","crabUI","crabRoutesLayer","ArcGISDynamicMapServiceLayer","addLayers","layers_1","g2mForm","GeometryToMeasureForm_1","g2mEvt","features","errorEvt","m2gForm","MeasureToGeometryForm_1","evt","output","err_1","current","graphic","test","countyLookup","Map","JURLBL","fips","JURFIPSDSG","set","featureSetToMap","displayFieldName","fieldAliases","JURNM","JURDSG","__WEBPACK_EXTERNAL_MODULE__17__","__WEBPACK_EXTERNAL_MODULE__18__","__WEBPACK_EXTERNAL_MODULE__19__","__WEBPACK_EXTERNAL_MODULE__20__","__WEBPACK_EXTERNAL_MODULE__21__","__WEBPACK_EXTERNAL_MODULE__22__","ArcGISRequestError","message","code","response","options","originalMessage","ErrorTypes","ArcGISAuthError","_super","retry","getSession","retryLimit","tries","retryRequest","session","newOptions","authentication","catch","checkForErrors","messageCode","errorCode","JSON","parse","statusMessage","requiresFormData","keys","some","processParams","newParams","forEach","param","stringify","valueOf","encodeParam","encodeURIComponent","encodeQueryString","encodeFormData","useFormData","formData_1","FormData","append","requestOptions","httpMethod","fetch","missingGlobals","recommendedPackages","Function","fetchOptions","method","getToken","token","urlWithQueryString","maxUrlLength","headers","Headers","ok","statusText","json","text","blob","data","getPortalUrl","portalUrl","portal","getPortal","idOrSelf","warn","getSelf","factory","Manager_1"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 24);\n","import { IG2MOutput, IM2GOutput } from \"@wsdot/arcgis-rest-lrs\";\r\nimport {\r\n  Point as IRestPoint,\r\n  Polyline as IRestPolyline\r\n} from \"arcgis-rest-api\";\r\nimport geometryJsonUtils = require(\"esri/geometry/jsonUtils\");\r\nimport Point = require(\"esri/geometry/Point\");\r\nimport Polyline = require(\"esri/geometry/Polyline\");\r\nimport Graphic = require(\"esri/graphic\");\r\nimport FeatureLayer = require(\"esri/layers/FeatureLayer\");\r\nimport SpatialReference = require(\"esri/SpatialReference\");\r\nimport TextSymbol = require(\"esri/symbols/TextSymbol\");\r\nimport CountyLookup from \"./CountyLookup\";\r\nimport { parseCrabRouteId } from \"./crabUtils\";\r\n\r\nexport const defaultLrsMapServiceUrl =\r\n  \"https://data.wsdot.wa.gov/arcgis/rest/services/CountyRoutes/CRAB_Routes/MapServer\";\r\n\r\nexport const defaultLrsSvcUrl = `${defaultLrsMapServiceUrl}/exts/LRSServer`;\r\nexport const defaultLayerId = 0;\r\n\r\n/**\r\n *\r\n * @param mapServiceUrl URL to map service or feature service\r\n * @param layerId Layer ID\r\n * @param endpointName The name of the operation. E.g., \"measureToGeometry\".\r\n * @throws Error Throws an error if the mapServiceUrl is not in the correct format.\r\n */\r\nexport function getLrsServerEndpointUrl(\r\n  mapServiceUrl: string,\r\n  layerId: number,\r\n  endpointName: \"geometryToMeasure\" | \"measureToGeometry\" | string\r\n) {\r\n  const urlRe = /^(?:https?:)?\\/\\/.+\\/(Map|Feature)Server\\b/i;\r\n  const match = mapServiceUrl.match(urlRe);\r\n  if (!match) {\r\n    throw Error(`URL is not in expected format: \"${mapServiceUrl}\".`);\r\n  }\r\n  return `${mapServiceUrl}/exts/LRSServer/${layerId}/${endpointName}`;\r\n}\r\n\r\n/**\r\n * Creates a unique ID by appending numbers to the proposed ID until\r\n * an ID that is not already in use is found.\r\n * @param id Proposed ID\r\n */\r\nexport function generateId(id: string) {\r\n  let outId = id;\r\n  let i = 0;\r\n  while (document.getElementById(outId)) {\r\n    outId = `${id}${i}`;\r\n    i++;\r\n  }\r\n  return outId;\r\n}\r\n\r\n/**\r\n * Splits a camel- or Pascal-cased name into separate words.\r\n * @param name camel- or Pascal-cased name\r\n */\r\nexport function splitName(name?: string | null) {\r\n  if (!name) {\r\n    return null;\r\n  }\r\n  const re = /[A-Z]?[a-z]+/g;\r\n  let match = re.exec(name);\r\n  const parts = new Array<string>();\r\n  while (match) {\r\n    const part = match[0].toLowerCase();\r\n    parts.push(part);\r\n    match = re.exec(name);\r\n  }\r\n\r\n  return parts.join(\" \");\r\n}\r\n\r\nexport function addNamedControlsToElement(\r\n  root: HTMLElement | DocumentFragment,\r\n  elements: {\r\n    [name: string]: HTMLInputElement;\r\n  }\r\n) {\r\n  for (const name in elements) {\r\n    if (elements.hasOwnProperty(name)) {\r\n      const element = elements[name];\r\n      addToFormWithLabel(root, element, name);\r\n    }\r\n  }\r\n}\r\n\r\nexport function addToFormWithLabel(\r\n  form: HTMLElement | DocumentFragment,\r\n  control: HTMLInputElement,\r\n  labelText?: string\r\n) {\r\n  const label = document.createElement(\"label\");\r\n  label.htmlFor = control.id;\r\n  label.textContent = labelText || splitName(control.name);\r\n  form.appendChild(label);\r\n  form.appendChild(control);\r\n  return label;\r\n}\r\n\r\n/**\r\n * Converts output from the geometryToMeasure operation into\r\n * an array of Graphic objects.\r\n * @param g2mOutput Output from geometryToMeasure operation.\r\n */\r\nexport function* IterateG2MOutputToFeatures(g2mOutput: IG2MOutput) {\r\n  const format = new Intl.NumberFormat(\"en-US\", {\r\n    maximumFractionDigits: 3\r\n  });\r\n  const { locations, spatialReference } = g2mOutput;\r\n  const sr = new SpatialReference(spatialReference);\r\n  for (const loc of locations) {\r\n    const { results, status } = loc;\r\n    for (const r of results) {\r\n      const { routeId, measure, geometry, geometryType } = r;\r\n      const attributes = { status, routeId, measure };\r\n      const point = new Point(geometry.x, geometry.y, sr);\r\n      // const symbol = new TextSymbol(`${routeId} @ ${format.format(measure)}`);\r\n      const graphic = new Graphic({ geometry: point, attributes });\r\n      yield graphic;\r\n    }\r\n  }\r\n}\r\n\r\n// export type PointCoords =\r\n//   | [number, number, number | null, number | null]\r\n//   | [number, number, number | null]\r\n//   | [number, number];\r\n\r\nfunction* flattenPathsToPoints(paths: number[][][]) {\r\n  for (const path of paths) {\r\n    for (const point of path) {\r\n      const [x, y] = point;\r\n      const z = point.length > 2 ? point[2] : null;\r\n      const m = point.length > 3 ? point[3] : null;\r\n      yield { x, y, z, m };\r\n    }\r\n  }\r\n}\r\n\r\n// function getStartAndEndMeasures(paths: number[][][]) {\r\n//   const iterator = flattenPathsToPoints(paths);\r\n//   const array = new Array<number>();\r\n//   let current = iterator.next();\r\n//   while (!current.done) {\r\n//     if (current.value && current.value.m != null) {\r\n//       array.push(current.value.m as number);\r\n//     }\r\n//     current = iterator.next();\r\n//   }\r\n//   return [array[0], array[array.length - 1]];\r\n// }\r\n\r\nexport function* m2gOutputToFeatures(m2gOutput: IM2GOutput) {\r\n  const { locations, spatialReference } = m2gOutput;\r\n\r\n  const sro = new SpatialReference(spatialReference);\r\n\r\n  for (const loc of locations) {\r\n    const { routeId, status } = loc;\r\n    const { countyFipsCode, direction, roadNumber } = parseCrabRouteId(routeId);\r\n    const county = CountyLookup.get(countyFipsCode);\r\n    if (loc.geometryType === \"esriGeometryPoint\") {\r\n      const { x, y, m } = loc.geometry as IRestPoint;\r\n      const geometry = new Point(x, y, sro);\r\n      const attributes = {\r\n        routeId,\r\n        status,\r\n        county,\r\n        direction,\r\n        roadNumber,\r\n        measure: m\r\n      };\r\n      yield new Graphic({ geometry, attributes });\r\n    } else {\r\n      const { paths, hasM } = loc.geometry as IRestPolyline;\r\n      const geometry = geometryJsonUtils.fromJson(loc.geometry);\r\n      geometry.setSpatialReference(sro);\r\n      // const measures = getStartAndEndMeasures(paths);\r\n      const attributes = {\r\n        routeId,\r\n        status,\r\n        county,\r\n        direction,\r\n        roadNumber\r\n        // beginMeasure: measures && measures.length > 0 ? measures[0] : null,\r\n        // endMeasure: measures && measures.length > 1 ? measures[1] : null\r\n      };\r\n      yield new Graphic({ geometry, attributes });\r\n    }\r\n  }\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; }; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator];\r\n    return m ? m.call(o) : typeof __values === \"function\" ? __values(o) : o[Symbol.iterator]();\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import {\r\n  IG2MInputLocation,\r\n  IM2GLineLocation,\r\n  IM2GPointLocation,\r\n  LrsClient\r\n} from \"@wsdot/arcgis-rest-lrs\";\r\nimport EsriMap = require(\"esri/map\");\r\nimport { crabRouteIdRe } from \"./crabUtils\";\r\nimport {\r\n  addNamedControlsToElement,\r\n  generateId,\r\n  getLrsServerEndpointUrl\r\n} from \"./utils\";\r\n\r\n/**\r\n * Encapsulates the form used for measureToGeometry operation.\r\n */\r\nexport class MeasureToGeometryForm {\r\n  public readonly form: HTMLFormElement;\r\n  public readonly routeIdInput: HTMLInputElement;\r\n  public readonly fromMeasureInput: HTMLInputElement;\r\n  public readonly toMeasureInput: HTMLInputElement;\r\n  public readonly temporalViewDateInput: HTMLInputElement;\r\n\r\n  public get temporalViewDate() {\r\n    return this.temporalViewDateInput.value\r\n      ? this.temporalViewDateInput.valueAsDate\r\n      : undefined;\r\n  }\r\n\r\n  /**\r\n   * Gets the locations from the user's input.\r\n   */\r\n  public get locations(): Array<IM2GPointLocation | IM2GLineLocation> {\r\n    const routeId = this.routeIdInput.value;\r\n    const fromMeasure = this.fromMeasureInput.valueAsNumber;\r\n    const toMeasure = this.toMeasureInput.value\r\n      ? this.toMeasureInput.valueAsNumber\r\n      : null;\r\n\r\n    if (toMeasure === null) {\r\n      return [{ routeId, measure: fromMeasure }];\r\n    } else {\r\n      return [{ routeId, fromMeasure, toMeasure }];\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param mapServiceUrl measureToGeometry endpoint\r\n   * @param layerId Layer ID\r\n   * @example https://data.example.com/arcgis/rest/services/CountyRoutes/CRAB_Routes/MapServer/\"\r\n   * @throws Error is thrown if operationUrl is invalidly formatted.\r\n   */\r\n  constructor(public mapServiceUrl: string, public layerId: number) {\r\n    this.form = document.createElement(\"form\");\r\n    this.form.classList.add(\"measure-to-geometry-form\");\r\n    this.form.action = getLrsServerEndpointUrl(\r\n      mapServiceUrl,\r\n      layerId,\r\n      \"measureToGeometry\"\r\n    );\r\n\r\n    const frag = document.createDocumentFragment();\r\n\r\n    const routeIdInput = document.createElement(\"input\");\r\n    routeIdInput.id = generateId(\"m2gRouteIdInput\");\r\n    routeIdInput.name = \"routeId\";\r\n    routeIdInput.required = true;\r\n    routeIdInput.pattern = crabRouteIdRe.source;\r\n\r\n    const fromMeasureInput = document.createElement(\"input\");\r\n    fromMeasureInput.id = generateId(\"m2gFromMeasureInput\");\r\n    fromMeasureInput.name = \"measure\";\r\n    fromMeasureInput.required = true;\r\n\r\n    const toMeasureInput = document.createElement(\"input\");\r\n    toMeasureInput.id = generateId(\"m2gToMeasureField\");\r\n    toMeasureInput.name = \"toMeasure\";\r\n    toMeasureInput.required = false;\r\n\r\n    // Set numeric input restrictions.\r\n    for (const element of [fromMeasureInput, toMeasureInput]) {\r\n      element.type = \"number\";\r\n      element.step = \"0.001\";\r\n    }\r\n\r\n    const temporalViewDateInput = document.createElement(\"input\");\r\n    temporalViewDateInput.type = \"date\";\r\n    temporalViewDateInput.id = generateId(\"m2gTemporalViewDate\");\r\n\r\n    addNamedControlsToElement(frag, {\r\n      \"Route ID\": routeIdInput,\r\n      \"From Measure\": fromMeasureInput,\r\n      \"To Measure\": toMeasureInput,\r\n      \"Temporal View Date\": temporalViewDateInput\r\n    });\r\n\r\n    this.routeIdInput = routeIdInput;\r\n    this.fromMeasureInput = fromMeasureInput;\r\n    this.toMeasureInput = toMeasureInput;\r\n    this.temporalViewDateInput = temporalViewDateInput;\r\n\r\n    const submitButton = document.createElement(\"button\");\r\n    submitButton.type = \"submit\";\r\n    submitButton.textContent = \"Submit\";\r\n\r\n    frag.appendChild(submitButton);\r\n\r\n    const resetButton = document.createElement(\"button\");\r\n    resetButton.type = \"reset\";\r\n    resetButton.textContent = \"Reset\";\r\n\r\n    frag.appendChild(resetButton);\r\n\r\n    this.form.appendChild(frag);\r\n\r\n    // Setup form submit event.\r\n\r\n    this.form.addEventListener(\"submit\", ev => {\r\n      const form = ev.target;\r\n      const client = new LrsClient(this.form.action);\r\n      const viewDate = this.temporalViewDateInput.value\r\n        ? this.temporalViewDateInput.valueAsDate\r\n        : undefined;\r\n      const promise = client.measureToGeometry(\r\n        this.layerId,\r\n        this.locations,\r\n        viewDate,\r\n        3857\r\n      );\r\n      const customEvt = new CustomEvent(\"m2gsubmit\", {\r\n        detail: promise\r\n      });\r\n      form.dispatchEvent(customEvt);\r\n\r\n      ev.preventDefault();\r\n    });\r\n  }\r\n}\r\n","/**\r\n * This module is used for parsing CRAB route IDs and extracting data such as County FIPS code and direction.\r\n */\r\n\r\n/**\r\n * A regular expression that will match a CRAB route ID with groups for\r\n * 1. County FIPS code\r\n * 2. Road Number (remaining digits after FIPS code)\r\n * 3. Direction (i or d)\r\n */\r\nexport const crabRouteIdRe = /^(53\\d{3})(\\d{5})([a-z])$/;\r\n\r\n/**\r\n * Parts of a CRAB route ID.\r\n */\r\nexport interface IParsedCrabRouteId {\r\n  /** FIPS code for the county. All WA counties' codes start with \"53\" and are followed with three more digits. */\r\n  countyFipsCode: number;\r\n  /** The remaining digits after the FIPS code that uniquely ID a road. */\r\n  roadNumber: number | string;\r\n  /** Indicates a direction, e.g., \"i\" for increasing. */\r\n  direction: string;\r\n}\r\n\r\n/**\r\n * Parses a CRAB route ID into its component parts.\r\n * @param routeId Route ID from the LRS layer\r\n * @throws TypeError - Thrown if routeId is falsy.\r\n * @throws Error - Thrown if routeId string is not in the expected format.\r\n */\r\nexport function parseCrabRouteId(routeId: string): IParsedCrabRouteId {\r\n  if (!routeId) {\r\n    throw new TypeError(\r\n      `The routeId cannot be falsy. Must match the following RegExp:\\n${crabRouteIdRe}`\r\n    );\r\n  }\r\n  const match = routeId.match(crabRouteIdRe);\r\n  if (!match) {\r\n    throw new Error(\r\n      `Invalid CRAB route ID: ${routeId}. Must match ${crabRouteIdRe}`\r\n    );\r\n  }\r\n\r\n  // Parse the FIPS code and Road number into integers (number type).\r\n  const [countyFipsCode, roadNumber] = match.slice(1, 3).map(s => {\r\n    if (s) {\r\n      const int = parseInt(s, 10);\r\n      if (!isNaN(int)) {\r\n        return int;\r\n      }\r\n    }\r\n    return s;\r\n  }) as [number, number];\r\n\r\n  const direction = match[3];\r\n  return {\r\n    countyFipsCode,\r\n    roadNumber,\r\n    direction\r\n  };\r\n}\r\n","!function(e,r){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=r(require(\"@esri/arcgis-rest-request\")):\"function\"==typeof define&&define.amd?define([\"@esri/arcgis-rest-request\"],r):\"object\"==typeof exports?exports.wsdotArcgisRestLrs=r(require(\"@esri/arcgis-rest-request\")):e.wsdotArcgisRestLrs=r(e[\"@esri/arcgis-rest-request\"])}(window,function(e){return function(e){var r={};function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:t})},n.r=function(e){Object.defineProperty(e,\"__esModule\",{value:!0})},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,\"a\",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p=\"\",n(n.s=1)}([function(r,n){r.exports=e},function(e,r,n){\"use strict\";function t(e){return e.getTime()}\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */n.r(r);var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};Object.assign;function u(e,r,n,t){return new(n||(n=Promise))(function(o,u){function i(e){try{s(t.next(e))}catch(e){u(e)}}function c(e){try{s(t.throw(e))}catch(e){u(e)}}function s(e){e.done?o(e.value):new n(function(r){r(e.value)}).then(i,c)}s((t=t.apply(e,r||[])).next())})}function i(e,r){var n,t,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},\"function\"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(u){return function(c){return function(u){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,t&&(o=t[2&u[0]?\"return\":u[0]?\"throw\":\"next\"])&&!(o=o.call(t,u[1])).done)return o;switch(t=0,o&&(u=[0,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,t=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=r.call(e,i)}catch(e){u=[6,e],t=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}var c=/^https?:\\/\\/.+\\/MapServer\\/exts\\/LRSServer\\b/,s=new RegExp(c.source+\"/layers\\\\b\"),a=new RegExp(c.source+\"/applyEdits\\\\b\"),f=new RegExp(c.source+\"/createVersion\\\\b\"),l=new RegExp(c.source+\"/deleteVersion\\\\b\"),p=new RegExp(c.source+\"/reconcileVersion\\\\b\"),d=new RegExp(c.source+\"/networkLayers\\\\b\"),y=new RegExp(d.source+\"/\\\\d+\\\\b\"),b=new RegExp(y.source+\"/geometryToMeasure\\\\b\"),w=new RegExp(y.source+\"/measureToGeometry\\\\b\"),g=new RegExp(y.source+\"/translate\\\\b\"),h=new RegExp(y.source+\"/concurrencies\\\\b\"),x=new RegExp(y.source+\"/queryAttributeSet\\\\b\"),v=new RegExp(y.source+\"/checkEvents\\\\b\"),m=new RegExp(c.source+\"/eventLayers\\\\b\"),R=new RegExp(m.source+\"/\\\\d+\\\\b\"),E=new RegExp(R.source+\"/geometryToStation\\\\b\"),L=new RegExp(R.source+\"/stationToGeometry\\\\b\"),T=new RegExp(c.source+\"/redlineLayers\\\\b\"),k=new RegExp(T.source+\"/\\\\d+\\\\b\"),S=new RegExp(c.source+\"/centerlineLayers\\\\b\"),q=new RegExp(S.source+\"/\\\\d+\\\\b\"),_=new RegExp(c.source+\"/calibrationPointLayers\\\\b\"),j=new RegExp(_.source+\"/\\\\d+\\\\b\"),O=new RegExp(c.source+\"/intersectionLayers\\\\b\"),P=new RegExp(O.source+\"/\\\\d+\\\\b\"),V=new RegExp(c.source+\"/nonLRSLayers\\\\b\"),A=new RegExp(V.source+\"/\\\\d+\\\\b\"),G=new RegExp(c.source+\"/locks\\\\b\"),M=new RegExp(G.source+\"/query\\\\b\"),I=new RegExp(G.source+\"/acquire\\\\b\"),D=new RegExp(G.source+\"/release\\\\b\"),C=n(0),N=function(e){function r(r,n){var t=this,o=r+\" does not match \"+n+\".\";return(t=e.call(this,o)||this).url=r,t.re=n,t}return function(e,r){function n(){this.constructor=e}o(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}(r,e),r}(Error);function Q(e,r){var n=e.match(r);if(n)return n[0];throw new N(e,r)}function U(e,r){return u(this,void 0,void 0,function(){var n;return i(this,function(t){return n=Q(n=e.endpoint,r),delete e.endpoint,[2,Object(C.request)(n,e)]})})}function z(e){return u(this,void 0,void 0,function(){return i(this,function(r){return[2,U(e,c)]})})}function B(e){return u(this,void 0,void 0,function(){return i(this,function(r){return[2,U(e,s)]})})}function F(e){return u(this,void 0,void 0,function(){return i(this,function(r){return[2,U(e,d)]})})}function H(e){if(Array.isArray(e)){if(e.length<2)throw TypeError(\"Item must be an array with two or more elements.\");return{geometry:{x:e[0],y:e[1]}}}return e}var J=function(){function e(e){this._url=Q(e,c)}return Object.defineProperty(e.prototype,\"url\",{get:function(){return this._url},enumerable:!0,configurable:!0}),e.prototype.geometryToMeasure=function(e,r,n,t,o,c,s){return u(this,void 0,void 0,function(){var u,a;return i(this,function(i){switch(i.label){case 0:return u=this.url+\"/networkLayers/\"+e+\"/geometryToMeasure\",a={locations:r.map(H)},void 0!==n&&(a.tolerance=n),t&&(a.temporalViewDate=t.getTime()),o&&(a.inSR=o),c&&(a.outSR=c),s&&(a.gdbVersion=s),[4,Object(C.request)(u,{params:a})];case 1:return[2,i.sent()]}})})},e.prototype.measureToGeometry=function(e,r,n,t,o){return u(this,void 0,void 0,function(){var u,c;return i(this,function(i){switch(i.label){case 0:return u=this.url+\"/networkLayers/\"+e+\"/measureToGeometry\",c={layerId:e,locations:r},n&&(c.temporalViewDate=n.getTime()),t&&(c.outSR=t),o&&(c.gdbVersion=o),[4,Object(C.request)(u,{params:c})];case 1:return[2,i.sent()]}})})},e}();n.d(r,\"dateToTimeInstant\",function(){return t}),n.d(r,\"validateUrl\",function(){return Q}),n.d(r,\"getLrsServiceInfo\",function(){return z}),n.d(r,\"getAllLayers\",function(){return B}),n.d(r,\"getNetworkLayers\",function(){return F}),n.d(r,\"LrsClient\",function(){return J}),n.d(r,\"lrsServer\",function(){return c}),n.d(r,\"allLayers\",function(){return s}),n.d(r,\"applyEdits\",function(){return a}),n.d(r,\"createVersion\",function(){return f}),n.d(r,\"deleteVersion\",function(){return l}),n.d(r,\"reconcileVersion\",function(){return p}),n.d(r,\"networkLayers\",function(){return d}),n.d(r,\"networkLayer\",function(){return y}),n.d(r,\"geometryToMeasure\",function(){return b}),n.d(r,\"measureToGeometry\",function(){return w}),n.d(r,\"translate\",function(){return g}),n.d(r,\"concurrencies\",function(){return h}),n.d(r,\"queryAttributeSet\",function(){return x}),n.d(r,\"checkEvents\",function(){return v}),n.d(r,\"eventLayers\",function(){return m}),n.d(r,\"eventLayer\",function(){return R}),n.d(r,\"geometryToStation\",function(){return E}),n.d(r,\"stationToGeometry\",function(){return L}),n.d(r,\"redlineLayers\",function(){return T}),n.d(r,\"redlineLayer\",function(){return k}),n.d(r,\"centerlineLayers\",function(){return S}),n.d(r,\"centerlineLayer\",function(){return q}),n.d(r,\"calibrationPointLayers\",function(){return _}),n.d(r,\"calibrationPointLayer\",function(){return j}),n.d(r,\"intersectionLayers\",function(){return O}),n.d(r,\"intersectionLayer\",function(){return P}),n.d(r,\"nonLRSLayers\",function(){return V}),n.d(r,\"nonLRSLayer\",function(){return A}),n.d(r,\"locks\",function(){return G}),n.d(r,\"locksQuery\",function(){return M}),n.d(r,\"locksAcquire\",function(){return I}),n.d(r,\"locksRelease\",function(){return D})}])});\n//# sourceMappingURL=index.js.map","import { LrsClient } from \"@wsdot/arcgis-rest-lrs\";\r\n// import { SnappingManagerOptions } from \"esri\";\r\nimport Point = require(\"esri/geometry/Point\");\r\nimport EsriMap = require(\"esri/map\");\r\n// import SnappingManager = require(\"esri/SnappingManager\");\r\nimport Draw = require(\"esri/toolbars/draw\");\r\n\r\nimport {\r\n  addToFormWithLabel,\r\n  defaultLayerId,\r\n  defaultLrsSvcUrl,\r\n  generateId,\r\n  splitName\r\n} from \"./utils\";\r\n\r\nfunction createForm(\r\n  url: string = defaultLrsSvcUrl,\r\n  layerId: number = defaultLayerId\r\n) {\r\n  const form = document.createElement(\"form\");\r\n  form.id = generateId(\"geometryToMeasureForm\");\r\n  form.action = `${url}/networkLayers/${layerId}/geometryToMeasure`;\r\n\r\n  const toleranceControl = document.createElement(\"input\");\r\n  toleranceControl.type = \"number\";\r\n  toleranceControl.min = \"0\";\r\n  toleranceControl.name = \"tolerance\";\r\n  toleranceControl.id = generateId(\"toleranceInput\");\r\n\r\n  addToFormWithLabel(form, toleranceControl);\r\n\r\n  const dateControl = document.createElement(\"input\");\r\n  dateControl.type = \"date\";\r\n  dateControl.name = \"temporalViewDate\";\r\n  dateControl.id = generateId(\"temporalViewDateInput\");\r\n\r\n  addToFormWithLabel(form, dateControl);\r\n\r\n  const submitButton = document.createElement(\"button\");\r\n  submitButton.type = \"submit\";\r\n  submitButton.textContent = \"Locate\";\r\n  form.appendChild(submitButton);\r\n\r\n  return form;\r\n}\r\n\r\nexport class GeometryToMeasureForm {\r\n  public readonly form: HTMLFormElement;\r\n  public readonly draw: Draw;\r\n  public readonly lrsClient: LrsClient;\r\n\r\n  public get tolerance(): number | undefined {\r\n    const input = this.form.elements.namedItem(\r\n      \"tolerance\"\r\n    ) as HTMLInputElement | null;\r\n    if (!(input && input.value)) {\r\n      return;\r\n    }\r\n    return input.valueAsNumber;\r\n  }\r\n\r\n  public get temporalViewDate(): Date | undefined {\r\n    const input = this.form.elements.namedItem(\r\n      \"temporalViewDate\"\r\n    ) as HTMLInputElement | null;\r\n    if (!(input && input.value)) {\r\n      return;\r\n    }\r\n    return input.valueAsDate;\r\n  }\r\n\r\n  /**\r\n   * Creates a new instance of this class.\r\n   * @param map Map object\r\n   * @param url LRS map service URL\r\n   * @param layerId layer ID\r\n   */\r\n  constructor(\r\n    public readonly map: EsriMap,\r\n    public readonly url: string = defaultLrsSvcUrl,\r\n    public readonly layerId: number = defaultLayerId\r\n  ) {\r\n    if (!map || !(map instanceof EsriMap)) {\r\n      throw TypeError(`Invalid map: ${map}`);\r\n    }\r\n    this.form = createForm(url, layerId);\r\n    this.draw = new Draw(this.map);\r\n    this.lrsClient = new LrsClient(url);\r\n\r\n    const self = this;\r\n\r\n    // Setup the form's submit event.\r\n    this.form.addEventListener(\"submit\", e => {\r\n      try {\r\n        self.draw.activate(Draw.POINT);\r\n        self.map.setInfoWindowOnClick(false);\r\n      } catch (error) {\r\n        alert(\"Error: Could not activate the draw toolbar.\");\r\n        // tslint:disable-next-line:no-console\r\n        console.error(\"Error activating the draw toolbar\", error);\r\n      }\r\n      e.preventDefault();\r\n    });\r\n\r\n    this.draw.on(\"draw-complete\", async e => {\r\n      self.draw.deactivate();\r\n      self.map.setInfoWindowOnClick(true);\r\n      // Exit if there is no geometry or if the drawn geometry is not a point.\r\n      if (!(e.geometry && e.geometry.type.match(/point/gi))) {\r\n        return;\r\n      }\r\n      const point = e.geometry as Point;\r\n\r\n      const wkid = e.geometry.spatialReference.wkid;\r\n\r\n      // Call the API.\r\n      // Dispatch an event, differing depending on success or failure\r\n      try {\r\n        const result = await this.lrsClient.geometryToMeasure(\r\n          self.layerId,\r\n          [[point.x, point.y]],\r\n          self.tolerance,\r\n          self.temporalViewDate,\r\n          wkid,\r\n          wkid\r\n        );\r\n        const g2mEvent = new CustomEvent(\"geometryToMeasure\", {\r\n          detail: result\r\n        });\r\n        self.form.dispatchEvent(g2mEvent);\r\n      } catch (ex) {\r\n        const errorEvent = new CustomEvent(\"geometryToMeasureError\", {\r\n          detail: ex\r\n        });\r\n        self.form.dispatchEvent(errorEvent);\r\n      }\r\n    });\r\n  }\r\n}\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","module.exports = __WEBPACK_EXTERNAL_MODULE__7__;","module.exports = __WEBPACK_EXTERNAL_MODULE__8__;","module.exports = __WEBPACK_EXTERNAL_MODULE__9__;","module.exports = __WEBPACK_EXTERNAL_MODULE__10__;","module.exports = __WEBPACK_EXTERNAL_MODULE__11__;","import Color = require(\"esri/Color\");\r\nimport PopupTemplate = require(\"esri/dijit/PopupTemplate\");\r\nimport FeatureLayer = require(\"esri/layers/FeatureLayer\");\r\nimport SimpleRenderer = require(\"esri/renderers/SimpleRenderer\");\r\nimport SimpleLineSymbol = require(\"esri/symbols/SimpleLineSymbol\");\r\nimport SimpleMarkerSymbol = require(\"esri/symbols/SimpleMarkerSymbol\");\r\n\r\nconst pointSymbol = new SimpleMarkerSymbol();\r\npointSymbol.setColor(new Color(\"red\"));\r\nconst pointRenderer = new SimpleRenderer(pointSymbol);\r\n\r\nexport interface IField {\r\n  name: string;\r\n  type: string;\r\n  alias?: string;\r\n}\r\n\r\nconst pointLayerFields = new Array<IField>(\r\n  ...[\r\n    {\r\n      name: \"routeId\",\r\n      type: \"esriFieldTypeString\",\r\n      alias: \"Route ID\"\r\n    },\r\n    {\r\n      name: \"status\",\r\n      type: \"esriFieldTypeString\",\r\n      alias: \"Locating Status\"\r\n    },\r\n    {\r\n      name: \"county\",\r\n      type: \"esriFieldTypeString\",\r\n      alias: \"County\"\r\n    },\r\n    {\r\n      name: \"direction\",\r\n      type: \"esriFieldTypeString\",\r\n      alias: \"Direction\"\r\n    },\r\n    {\r\n      name: \"roadNumber\",\r\n      type: \"esriFieldTypeInteger\",\r\n      alias: \"Road Number\"\r\n    },\r\n    {\r\n      name: \"measure\",\r\n      type: \"esriFieldTypeDouble\",\r\n      alias: \"Measure\"\r\n    }\r\n  ]\r\n);\r\n\r\nfunction makeDescriptionTemplate(fields: IField[]) {\r\n  const rows = fields\r\n    .map(f => `<tr><th scope=\"row\">${f.name}</th><td>{${f.name}}</td></tr>`)\r\n    .join(\"\");\r\n  return `<table>${rows}</table>`;\r\n}\r\n\r\nconst lineLayerFields = pointLayerFields\r\n  .map(f => {\r\n    let { name, alias } = f;\r\n    const { type } = f;\r\n    if (name === \"measure\") {\r\n      name = \"fromMeasure\";\r\n      alias = \"From Measure\";\r\n      return { name, type, alias };\r\n    }\r\n    return f;\r\n  })\r\n  .concat([\r\n    {\r\n      name: \"endMeasure\",\r\n      type: \"esriFieldTypeDouble\",\r\n      alias: \"End Measure\"\r\n    }\r\n  ]);\r\n\r\nconst pointLayerDefinition = {\r\n  geometryType: \"esriGeometryPoint\",\r\n  fields: pointLayerFields\r\n};\r\n\r\nconst lineLayerDefinition = {\r\n  geometry: \"esriGeometryLine\",\r\n  fields: lineLayerFields\r\n};\r\n\r\nconst pointsPopupTemplate = new PopupTemplate({\r\n  title: \"Located CRAB Point\",\r\n  description: makeDescriptionTemplate(pointLayerFields)\r\n});\r\n\r\nconst linePopupTempate = new PopupTemplate({\r\n  title: \"Located CRAB Line Segment\",\r\n  description: makeDescriptionTemplate(lineLayerFields)\r\n});\r\n\r\n// Create the layer for located points and add to map.\r\nconst crabPointsLayer = new FeatureLayer(\r\n  {\r\n    layerDefinition: pointLayerDefinition,\r\n    featureSet: null\r\n  },\r\n  {\r\n    id: \"CRAB Points\"\r\n  }\r\n);\r\ncrabPointsLayer.setInfoTemplate(pointsPopupTemplate);\r\ncrabPointsLayer.setRenderer(pointRenderer);\r\n\r\nconst crabLinesLayer = new FeatureLayer({\r\n  layerDefinition: lineLayerDefinition,\r\n  featureSet: null\r\n});\r\ncrabLinesLayer.setInfoTemplate(linePopupTempate);\r\nconst lineSymbol = new SimpleLineSymbol(\r\n  SimpleLineSymbol.STYLE_SOLID,\r\n  new Color(\"red\"),\r\n  3\r\n);\r\nconst lineRenderer = new SimpleRenderer(lineSymbol);\r\ncrabLinesLayer.setRenderer(lineRenderer);\r\n\r\nexport { crabPointsLayer, crabLinesLayer };\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__13__;","module.exports = __WEBPACK_EXTERNAL_MODULE__14__;","import { IG2MOutput, IM2GOutput } from \"@wsdot/arcgis-rest-lrs\";\r\nimport ContentPane = require(\"dijit/layout/ContentPane\");\r\nimport Graphic = require(\"esri/graphic\");\r\nimport ArcGISDynamicMapServiceLayer = require(\"esri/layers/ArcGISDynamicMapServiceLayer\");\r\nimport EsriMap = require(\"esri/map\");\r\n\r\nimport { GeometryToMeasureForm } from \"./GeometryToMeasureForm\";\r\nimport { crabLinesLayer, crabPointsLayer } from \"./layers\";\r\nimport { MeasureToGeometryForm } from \"./MeasureToGeometryForm\";\r\nimport {\r\n  defaultLayerId,\r\n  defaultLrsMapServiceUrl,\r\n  IterateG2MOutputToFeatures,\r\n  m2gOutputToFeatures\r\n} from \"./utils\";\r\n\r\nexport function setupCrab(\r\n  toolsAccordion: any,\r\n  serviceUrl: string = defaultLrsMapServiceUrl,\r\n  layerId: number = defaultLayerId\r\n) {\r\n  const toolsAccordianDiv = document.getElementById(\"toolsAccordion\");\r\n  if (!toolsAccordianDiv) {\r\n    throw Error(\"#toolsAccordion element not found.\");\r\n  }\r\n  const paneDiv = document.createElement(\"div\");\r\n  paneDiv.id = \"crabPane\";\r\n  toolsAccordianDiv.appendChild(paneDiv);\r\n  const contentPane = new ContentPane(\r\n    { title: \"CRAB\", id: \"crabPane\" },\r\n    paneDiv\r\n  );\r\n  toolsAccordion.addChild(contentPane);\r\n  const crabUI = document.createElement(\"div\");\r\n\r\n  crabUI.id = \"drawUI\";\r\n\r\n  // When the map loads, add event handling code for the form.\r\n  window.addEventListener(\"mapload\", e => {\r\n    // Get the map object from the event.\r\n    const map = (e as any).detail as EsriMap;\r\n\r\n    const crabRoutesLayer = new ArcGISDynamicMapServiceLayer(\r\n      defaultLrsMapServiceUrl\r\n    );\r\n\r\n    map.addLayers([crabRoutesLayer, crabPointsLayer]);\r\n\r\n    // Setup Geometry to Measure form.\r\n    const g2mForm = new GeometryToMeasureForm(map);\r\n    crabUI.appendChild(g2mForm.form);\r\n\r\n    g2mForm.form.addEventListener(\"geometryToMeasure\", g2mEvt => {\r\n      const result = (g2mEvt as CustomEvent<IG2MOutput>).detail;\r\n      const features = IterateG2MOutputToFeatures(result);\r\n\r\n      let f = features.next();\r\n      while (f) {\r\n        if (f.done) {\r\n          break;\r\n        }\r\n        crabPointsLayer.add(f.value);\r\n        f = features.next();\r\n      }\r\n    });\r\n\r\n    g2mForm.form.addEventListener(\"geometryToMeasureError\", errorEvt => {\r\n      const error = (errorEvt as CustomEvent).detail;\r\n      // tslint:disable-next-line:no-console\r\n      console.error(\"geometry to measure error\", error);\r\n      alert(\"Geometry to measure error. See console for details.\");\r\n    });\r\n\r\n    // Add Measure to Geometry form.\r\n    const m2gForm = new MeasureToGeometryForm(serviceUrl, layerId);\r\n\r\n    crabUI.appendChild(m2gForm.form);\r\n    m2gForm.form.addEventListener(\"m2gsubmit\", async evt => {\r\n      const promise = (evt as CustomEvent<Promise<IM2GOutput>>).detail;\r\n      let output: IM2GOutput;\r\n      try {\r\n        output = await promise;\r\n      } catch (err) {\r\n        console.error(\"measureToGeometry\", err);\r\n        return;\r\n      }\r\n      const iterator = m2gOutputToFeatures(output);\r\n\r\n      let current = iterator.next();\r\n\r\n      while (!current.done) {\r\n        const graphic = current.value;\r\n        if (/Point$/i.test(graphic.geometry.type)) {\r\n          crabPointsLayer.add(graphic);\r\n        } else {\r\n          crabLinesLayer.add(graphic);\r\n        }\r\n\r\n        current = iterator.next();\r\n      }\r\n    });\r\n  });\r\n\r\n  paneDiv.appendChild(crabUI);\r\n}\r\n","// #region county features\r\nconst countyFeatures = {\r\n  displayFieldName: \"JURLBL\",\r\n  fieldAliases: {\r\n    JURLBL: \"JURISDICTION LABEL\",\r\n    JURNM: \"JURISDICTION NAME\",\r\n    JURDSG: \"COUNTY NUMBER\",\r\n    JURFIPSDSG: \"COUNTY FIPS CODE\"\r\n  },\r\n  fields: [\r\n    {\r\n      name: \"JURLBL\",\r\n      type: \"esriFieldTypeString\",\r\n      alias: \"JURISDICTION LABEL\",\r\n      length: 20\r\n    },\r\n    {\r\n      name: \"JURNM\",\r\n      type: \"esriFieldTypeString\",\r\n      alias: \"JURISDICTION NAME\",\r\n      length: 50\r\n    },\r\n    {\r\n      name: \"JURDSG\",\r\n      type: \"esriFieldTypeDouble\",\r\n      alias: \"COUNTY NUMBER\"\r\n    },\r\n    {\r\n      name: \"JURFIPSDSG\",\r\n      type: \"esriFieldTypeDouble\",\r\n      alias: \"COUNTY FIPS CODE\"\r\n    }\r\n  ],\r\n  features: [\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Adams\",\r\n        JURNM: \"Adams County\",\r\n        JURDSG: 1,\r\n        JURFIPSDSG: 53001\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Asotin\",\r\n        JURNM: \"Asotin County\",\r\n        JURDSG: 2,\r\n        JURFIPSDSG: 53003\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Benton\",\r\n        JURNM: \"Benton County\",\r\n        JURDSG: 3,\r\n        JURFIPSDSG: 53005\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Chelan\",\r\n        JURNM: \"Chelan County\",\r\n        JURDSG: 4,\r\n        JURFIPSDSG: 53007\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Clallam\",\r\n        JURNM: \"Clallam County\",\r\n        JURDSG: 5,\r\n        JURFIPSDSG: 53009\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Clark\",\r\n        JURNM: \"Clark County\",\r\n        JURDSG: 6,\r\n        JURFIPSDSG: 53011\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Columbia\",\r\n        JURNM: \"Columbia County\",\r\n        JURDSG: 7,\r\n        JURFIPSDSG: 53013\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Cowlitz\",\r\n        JURNM: \"Cowlitz County\",\r\n        JURDSG: 8,\r\n        JURFIPSDSG: 53015\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Douglas\",\r\n        JURNM: \"Douglas County\",\r\n        JURDSG: 9,\r\n        JURFIPSDSG: 53017\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Ferry\",\r\n        JURNM: \"Ferry County\",\r\n        JURDSG: 10,\r\n        JURFIPSDSG: 53019\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Franklin\",\r\n        JURNM: \"Franklin County\",\r\n        JURDSG: 11,\r\n        JURFIPSDSG: 53021\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Garfield\",\r\n        JURNM: \"Garfield County\",\r\n        JURDSG: 12,\r\n        JURFIPSDSG: 53023\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Grant\",\r\n        JURNM: \"Grant County\",\r\n        JURDSG: 13,\r\n        JURFIPSDSG: 53025\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Grays Harbor\",\r\n        JURNM: \"Grays Harbor County\",\r\n        JURDSG: 14,\r\n        JURFIPSDSG: 53027\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Island\",\r\n        JURNM: \"Island County\",\r\n        JURDSG: 15,\r\n        JURFIPSDSG: 53029\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Jefferson\",\r\n        JURNM: \"Jefferson County\",\r\n        JURDSG: 16,\r\n        JURFIPSDSG: 53031\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"King\",\r\n        JURNM: \"King County\",\r\n        JURDSG: 17,\r\n        JURFIPSDSG: 53033\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Kitsap\",\r\n        JURNM: \"Kitsap County\",\r\n        JURDSG: 18,\r\n        JURFIPSDSG: 53035\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Kittitas\",\r\n        JURNM: \"Kittitas County\",\r\n        JURDSG: 19,\r\n        JURFIPSDSG: 53037\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Klickitat\",\r\n        JURNM: \"Klickitat County\",\r\n        JURDSG: 20,\r\n        JURFIPSDSG: 53039\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Lewis\",\r\n        JURNM: \"Lewis County\",\r\n        JURDSG: 21,\r\n        JURFIPSDSG: 53041\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Lincoln\",\r\n        JURNM: \"Lincoln County\",\r\n        JURDSG: 22,\r\n        JURFIPSDSG: 53043\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Mason\",\r\n        JURNM: \"Mason County\",\r\n        JURDSG: 23,\r\n        JURFIPSDSG: 53045\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Okanogan\",\r\n        JURNM: \"Okanogan County\",\r\n        JURDSG: 24,\r\n        JURFIPSDSG: 53047\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Pacific\",\r\n        JURNM: \"Pacific County\",\r\n        JURDSG: 25,\r\n        JURFIPSDSG: 53049\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Pend Oreille\",\r\n        JURNM: \"Pend Oreille County\",\r\n        JURDSG: 26,\r\n        JURFIPSDSG: 53051\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Pierce\",\r\n        JURNM: \"Pierce County\",\r\n        JURDSG: 27,\r\n        JURFIPSDSG: 53053\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"San Juan\",\r\n        JURNM: \"San Juan County\",\r\n        JURDSG: 28,\r\n        JURFIPSDSG: 53055\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Skagit\",\r\n        JURNM: \"Skagit County\",\r\n        JURDSG: 29,\r\n        JURFIPSDSG: 53057\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Skamania\",\r\n        JURNM: \"Skamania County\",\r\n        JURDSG: 30,\r\n        JURFIPSDSG: 53059\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Snohomish\",\r\n        JURNM: \"Snohomish County\",\r\n        JURDSG: 31,\r\n        JURFIPSDSG: 53061\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Spokane\",\r\n        JURNM: \"Spokane County\",\r\n        JURDSG: 32,\r\n        JURFIPSDSG: 53063\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Stevens\",\r\n        JURNM: \"Stevens County\",\r\n        JURDSG: 33,\r\n        JURFIPSDSG: 53065\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Thurston\",\r\n        JURNM: \"Thurston County\",\r\n        JURDSG: 34,\r\n        JURFIPSDSG: 53067\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Wahkiakum\",\r\n        JURNM: \"Wahkiakum County\",\r\n        JURDSG: 35,\r\n        JURFIPSDSG: 53069\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Walla Walla\",\r\n        JURNM: \"Walla Walla County\",\r\n        JURDSG: 36,\r\n        JURFIPSDSG: 53071\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Whatcom\",\r\n        JURNM: \"Whatcom County\",\r\n        JURDSG: 37,\r\n        JURFIPSDSG: 53073\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Whitman\",\r\n        JURNM: \"Whitman County\",\r\n        JURDSG: 38,\r\n        JURFIPSDSG: 53075\r\n      }\r\n    },\r\n    {\r\n      attributes: {\r\n        JURLBL: \"Yakima\",\r\n        JURNM: \"Yakima County\",\r\n        JURDSG: 39,\r\n        JURFIPSDSG: 53077\r\n      }\r\n    }\r\n  ]\r\n};\r\n// #endregion\r\n\r\nfunction featureSetToMap(featureSet: any) {\r\n  const map = new Map<number, string>();\r\n  if (!(featureSet && featureSet.features)) {\r\n    throw new TypeError(\"FeatureSet features not defined.\");\r\n  }\r\n  for (const feature of featureSet.features) {\r\n    const attributes = feature.attributes;\r\n    const label = attributes.JURLBL;\r\n    const fips = attributes.JURFIPSDSG;\r\n    if (!fips || !label) {\r\n      throw new TypeError(`FIPS: ${fips}, Label: ${label}`);\r\n    }\r\n    map.set(fips, label);\r\n  }\r\n  return map;\r\n}\r\n\r\nconst countyLookup = featureSetToMap(countyFeatures);\r\n\r\nexport default countyLookup;\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__17__;","module.exports = __WEBPACK_EXTERNAL_MODULE__18__;","module.exports = __WEBPACK_EXTERNAL_MODULE__19__;","module.exports = __WEBPACK_EXTERNAL_MODULE__20__;","module.exports = __WEBPACK_EXTERNAL_MODULE__21__;","module.exports = __WEBPACK_EXTERNAL_MODULE__22__;","/* @esri/arcgis-rest-request - v1.1.1 - Mon Mar 05 2018 10:57:50 GMT-0800 (PST)\n * Copyright (c) 2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.arcgisRest = global.arcgisRest || {})));\n}(this, (function (exports) { 'use strict';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n};\n\n/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\r\n * Apache-2.0 */\r\n// TypeScript 2.1 no longer allows you to extend built in types. See https://github.com/Microsoft/TypeScript/issues/12790#issuecomment-265981442\r\n// and https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\r\n//\r\n// This code is from MDN https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types.\r\nvar ArcGISRequestError = /** @class */ (function () {\r\n    /**\r\n     * Create a new `ArcGISRequestError`  object.\r\n     *\r\n     * @param message - The error message from the API\r\n     * @param code - The error code from the API\r\n     * @param response - The original response from the API that caused the error\r\n     * @param url - The original url of the request\r\n     * @param options - The original options and parameters of the request\r\n     */\r\n    function ArcGISRequestError(message, code, response, url, options) {\r\n        if (message === void 0) { message = \"UNKNOWN_ERROR\"; }\r\n        if (code === void 0) { code = \"UNKNOWN_ERROR_CODE\"; }\r\n        this.name = \"ArcGISRequestError\";\r\n        this.message =\r\n            code === \"UNKNOWN_ERROR_CODE\" ? message : code + \": \" + message;\r\n        this.originalMessage = message;\r\n        this.code = code;\r\n        this.response = response;\r\n        this.url = url;\r\n        this.options = options;\r\n    }\r\n    return ArcGISRequestError;\r\n}());\r\nArcGISRequestError.prototype = Object.create(Error.prototype);\r\nArcGISRequestError.prototype.constructor = ArcGISRequestError;\n\n/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\r\n * Apache-2.0 */\r\nvar ArcGISAuthError = /** @class */ (function (_super) {\r\n    __extends(ArcGISAuthError, _super);\r\n    /**\r\n     * Create a new `ArcGISAuthError`  object.\r\n     *\r\n     * @param message - The error message from the API\r\n     * @param code - The error code from the API\r\n     * @param response - The original response from the API that caused the error\r\n     * @param url - The original url of the request\r\n     * @param options - The original options of the request\r\n     */\r\n    function ArcGISAuthError(message, code, response, url, options) {\r\n        if (message === void 0) { message = \"AUTHENTICATION_ERROR\"; }\r\n        if (code === void 0) { code = \"AUTHENTICATION_ERROR_CODE\"; }\r\n        var _this = _super.call(this, message, code, response, url, options) || this;\r\n        _this.name = \"ArcGISAuthError\";\r\n        _this.message =\r\n            code === \"AUTHENTICATION_ERROR_CODE\" ? message : code + \": \" + message;\r\n        return _this;\r\n    }\r\n    ArcGISAuthError.prototype.retry = function (getSession, retryLimit) {\r\n        var _this = this;\r\n        if (retryLimit === void 0) { retryLimit = 3; }\r\n        var tries = 0;\r\n        var retryRequest = function (resolve, reject) {\r\n            getSession(_this.url, _this.options)\r\n                .then(function (session) {\r\n                var newOptions = __assign({}, _this.options, { authentication: session });\r\n                tries = tries + 1;\r\n                return request(_this.url, newOptions);\r\n            })\r\n                .then(function (response) {\r\n                resolve(response);\r\n            })\r\n                .catch(function (e) {\r\n                if (e.name === \"ArcGISAuthError\" && tries < retryLimit) {\r\n                    retryRequest(resolve, reject);\r\n                }\r\n                else if (e.name === \"ArcGISAuthError\" && tries >= retryLimit) {\r\n                    reject(_this);\r\n                }\r\n                else {\r\n                    reject(e);\r\n                }\r\n            });\r\n        };\r\n        return new Promise(function (resolve, reject) {\r\n            retryRequest(resolve, reject);\r\n        });\r\n    };\r\n    return ArcGISAuthError;\r\n}(ArcGISRequestError));\n\n/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\r\n * Apache-2.0 */\r\n/**\r\n * Checks for errors in a JSON response from the ArcGIS REST API. If there are no errors, it will return the `data` passed in. If there is an error, it will throw an `ArcGISRequestError` or `ArcGISAuthError`.\r\n *\r\n * @param data The response JSON to check for errors.\r\n * @param url The url of the original request\r\n * @param params The parameters of the original request\r\n * @param options The options of the original request\r\n * @returns The data that was passed in the `data` parameter\r\n */\r\nfunction checkForErrors(response, url, params, options) {\r\n    // this is an error message from billing.arcgis.com backend\r\n    if (response.code >= 400) {\r\n        var message = response.message, code = response.code;\r\n        throw new ArcGISRequestError(message, code, response, url, options);\r\n    }\r\n    // error from ArcGIS Online or an ArcGIS Portal or server instance.\r\n    if (response.error) {\r\n        var _a = response.error, message = _a.message, code = _a.code, messageCode = _a.messageCode;\r\n        var errorCode = messageCode || code || \"UNKNOWN_ERROR_CODE\";\r\n        if (code === 498 || code === 499 || messageCode === \"GWM_0003\") {\r\n            throw new ArcGISAuthError(message, errorCode, response, url, options);\r\n        }\r\n        throw new ArcGISRequestError(message, errorCode, response, url, options);\r\n    }\r\n    // error from a status check\r\n    if (response.status === \"failed\") {\r\n        var message = void 0;\r\n        var code = \"UNKNOWN_ERROR_CODE\";\r\n        try {\r\n            message = JSON.parse(response.statusMessage).message;\r\n            code = JSON.parse(response.statusMessage).code;\r\n        }\r\n        catch (e) {\r\n            message = response.statusMessage;\r\n        }\r\n        throw new ArcGISRequestError(message, code, response, url, options);\r\n    }\r\n    return response;\r\n}\r\n/**\r\n * Method used internally to surface messages to developers.\r\n */\r\nfunction warn(message) {\r\n    if (console && console.warn) {\r\n        console.warn.apply(console, [message]);\r\n    }\r\n}\n\n/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\r\n* Apache-2.0 */\r\n/**\r\n * Checks parameters to see if we should use FormData to send the request\r\n * @param params The object whose keys will be encoded.\r\n * @return A boolean indicating if FormData will be required.\r\n */\r\nfunction requiresFormData(params) {\r\n    return Object.keys(params).some(function (key) {\r\n        var value = params[key];\r\n        if (!value) {\r\n            return false;\r\n        }\r\n        var type = value.constructor.name;\r\n        switch (type) {\r\n            case \"Array\":\r\n                return false;\r\n            case \"Object\":\r\n                return false;\r\n            case \"Date\":\r\n                return false;\r\n            case \"Function\":\r\n                return false;\r\n            case \"Boolean\":\r\n                return false;\r\n            case \"String\":\r\n                return false;\r\n            case \"Number\":\r\n                return false;\r\n            default:\r\n                return true;\r\n        }\r\n    });\r\n}\r\n/**\r\n * Converts parameters to the proper representation to send to the ArcGIS REST API.\r\n * @param params The object whose keys will be encoded.\r\n * @return A new object with properly encoded values.\r\n */\r\nfunction processParams(params) {\r\n    var newParams = {};\r\n    Object.keys(params).forEach(function (key) {\r\n        var param = params[key];\r\n        if (!param && param !== 0 && typeof param !== \"boolean\") {\r\n            return;\r\n        }\r\n        var type = param.constructor.name;\r\n        var value;\r\n        // properly encodes objects, arrays and dates for arcgis.com and other services.\r\n        // ported from https://github.com/Esri/esri-leaflet/blob/master/src/Request.js#L22-L30\r\n        // also see https://github.com/Esri/arcgis-rest-js/issues/18\r\n        switch (type) {\r\n            case \"Array\":\r\n                value =\r\n                    param[0].constructor.name === \"Object\"\r\n                        ? JSON.stringify(param)\r\n                        : param.join(\",\");\r\n                break;\r\n            case \"Object\":\r\n                value = JSON.stringify(param);\r\n                break;\r\n            case \"Date\":\r\n                value = param.valueOf();\r\n                break;\r\n            case \"Function\":\r\n                value = null;\r\n                break;\r\n            case \"Boolean\":\r\n                value = param + \"\";\r\n                break;\r\n            default:\r\n                value = param;\r\n                break;\r\n        }\r\n        if (value || value === 0) {\r\n            newParams[key] = value;\r\n        }\r\n    });\r\n    return newParams;\r\n}\n\n/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\r\n * Apache-2.0 */\r\nfunction encodeParam(key, value) {\r\n    return encodeURIComponent(key) + \"=\" + encodeURIComponent(value);\r\n}\r\n/**\r\n * Encodes the passed object as a query string.\r\n *\r\n * @param params An object to be encoded.\r\n * @returns An encoded query string.\r\n */\r\nfunction encodeQueryString(params) {\r\n    var newParams = processParams(params);\r\n    return Object.keys(newParams)\r\n        .map(function (key) {\r\n        return encodeParam(key, newParams[key]);\r\n    })\r\n        .join(\"&\");\r\n}\n\n/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\r\n * Apache-2.0 */\r\n/**\r\n * Encodes parameters in a [FormData](https://developer.mozilla.org/en-US/docs/Web/API/FormData) object in browsers or in a [FormData](https://github.com/form-data/form-data) in Node.js\r\n *\r\n * @param params An object to be encoded.\r\n * @returns The complete [FormData](https://developer.mozilla.org/en-US/docs/Web/API/FormData) object.\r\n */\r\nfunction encodeFormData(params) {\r\n    var useFormData = requiresFormData(params);\r\n    var newParams = processParams(params);\r\n    if (useFormData) {\r\n        var formData_1 = new FormData();\r\n        Object.keys(newParams).forEach(function (key) {\r\n            formData_1.append(key, newParams[key]);\r\n        });\r\n        return formData_1;\r\n    }\r\n    else {\r\n        return encodeQueryString(params);\r\n    }\r\n}\n\n/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\r\n * Apache-2.0 */\r\n/**\r\n * Generic method for making HTTP requests to ArcGIS REST API endpoints.\r\n *\r\n * ```js\r\n * import { request } from '@esri/arcgis-rest-request';\r\n *\r\n * request('https://www.arcgis.com/sharing/rest')\r\n *   .then((response) => {\r\n *     console.log(response.currentVersion); // => 5.2\r\n *   });\r\n * ```\r\n *\r\n * ```js\r\n * import { request, HTTPMethods } from '@esri/arcgis-rest-request';\r\n *\r\n * request('https://www.arcgis.com/sharing/rest', {\r\n *   httpMethod: \"GET\"\r\n * }).then((response) => {\r\n *   console.log(response.currentVersion); // => 5.2\r\n * });\r\n * ```\r\n *\r\n * ```js\r\n * import { request, HTTPMethods } from '@esri/arcgis-rest-request';\r\n *\r\n * request('https://www.arcgis.com/sharing/rest/search', {\r\n *   params: { q: 'parks' }\r\n * }).then((response) => {\r\n *   console.log(response.total); // => 78379\r\n * });\r\n * ```\r\n *\r\n * @param url - The URL of the ArcGIS REST API endpoint.\r\n * @param requestOptions - Options for the request, including parameters relevant to the endpoint.\r\n * @returns A Promise that will resolve with the data from the response.\r\n */\r\nfunction request(url, requestOptions) {\r\n    if (requestOptions === void 0) { requestOptions = { params: { f: \"json\" } }; }\r\n    var options = __assign({ httpMethod: \"POST\", fetch: fetch }, requestOptions);\r\n    var missingGlobals = [];\r\n    var recommendedPackages = [];\r\n    if (!options.fetch) {\r\n        missingGlobals.push(\"`fetch`\");\r\n        recommendedPackages.push(\"`isomorphic-fetch`\");\r\n    }\r\n    if (!Promise) {\r\n        missingGlobals.push(\"`Promise`\");\r\n        recommendedPackages.push(\"`es6-promise`\");\r\n    }\r\n    if (!FormData) {\r\n        missingGlobals.push(\"`FormData`\");\r\n        recommendedPackages.push(\"`isomorphic-form-data`\");\r\n    }\r\n    if (!options.fetch || !Promise || !FormData) {\r\n        throw new Error(\"`arcgis-rest-request` requires global variables for `fetch`, `Promise` and `FormData` to be present in the global scope. You are missing \" + missingGlobals.join(\", \") + \". We recommend installing the \" + recommendedPackages.join(\", \") + \" modules at the root of your application to add these to the global scope. See http://bit.ly/2BXbqzq for more info.\");\r\n    }\r\n    if (options.fetch === fetch) {\r\n        options.fetch = fetch.bind(Function(\"return this\")());\r\n    }\r\n    var httpMethod = options.httpMethod, authentication = options.authentication;\r\n    var params = __assign({ f: \"json\" }, requestOptions.params);\r\n    var fetchOptions = {\r\n        method: httpMethod\r\n    };\r\n    return (authentication ? authentication.getToken(url) : Promise.resolve(\"\"))\r\n        .then(function (token) {\r\n        if (token.length) {\r\n            params.token = token;\r\n        }\r\n        if (fetchOptions.method === \"GET\") {\r\n            // encode the parameters into the query string\r\n            var urlWithQueryString = url + \"?\" + encodeQueryString(params);\r\n            if (options.maxUrlLength &&\r\n                urlWithQueryString.length > options.maxUrlLength) {\r\n                // the consumer specified a maximum length for URLs\r\n                // and this would exceed it, so use post instead\r\n                fetchOptions.method = \"POST\";\r\n            }\r\n            else {\r\n                // just use GET\r\n                url = urlWithQueryString;\r\n            }\r\n        }\r\n        if (fetchOptions.method === \"POST\") {\r\n            fetchOptions.body = encodeFormData(params);\r\n        }\r\n        /* istanbul ignore else blob responses are difficult to make cross platform we will just have to trust the isomorphic fetch will do its job */\r\n        if (!requiresFormData(params)) {\r\n            fetchOptions.headers = new Headers();\r\n            fetchOptions.headers.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n        }\r\n        return options.fetch(url, fetchOptions);\r\n    })\r\n        .then(function (response) {\r\n        if (!response.ok) {\r\n            // server responded w/ an actual error (404, 500, etc)\r\n            var status_1 = response.status, statusText = response.statusText;\r\n            throw new ArcGISRequestError(statusText, \"HTTP \" + status_1, response, url, options);\r\n        }\r\n        switch (params.f) {\r\n            case \"json\":\r\n                return response.json();\r\n            case \"geojson\":\r\n                return response.json();\r\n            case \"html\":\r\n                return response.text();\r\n            case \"text\":\r\n                return response.text();\r\n            /* istanbul ignore next blob responses are difficult to make cross platform we will just have to trust the isomorphic fetch will do its job */\r\n            case \"image\":\r\n                return response.blob();\r\n            /* istanbul ignore next blob responses are difficult to make cross platform we will just have to trust the isomorphic fetch will do its job */\r\n            case \"zip\":\r\n                return response.blob();\r\n        }\r\n    })\r\n        .then(function (data) {\r\n        if (params.f === \"json\" || params.f === \"geojson\") {\r\n            return checkForErrors(data, url, params, options);\r\n        }\r\n        else {\r\n            return data;\r\n        }\r\n    });\r\n}\n\n/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\r\n * Apache-2.0 */\r\n/**\r\n * Enum describing the different errors that might be thrown by a request.\r\n *\r\n * ```ts\r\n * import { request, ErrorTypes } from '@esri/arcgis-rest-request';\r\n *\r\n * request(\"...\").catch((e) => {\r\n *   switch(e.name) {\r\n *     case ErrorType.ArcGISRequestError:\r\n *     // handle a general error from the API\r\n *     break;\r\n *\r\n *     case ErrorType.ArcGISAuthError:\r\n *     // handle an authentication error\r\n *     break;\r\n *\r\n *     default:\r\n *     // handle some other error (usually a network error)\r\n *   }\r\n * });\r\n * ```\r\n */\r\n\r\n(function (ErrorTypes) {\r\n    ErrorTypes[\"ArcGISRequestError\"] = \"ArcGISRequestError\";\r\n    ErrorTypes[\"ArcGISAuthError\"] = \"ArcGISAuthError\";\r\n})(exports.ErrorTypes || (exports.ErrorTypes = {}));\n\n/**\r\n * Helper that returns the portalUrl - either defaulting to www.arcgis.com or using\r\n * the passed in auth manager's .portal property\r\n *\r\n * @param requestOptions - Request options that may have authentication manager\r\n * @returns Portal url to be used in API requests\r\n */\r\nfunction getPortalUrl(requestOptions) {\r\n    // default to arcgis.com\r\n    var portalUrl = \"https://www.arcgis.com/sharing/rest\";\r\n    // but if the auth was passed, use that portal...\r\n    if (requestOptions && requestOptions.authentication) {\r\n        portalUrl = requestOptions.authentication.portal;\r\n    }\r\n    return portalUrl;\r\n}\n\n/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\r\n * Apache-2.0 */\r\n/**\r\n * Get the portal\r\n * @param requestOptions\r\n */\r\nfunction getSelf(requestOptions) {\r\n    // just delegate to getPortal w/o an id\r\n    return getPortal(null, requestOptions);\r\n}\r\n/**\r\n * Get a portal by id. If no id is passed, it will call portals/self\r\n * @param id\r\n * @param requestOptions\r\n */\r\nfunction getPortal(id, requestOptions) {\r\n    // construct the search url\r\n    var idOrSelf = id ? id : \"self\";\r\n    var url = getPortalUrl(requestOptions) + \"/portals/\" + idOrSelf;\r\n    // default to a GET request\r\n    var options = __assign({ httpMethod: \"GET\" }, requestOptions);\r\n    // send the request\r\n    return request(url, options);\r\n}\n\nexports.request = request;\nexports.encodeFormData = encodeFormData;\nexports.encodeParam = encodeParam;\nexports.encodeQueryString = encodeQueryString;\nexports.checkForErrors = checkForErrors;\nexports.warn = warn;\nexports.ArcGISRequestError = ArcGISRequestError;\nexports.ArcGISAuthError = ArcGISAuthError;\nexports.requiresFormData = requiresFormData;\nexports.processParams = processParams;\nexports.getSelf = getSelf;\nexports.getPortal = getPortal;\nexports.getPortalUrl = getPortalUrl;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=arcgis-rest-request.umd.js.map\n","export * from \"./GeometryToMeasureForm\";\r\nexport * from \"./MeasureToGeometryForm\";\r\nexport * from \"./utils\";\r\nexport * from \"./Manager\";\r\n"],"sourceRoot":""}